---
timezone: UTC+8
---

# ShawnX-F

**GitHub ID:** ShawnX-F

**Telegram:** 

## Self-introduction

Web3 实习计划 2025 冬季实习生

## Notes

<!-- Content_START -->
# 2026-01-17
<!-- DAILY_CHECKIN_2026-01-17_START -->
# Uniswap

### 1\. 工作原理

基于恒定乘积公式，通过智能合约系统实现。每个uniswap智能合约管理着一个流动性池，该池由两个ERC-20代币的储备组成。

2\. 恒定乘积公式

x\*y=k，x和y为池子中的两个ERC-20的储备金额，k为初始池子x、y的乘积，为不变值。但实际上，uniswap对每笔交易都会收取0.30%的手续费，并添加到储备金k中，这相当于向流动性提供者（LP）支付收益，当LP销毁自己的池代币以提取其应得的储备金份额时，即可获得收益。

### 3\. 流动性提供者（LP）

LP把两种ERC20代币按当前市场比例一起存入pool，获得LP Token（也叫流动性代币或LP份额），帮别人提供“可交易的深度”，别人来swap时，用pool中的币完成交易，并支付0.30%的手续费，按比例分给所有LP。

-   LP Token的获得：
    

创建池子时，LP Token=√（x\*y）（x，y为LP提供的代币）；增加流动性：LP Token=添加的流动性价值/当前池子的总流动性价值\*当前LP Token总供应量。注，添加时，两种代币的比例应以当前市场比例为准。LP Token就像池子的股票，是ERC20标准，可转账、抵押、质押、出售。

-   LP Token的销毁：
    

把LP Token发回给Pair合约（调用burn函数），系统按比例返回对应数量的两种代币+累积的手续费，LP Token被销毁，总供应量减少。

-   LP的收益及无常损失：
    

LP收益=交易量\*0.30%\*份额比例 - 无常损失

无常损失（Impermanent Loss）≈2\* √（r/（r+1））－1,其中r =新价格/旧价格

总结来说，当交易量大且提取时波动小，手续费>无常损失，则赚钱；当交易量小且提取时单边波动大，手续费<无常损失，则亏钱。结合套利动机，价格来回震荡且最终提取时比例相差不大时，最赚钱。
<!-- DAILY_CHECKIN_2026-01-17_END -->

# 2026-01-16
<!-- DAILY_CHECKIN_2026-01-16_START -->

# 智能合约

### 1\. 形式

代码+持久状态：代码functions+数据state的组合，驻留在以太坊的地址上，由交易触发后执行。智能合约可以部署在L1或L2上，是**链上的基本执行单元**。

### 2\. Denkun升级

升级前，任何合约在任何时间调用SELFDESTRUST（opcode 0xff）都可以：

-   把合约全部余额转给指定地址
    
-   删除合约的代码（code）
    
-   删除合约的全部存储（storage）
    
-   把 nonce 重置为 0
    
-   获得gas refund
    

升级后，**只有在“创建合约的同一笔交易中”调用时才会真正移除代码**。换言之，只能在诞生之时才可以自毁。

| 场景 | 是否同一交易内创建 | SELFDESTRUCT效果（Dencun后） | 备注 |
| 立即 SELFDESTRUCT | 是 | 完整自毁：转余额 + 删除 code + 删除 storage + nonce 重置为0 | 行为不变，常用于临时合约、create2 模式 |
| 已部署的旧合约后续调用 SELFDESTRUCT | 否 | 只转余额（相当于 SENDALL），不删除 code、不删除 storage、不改 nonce | 最常见的变化 |
| 向自己 SELFDESTRUCT（target = self） | 无论是否同一 tx | 余额被销毁（burn），但 code 和 storage 保留（如果非同一 tx） | 之前也可能 burn，现在明确 |

###  3. 智能合约特性

-   可预测性：相同输入，相同输出
    
-   公开记录和可审计性：执行过程和状态变更，都会记录在链上，包括合约部署调用、交易、事件日志、资产转移等。所以DeFi、NFT市场分析、合规审计等领域，会在合约公开数据上做指数和风控模型。
    
-   “隐私”与假名制：无需暴露实名就可以参与网络，但链上留下的一切行为都是公开可追踪的，隐私需要额外设计，如使用专门的隐私协议（如混币、隐私池、零知识证明等）或采取更强的隐私设计。
    
-   条款可见与可审查：合约源码开源，工具（如Slither、Mythril、Foundry + formal verification）框架可直自动化发现一些安全问题，大型协议通常会公布多轮审计报告。
<!-- DAILY_CHECKIN_2026-01-16_END -->

# 2026-01-15
<!-- DAILY_CHECKIN_2026-01-15_START -->


# 国内相关法律最新研究

1.  2026年1月1日施行修改后的《民事案件案由规定》，专门增加了第一级案由“数据、网络虚拟财产纠纷”，并且根据金杜律师事务所的调研结果——最高法研究室发表的署名文章“《民事案件案由规定》（2025年）的理解与适用”进一步明确了将虚拟货币、数字藏品（NFT）与网络游戏装备一同纳入网络虚拟财产的范畴。这意味着，若遇到加密货币相关的民事争议，不必再面对“案由不对，无法立案”的尴尬窘境。
    
2.  此外，2026年1月8日上海二中院与中国人大法学院联合主办的刑事判例研讨会上，围绕“涉虚拟货币犯罪案件的适法统一”问题，司法机关释放了以下信号：如果行为不具备经营行为特征，仅属于个人持币、炒币，一般不认定为非法经营罪。此次表态可以在“精准打击危害金融犯罪行为和避免普通个人投资行为被过度刑事化”上，做出了重要的指示。
    
3.  关于虚拟货币买卖，我认为使用人民币购买虚拟货币’时，如遇到支付人民币，而对方不支付相应虚拟货币的情况（非价格未谈拢而是诈骗情形），应积极采取措施维护自己的合法权利（如报警等），并不是所有的涉虚拟货币的行为都不受法律保护。
    

所以，尽管目前国内对虚拟货币的监管还处于高压态势，但我们web3从业者和相关人员，应该坚守自己的良知，做到“识别恶、不作恶、不助恶”，根据目前释放的信号，我们的合法权益在时间的见证下，也会得到更好的保障。
<!-- DAILY_CHECKIN_2026-01-15_END -->

# 2026-01-14
<!-- DAILY_CHECKIN_2026-01-14_START -->



6\. 账户类型与结构

-   EOA = 由“私钥”直接控制的钱包账户，能发交易、收资金、调合约，但自己\_不带代码逻辑\_。控制私钥的人 = 控制这个账户的一切。
    

主要风险：私钥/助记词丢失或泄露。

_注：_

a. nonce（交易计数器）对于EOA来说，表示本账户已经发生过几笔交易。一笔交易的nonce必须等于账户的nonce，打包成功后nonce+1，同一个nonce只允许执行一次，用以**防止重放攻击&保证交易有序**。

b. **一个交易在内存池还没被打包前，使用相同nonce+更高的Gas Fee可以替换掉旧交易**。收款地址填自己，金额可0或极小值，可以“取消”原交易；收款地址不变，金额改变，可以“加速”原交易。目前很多钱包都有内置的“Speed up”和“Cancel”功能，可以一键替换。

-   合约账户
    

可以持有ETH/token，内部存code（不可改）&storage（随调用改动），在执行中给其他地址转账、调用其他合约地址、使用CREATE/CREATE2创建新合约。

CREATE：地址 = f(sender, nonce) → 不可预测、不可重用

CREATE2：地址 = f(sender, salt, bytecode) → 可预测、可跨链统一、可重部署（存在风险）

主要风险：代码漏洞/逻辑错误/权限设计不当

-   ERC20/ERC721代币与合约账户的关系
    

地址中显示的“拥有”某个ERC20/ERC721代币，并不是地址里有代币，而是**对应的代币合约的storage里记录了某个地址拥有多少代币或者某个tokenID的owner是谁。**
<!-- DAILY_CHECKIN_2026-01-14_END -->

# 2026-01-13
<!-- DAILY_CHECKIN_2026-01-13_START -->





（书接上文）

4\. 以太坊的去中心化实现机制

1) 共识与出块（技术/经济层）：采用PoS共识，任何人只要抵押在32ETH及以上时，即可成为验证者（validator），参与区块提议和投票。每个slot，区块会在随机选择的提议者（proposer）中产出，同时数百验证者在同一时隙对链头进行投票（attestation），通过Gasper共识（Gasper-FFG提供终局性+LMD-GHOST提供链头选择）完成安全性与活性。

a. Slot是以太坊信标链（Beacon Chain / Consensus Layer）的时间基本单位，整个网络的时间被均匀切割成一个个 12秒的 slot。

b. Gasper = Casper-FFG 套在 LMD-GHOST 上面

-   日常运行时：验证者先用 LMD-GHOST 选链头 → 提议新块 → 其他人用 LMD-GHOST 投票支持。
    
-   同时，所有 attestation 里还携带 Casper-FFG 的投票（针对两个 checkpoint 之间）。
    
-   Casper-FFG 周期性地看这些投票，决定哪些块可以 justified/finalized。
    
-   结果：链快速生长（LMD-GHOST 保证活性） + 历史块被逐步锁定（Casper-FFG 保证安全性）。
    

| 组件 | 全称 | 主要职责 | 提供的主要属性 | 典型表现形式 |
| Casper-FFG | Casper Friendly Finality Gadget | 提供“终局性”（finality） | 安全性（Safety） | 把某些 checkpoint 升级为 finalized |
| LMD-GHOST | Latest Message Driven - GHOST | 提供“链头选择”（fork-choice） | 活性（Liveness） | 决定当前链头（head），链持续生长 |

2) 节点与网络（技术层）

以太坊执行层使用DevP2P协议维护点对点网络：

-   发现层（Discovery stack）基于UDP，用来发现和加入新节点；
    
-   DevP2P通信层基于TCP，负责在已连接节点间传递区块、交易等实际数据。
    

3) 以太坊的客户端多样性（实现层）

-   执行层客户端EL（Execution Client）：Geth、Nethermind、Besu、Erigon、Reth 等；
    
-   共识层客户端CL（Consensus Client）：Lighthouse、Prysm、Teku、Nimbus、Lodestar 等。
    

[clientdiversity.org](http://clientdiversity.org) 这类站点会定期占比过高的客户端，提醒质押者「换个少数派客户端」。目标是避免「一个客户端一旦出 bug，全网一起躺平」的单点风险。

4) MEV与PBS（市场结构层）

为缓解最大可提取价值MEV，引入了PBS（提议者-建构者分离）思路，主流的实现是协议外的MEV-boost中继系统：

可以理解为“区块拍卖中介”，从 Builder 收集高 MEV 区块，挑出给验证者报酬最高的那个 header，让验证者签名后广播完整区块，从而让所有验证者（不管大小）都能分到 MEV 大蛋糕，但引入了中心化与信任风险，未来会被协议ePBS 取代。

5) Rollup中心路线与数据去中心化（扩容/职责分离）

L1：更小、更稳，负责安全、数据共识；L2：执行负载、创新

6) 治理（社会层）

“客户端开发团队实现 + 节点运营者选择是否升级软件”共同决定是否升级。

5\. 网络结果与节点类型

1) 客户端类型：

-   干活的EL：监听交易与区块、在EVM中执行交易和智能合约、维护当前链的状态数据库（账户余额、合约储存等）、提供JSON-RPC接口（eth\_\*)、通过自己的P2P网络转发交易和区块头/区块体；
    
-   决策的CL：维护信标链视图和fork choice规则（LMD-GHOST等），每个slot中做出选择（区块提议）、并对区块做出投票，跟踪共识状态（验证者集合、质押余额、惩罚等），根据EL提供的结果，决定上链的区块；
    
-   陪审的Validator：管理验证者密钥，提议新区块，（区块）投票。用于质押、参与出块并获得奖励。
    

以太坊节点=EL+CL+Validator（验证者节点可选），CL需要Engine API来向EL发号施令。行客户端（EVM + JSON-RPC）——调用 eth\_\* / 部署合约 / 查状态执；共识客户端 + 验证者客户端——质押 32 ETH 做验证者 / 关心 attestation、finality、slashing。

2) 节点间的连接与通信方式

先找到人 → 再拉上加密专线 → 最后靠八卦（gossip）把消息传满全网。（Kademlia风格的DHT发现机制）

A. 节点发现（UDP+Kademlia）

a. 新节点给引导节点ping，引导节点回pong，确认引导节点在线；

b. 发送Findnode，请求，对方回复Neighbors（discv4）或者Nodes（discv5），里面是其他活跃节点的联系方式；

c. 对活跃节点重复以上操作，直到达到预设上限。

B. 建立安全连接（TCP+RLPx/devp2p）

a. TCP搭好稳定管道；

b. RLPx在一个TCP里多路复用多种协议：以太坊在 TCP 之上跑的是 devp2p 协议栈，其底层加密与多路复用由RLPx 负责。

C. Gossip+请求/响应传播“八卦”

Gossip用于传播新交易喝区块，请求/响应用于按需拉取缺失的历史区块、状态。
<!-- DAILY_CHECKIN_2026-01-13_END -->

# 2026-01-12
<!-- DAILY_CHECKIN_2026-01-12_START -->






_Tips_：各位uu们可线下编辑好，再粘贴到打开界面；如果电脑网页端打卡界面编辑时，一定要注意，鼠标不要！点击！界面以外的位置！编辑中的内容不会自动保存，会消失！（心痛教训）

真的非常开心能参加本次的web3实习计划，之前虽也参加过一两期共学营，但一直觉得掌握的不到位，有很多根上的东西不太明白。希望通过本次学习，能藉由循序渐进的学习路径和查漏补缺，全面理解web3和以太坊。

**前期笔记以查漏补缺为主**

1\. Gas Fee

EIP-1559之前，Gas Fee = Gas Used \* Gas Price

EIP-1559之后，Gas Fee ≈ （Base Fee + Priority Fee）\*Gas Used

其中，钱包中maxFeePerGas/maxPriorityFeePerGas是用户愿意支付的上限，实际扣费不会超过这个上限。

2\. dApp核心技术特征（为什么要用以太坊跑应用的底层逻辑）

1) 去中心化

2) 确定性（智能合约）

3) 图灵完备以及

4) 隔离性（沙盒）：dApp的执行被隔离在EVM里，单个合约逻辑的失败只会导致其自身的调用失败（回退），而不会使整个以太坊网络宕机；全网节点只是共同重放并验证同一套字节码，把终极信任从人/机构转移到了“确定性计算”本身，这是区块链能做到“极致去信任”的最关键密码学社会学机制之一。

3\. dApp开发的缺点/代价

1) 维护困难：合约部署后，默认无法更改

2) 性能开销与扩展难度：追求性能和价格，优先考虑L2；但最终安全性上还是要落在L1

3) 网络拥堵和Gas费问题：即便有L2，但部分高价值操作，如大额清算和跨链桥结算等，还是会回到L1；开发者应通过减少无谓存储/循环和前端Gas提醒，必要时支持多条L2切换来提升用户体验。

4) 用户门槛高：还是基于web3自身的普及率问题，需要时间，精进和推广。

5) “再中心化”倾向：为了降低门槛，有些产品会有在服务端代管私钥，把前端放在CDN上和链下逻辑链上结果的操作。

（未完待续）
<!-- DAILY_CHECKIN_2026-01-12_END -->
<!-- Content_END -->
