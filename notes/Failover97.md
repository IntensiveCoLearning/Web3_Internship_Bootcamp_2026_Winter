---
timezone: UTC+8
---

# Failover97

**GitHub ID:** Failover97

**Telegram:** 

## Self-introduction

Web3 å®ä¹ è®¡åˆ’ 2025 å†¬å­£å®ä¹ ç”Ÿ

## Notes

<!-- Content_START -->
# 2026-01-17
<!-- DAILY_CHECKIN_2026-01-17_START -->
### FrontRunning

åŒºå—é“¾ç½‘ç»œä¸Šçš„æ¯ç¬”äº¤æ˜“åœ¨æ‰§è¡Œå‰éƒ½ä¼šåœ¨å†…å­˜æ± ä¸­ç»å†ä¸€æ®µå¯è§æœŸã€‚è¿™ç§é€æ˜æ€§ä½¿å¾—ç½‘ç»œå‚ä¸è€…èƒ½å¤Ÿåœ¨äº¤æ˜“è¢«æ‰“åŒ…è¿›åŒºå—ä¹‹å‰æŸ¥çœ‹å¹¶å¯¹å…¶åšå‡ºå“åº”ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§ä¿¡æ¯æ³„éœ²æ¥å½±å“äº¤æ˜“çš„æ‰§è¡Œè¿‡ç¨‹ã€‚

**ç›´è§‰è§£é‡Š**ï¼šåˆ©ç”¨äº¤æ˜“åœ¨Mempoolä¸­çš„å¯è§æœŸï¼Œåœ¨ä¹‹å‰ã€ä¹‹ä¸­å’Œä¹‹åæ’æ‰‹ï¼Œæ”¹å˜ç»“æœï¼Œä»è€Œè¾¾åˆ°ç‰Ÿåˆ©çš„ç›®çš„ã€‚

**ç½®æ¢æ”»å‡»**

```jsx
pragma solidity ^0.8.17;

contract GuessTheNumberChallenge {
    bytes32 challenge;

    constructor(bytes32 _challenge) payable {
        require(msg.value == 1 ether);
        challenge = _challenge;
    }

    function isComplete() public view returns (bool) {
        return address(this).balance == 0;
    }

    function guess(uint256 number) public payable {
        require(msg.value == 1 ether, "Submission fee required");
        uint256 balance = address(this).balance;
        require(balance != 0, "Game has ended");

        bytes32 userChallenge = keccak256(abi.encode(number));
        if (userChallenge == challenge) {
            (bool success, ) = msg.sender.call{value: balance}("");
            require(success, "Transfer failed");
        }
    }
```

åˆçº¦é€»è¾‘ï¼š

çŒœæ•°å­—æ¸¸æˆï¼ŒçŒœåˆ°æ•°å­—çš„äººå¯ä»¥æå–åˆçº¦ä¸­æ‰€æœ‰çš„ä½™é¢

è¯¥ç³»ç»Ÿå­˜åœ¨ä¸€ä¸ªæ ¹æœ¬æ€§çš„è®¾è®¡ç¼ºé™·ã€‚å½“ç”¨æˆ·å‡†å¤‡æäº¤çŒœæµ‹æ—¶ï¼Œä»–ä»¬ä¼šè°ƒç”¨ä¸€ä¸ª`guess`å‡½æ•°å¹¶å°†çŒœæµ‹çš„æ•°å­—ä½œä¸ºå‚æ•°ä¼ é€’ã€‚é™¤éé‡‡å–ç‰¹æ®Šé¢„é˜²æªæ–½ï¼Œå¦åˆ™è¯¥äº¤æ˜“ä¼šåœ¨è¢«æŒ–çŸ¿å¹¶æ‰“åŒ…åˆ°åŒºå—ä¹‹å‰å°±å‡ºç°åœ¨å†…å­˜æ± ä¸­ã€‚è¿™ç§å¯è§æ€§ä½¿å¾—ä»»ä½•è§‚å¯Ÿè€…éƒ½æœ‰æœºä¼šå¤åˆ¶äº¤æ˜“æ•°æ®ï¼Œå…¶ä¸­åŒ…æ‹¬`guess`å‡½æ•°ç­¾ååŠå…¶å‚æ•°ã€‚

é€šç”¨æŠ¢å…ˆè€…å¯ä»¥å¤åˆ¶æ­¤äº¤æ˜“æ•°æ®ï¼Œå¹¶åœ¨åˆ†å‰ç½‘ç»œä¸Šæ¨¡æ‹Ÿè¯¥äº¤æ˜“ï¼ˆåˆ†å‰é“¾å±…ç„¶å¯ä»¥cloneä¸€ä¸ªåˆçº¦çš„æ‰€æœ‰çŠ¶æ€åŒ…æ‹¬çŠ¶æ€å‚æ•°çš„å€¼ï¼Ÿï¼Ÿï¼Ÿï¼‰ã€‚å¦‚æœäº¤æ˜“ç›ˆåˆ©ï¼Œä»–ä»¬å¯ä»¥é‡æ–°æäº¤å¤åˆ¶çš„æœ‰æ•ˆè½½è·ï¼Œå¹¶æ”¯ä»˜é«˜äºåŸå§‹ç”¨æˆ·çš„ gas ä»·æ ¼ã€‚è¿™ç§åœ¨ gas ä»·æ ¼æ‹å–ä¸­å‡ºä»·æ›´é«˜çš„è¡Œä¸ºï¼Œå¢åŠ äº†ä»–ä»¬çš„äº¤æ˜“åœ¨åŸå§‹ç”¨æˆ·äº¤æ˜“ä¹‹å‰è¢«æŒ–çŸ¿çš„æ¦‚ç‡ã€‚

è¿™ç§æƒ…å†µåæ˜ äº†æŠ¢å…ˆäº¤æ˜“çš„ä¸€ä¸ªå…³é”®æ–¹é¢ã€‚ä¸€æ—¦å¤åˆ¶çš„äº¤æ˜“æ•°æ®è¢«æäº¤å¹¶è¢«æŒ–çŸ¿ï¼ŒåŸå§‹äº¤æ˜“åœ¨æ™ºèƒ½åˆçº¦ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡ä¸­å°±å˜å¾—æ— å…³ç´§è¦äº†ã€‚

**æ’å…¥æ”»å‡»**

æ»‘ç‚¹çªƒå–æ”»å‡»æˆ–è€…å«å¤¹å¿ƒé¥¼å¹²ï¼ˆSandwich Attack)æ”»å‡»ã€‚

![image.png](attachment:9e1bc133-3f66-498a-ba4e-fde34d7850e7:image.png)

å‡è®¾ä½ å‘èµ·äº¤æ˜“ï¼ˆè¿›å…¥mempool)

æ‰€æœ‰äººéƒ½èƒ½çœ‹åˆ°ï¼šä½ è¦ä¹°ä»€ä¹ˆã€ä¹°å¤šå°‘ã€æ»‘ç‚¹æ˜¯å¤šå°‘ï¼ˆå¯æ¥å—çš„å·®ä»·èŒƒå›´ï¼‰

æ”»å‡»æ“ä½œï¼š

æ”»å‡»è€…æŠ¢å…ˆä¹°å¸â€”>æ¨é«˜ä»·æ ¼è‡³æ»‘ç‚¹å¯æ¥å—çš„æœ€é«˜ä»·â€”â€”>ä½ ä¹°å¸â€”â€”>æ”»å‡»è€…è¶æœºå–å‡ºâ€”â€”â†’\*\*ç»“æœï¼š\*\*æ”»å‡»è€…èµšåˆ°äº†ä½ æ¥å—çš„å·®ä»·

å±æœºç›´è§‰ï¼šåªè¦ç”¨æˆ·äº¤æ˜“å…¬å¼€ã€ä»·æ ¼å³æ—¶æ“çºµã€åªè¦å­˜åœ¨æ»‘ç‚¹å°±æœ‰è¢«å¤¹ç©ºé—´

**æŠ‘åˆ¶æ”»å‡»ï¼ˆblock stuffing)**

æ”»å‡»ç›®çš„ï¼šè®©æŸäº›å…³é”®äº¤æ˜“æ™šè¿›åŒºå—ï¼Œæ¥è¾¾åˆ°æ“çºµå¸‚åœºçš„ç›®çš„ï¼šæ¯”å¦‚é¢„è¨€æœºæ›´æ–°ã€æ¸…ç®—ã€å¼€å¥–ã€æœ€åä¸€ç¬”æŠ¢è´­ã€‚

æ‰‹æ®µï¼šæ”»å‡»è€…ç”¨é«˜ä¼˜å…ˆçº§è´¹ç”¨+é«˜gasæ¶ˆè€—å æ»¡åŒºå—å®¹é‡ï¼Œè®©åˆ«äººçš„äº¤æ˜“è¿ç»­å‡ ä¸ªåŒºå—éƒ½è¿›ä¸å»ï¼Œä»è€Œæ”¹å˜ç»“æœæˆ–è€…åˆ¶é€ ç³»ç»Ÿæ€§é£é™©ã€‚

EIP-1559ç¼“è§£é£é™©â€”â€”æŠŠâ€œæŒç»­å¡«æ»¡åŒºå—â€çš„æˆæœ¬æŠ¬é«˜

```jsx
// EIP-1559 ä¹‹å‰
äº¤æ˜“è´¹ç”¨ = gasUsed Ã— gasPrice
// gasPrice å…¨éƒ¨ç»™çŸ¿å·¥

// åŒºå—å®¹é‡å›ºå®š
åŒºå— gas limit = 15,000,000 gas
```

æˆæœ¬ï¼šconst attackCost = (blockGasLimit Ã— attackGasPrice) / 1e9;

æ”»å‡»æˆæœ¬æœ‰é™ï¼›å¦‚æœæ”»å‡»è€…æœ¬èº«å°±æ˜¯çŸ¿å·¥å°±å¯ä»¥å…è´¹å¡«å……è‡ªå·±çš„åŒºå—

EIP-1599çš„æ–°çš„è´¹ç”¨ç»“æ„

```jsx
// EIP-1559 ä¹‹å
äº¤æ˜“è´¹ç”¨ = (baseFee + priorityFee) Ã— gasUsed

// baseFeeï¼šåŸºç¡€è´¹ï¼Œè¢«é”€æ¯ ğŸ”¥
// priorityFeeï¼šå°è´¹ï¼Œç»™éªŒè¯è€…
// Base Fee è°ƒæ•´æœºåˆ¶

if (ä¸Šä¸€ä¸ªåŒºå—ä½¿ç”¨é‡ > ç›®æ ‡å®¹é‡) {
    baseFee å¢åŠ  12.5%
} else if (ä¸Šä¸€ä¸ªåŒºå—ä½¿ç”¨é‡ < ç›®æ ‡å®¹é‡) {
    baseFee å‡å°‘ 12.5%
}

// å¼¹æ€§åŒºå—
ç›®æ ‡å®¹é‡ = 15,000,000 gas
æœ€å¤§å®¹é‡ = 30,000,000 gas (2å€å¼¹æ€§)
```

![image.png](attachment:6b9ffd4e-c1e6-4482-befc-dcf695d3a2f5:image.png)

**æ¶æ„æ”»å‡»**

æ‹’ç»æœåŠ¡æ”»å‡»

```jsx
pragma solidity ^0.8.17;

contract DelayedWithdrawal {
    address beneficiary;
    uint256 delay;
    uint256 lastDeposit;

    constructor(uint256 _delay) {
        beneficiary = msg.sender;
        lastDeposit = block.timestamp;
        delay = _delay;
    }

    modifier checkDelay() {
        require(block.timestamp >= lastDeposit + delay, "Keep waiting");
        _;
    }

    function deposit() public payable {
        require(msg.value != 0);
        lastDeposit = block.timestamp;
    }

    function withdraw() public checkDelay {
        (bool success, ) = beneficiary.call{value: address(this).balance}("");
        require(success, "Transfer failed");
    }
}
```

å»¶è¿Ÿæç°åˆçº¦ï¼šå—ç›Šäººå¿…é¡»åœ¨lastDepositæ—¶é—´æˆ³+delayçš„æ—¶é—´é—´éš”æ‰èƒ½å®ç°å–ç°ã€‚ç„¶è€Œæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¸æ–­çš„æ›´æ–°lastDepositï¼Œå¯¼è‡´å—ç›Šäººæ— æ³•æç°ã€‚

**æ¯’æ°”æ¶æ„æ”»å‡»ï¼ˆInfficient Gas Griefing)**

è¿™ç§æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½åªæä¾›è¶³å¤Ÿçš„gasæ¥ç¡®ä¿é¡¶å±‚å‡½æ•°æˆåŠŸæ‰§è¡Œï¼ŒåŒæ—¶ç¡®ä¿å¤–éƒ¨è°ƒç”¨å› gasè€—å°½è€Œå¤±è´¥ã€‚ç”±äº[63/64è§„åˆ™](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-150.md)ï¼Œé¡¶å±‚åˆçº¦å¯ä»¥å®Œæˆå…¶å‡½æ•°è°ƒç”¨ï¼Œè€Œé¡¶å±‚å‡½æ•°ä¸æ£€æŸ¥å¤–éƒ¨è°ƒç”¨æ˜¯å¦æˆåŠŸï¼Œä»è€Œå¯¼è‡´åˆçº¦ç›®çš„æœ€ç»ˆä¸èƒ½æ‰§è¡Œã€‚

å¸¸è§æ¯’æ°”æ”»å‡»åˆçº¦ï¼šæ­¤ç±»é—®é¢˜åœ¨æ‰§è¡Œ**é€šç”¨è°ƒç”¨**çš„æ™ºèƒ½åˆçº¦ä¸­å°¤ä¸ºå¸¸è§ï¼Œä¾‹å¦‚ä¸­ç»§å™¨å’Œå¤šé‡ç­¾åé’±åŒ…ã€‚

```jsx
contract Relayer {
    // è®°å½•å“ªäº›æ•°æ®å·²ç»æ‰§è¡Œè¿‡ï¼ˆé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰
    mapping (bytes => bool) executed;
    
    // ç›®æ ‡åˆçº¦åœ°å€
    address target;
    
    function forward(bytes memory _data) public {
        // æ­¥éª¤ 1ï¼šæ£€æŸ¥è¿™ä¸ªæ•°æ®æ˜¯å¦å·²ç»æ‰§è¡Œè¿‡
        require(!executed[_data], "Replay protection");
        
        // æ­¥éª¤ 2ï¼šï¼ˆä»£ç ä¸­çœç•¥ï¼‰éªŒè¯ç­¾å
        // ... signature validation ...
        
        // âŒ æ­¥éª¤ 3ï¼šæ ‡è®°ä¸ºå·²æ‰§è¡Œï¼ˆå±é™©ï¼å…ˆæ”¹çŠ¶æ€ï¼‰
        executed[_data] = true;
        
        // âŒ æ­¥éª¤ 4ï¼šå¤–éƒ¨è°ƒç”¨ï¼ˆæ²¡æ£€æŸ¥è¿”å›å€¼ï¼ï¼‰
        target.call(abi.encodeWithSignature("execute(bytes)", _data));
        //     â†‘
        //   è¿™å°±æ˜¯å¤–éƒ¨è°ƒç”¨ï¼
    }
}
```
<!-- DAILY_CHECKIN_2026-01-17_END -->

# 2026-01-15
<!-- DAILY_CHECKIN_2026-01-15_START -->

## Exposed Data

åŒºå—é“¾çœ‹ä¼¼åŒ¿åçš„ç‰¹æ€§å¯èƒ½ä¼šç»™ç”¨æˆ·å¸¦æ¥è™šå‡çš„å®‰å…¨æ„Ÿã€‚åªè¦é“¾ä¸Šæ‹¥æœ‰è¶³å¤Ÿçš„æ•°æ®ï¼Œç”¨æˆ·çš„åŒ¿åæ€§å°±å¾ˆå®¹æ˜“è¢«ç ´è§£ã€‚ä¸ªäººèº«ä»½ä¿¡æ¯ï¼ˆPIIï¼‰

**æ•°æ®ä¿æŠ¤åˆè§„æ€§**

å¯¹äºå°†PIIå­˜å‚¨åœ¨é“¾ä¸Šæ—¶è¿åä¾‹å¦‚(GDPR)æ¬§ç›Ÿçš„ã€Šé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹ã€‹çš„è¦æ±‚ã€‚

é™¤äº†PIIä¹‹å¤–IPåœ°å€å’Œç”µå­é‚®ä»¶ç­‰ä¿¡æ¯å­˜å‚¨åœ¨é“¾ä¸Šä¹Ÿä¼šé€ æˆå·¨å¤§é£é™©ã€‚

## FrontRunningï¼ˆä»Šå¤©å¤ªç´¯äº†å…³äºæŠ¢è·‘è¿˜æœ‰ä¸€äº›å†…å®¹æ²¡å­¦å®Œï¼Œæ˜å¤©è¡¥å…… ï¼‰

åŒºå—é“¾ç½‘ç»œä¸Šçš„æ¯ç¬”äº¤æ˜“åœ¨æ‰§è¡Œå‰éƒ½ä¼šåœ¨å†…å­˜æ± ä¸­ç»å†ä¸€æ®µå¯è§æœŸã€‚è¿™ç§é€æ˜æ€§ä½¿å¾—ç½‘ç»œå‚ä¸è€…èƒ½å¤Ÿåœ¨äº¤æ˜“è¢«æ‰“åŒ…è¿›åŒºå—ä¹‹å‰æŸ¥çœ‹å¹¶å¯¹å…¶åšå‡ºå“åº”ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§ä¿¡æ¯æ³„éœ²æ¥å½±å“äº¤æ˜“çš„æ‰§è¡Œè¿‡ç¨‹ã€‚
<!-- DAILY_CHECKIN_2026-01-15_END -->

# 2026-01-14
<!-- DAILY_CHECKIN_2026-01-14_START -->


# JSçš„ç‰¹ç‚¹

åœ¨ JavaScript é‡Œï¼ŒæŸäº›æ“ä½œï¼ˆæ¯”å¦‚**è¯»å–æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“æŸ¥è¯¢ã€åŒºå—é“¾äº¤äº’**ç­‰ï¼‰éœ€è¦**ä¸€å®šçš„æ—¶é—´**æ‰èƒ½å®Œæˆã€‚JavaScript é‡‡ç”¨**å¼‚æ­¥ç¼–ç¨‹ï¼ˆå¼‚æ­¥çš„æ„æ€æŒ‡çš„æ˜¯å¥½å‡ ä¸ªè€—æ—¶çº¿ç¨‹å¯ä»¥å¹¶è¡Œæ“ä½œï¼Œä¸ä¼šè¢«block)**æ¥é¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚`await` è®©ä»£ç  **æŒ‰é¡ºåºæ‰§è¡Œ**ï¼Œé¿å…å‡ºç°æœªå®Œæˆçš„ä»»åŠ¡å¯¼è‡´é”™è¯¯ã€‚ é»˜è®¤ä¼šæŠŠ **I/O æ“ä½œï¼ˆå¦‚æ•°æ®åº“ã€ç½‘ç»œè¯·æ±‚ã€åŒºå—é“¾è°ƒç”¨ï¼‰** è®¾ä¸ºå¼‚æ­¥

### ä»€ä¹ˆæ˜¯åˆçº¦å·¥å‚ï¼Ÿ

åˆçº¦å·¥å‚ï¼ˆContract Factoryï¼‰**æ˜¯ç”¨äºéƒ¨ç½²æ–°æ™ºèƒ½åˆçº¦çš„å¯¹è±¡**ã€‚åœ¨ Hardhat + Ethers.js ä¸­ï¼Œä½ ä¸èƒ½ç›´æ¥åˆ›å»ºåˆçº¦å®ä¾‹ï¼Œè€Œæ˜¯éœ€è¦å…ˆè·å–åˆçº¦å·¥å‚ï¼Œç„¶åå†éƒ¨ç½²åˆçº¦ã€‚

**è¿™å’Œç°å®ä¸­çš„â€œå·¥å‚â€å¾ˆç±»ä¼¼**ï¼š

-   **åˆçº¦æ–‡ä»¶ (**`DiceMarket.sol`**)** å°±åƒ**è“å›¾**ã€‚
    
-   **åˆçº¦å·¥å‚ (**`getContractFactory("DiceMarket")`**)** å°±åƒä¸€ä¸ª**å·¥å‚**ï¼Œå¯ä»¥æ ¹æ®**è“å›¾**ç”Ÿäº§å¤šä¸ªåˆçº¦å®ä¾‹ã€‚
    
-   **éƒ¨ç½²åçš„åˆçº¦ (**`DiceMarket.deploy(...)`**)** å°±åƒ**æœ€ç»ˆç”Ÿäº§å‡ºæ¥çš„äº§å“**ã€‚
    

# å…³é”®å­—

### async

-   ç”³æ˜ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè¿”å›å€¼å§‹ç»ˆæ˜¯Promise
    
-   å¦‚æœå‡½æ•°å†…éƒ¨è¿”å›çš„æ˜¯æ™®é€šå€¼ï¼ŒJavaScriptä¼šè‡ªåŠ¨å°è£…æˆPromise.resolve(è¿”å›å€¼ï¼‰
    

```
async function hello() {
    return "Hello, world!";
}

hello().then(console.log); // è¾“å‡º: Hello, world!ç”±äºå…³é”®å­—çš„ä½œç”¨ï¼Œæ‰€ä»¥éœ€è¦ç”¨.then()å¤„ç†
```

### await

è¯¥å…³é”®å­—åªèƒ½åœ¨async functionå†…éƒ¨ä½¿ç”¨ï¼Œ

å®ƒä¼šæš‚åœå‡½æ•°çš„æ‰§è¡Œï¼Œç›´åˆ°Promiseè§£æï¼ˆresolve),ç„¶åè¿”å›Promiseè§£æä¹‹åçš„å€¼

```
function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

async function run() {
    console.log("å¼€å§‹");
    await delay(2000); // ç­‰å¾… 2 ç§’
    console.log("2 ç§’åæ‰§è¡Œ");
}

run();
```

ä»£ç é‡Œçš„è¯­æ³•ï¼š

new Promise((resolve,reject)=>{.....}

resolveæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¡¨ç¤ºæˆåŠŸæ—¶å€™è°ƒç”¨

rejectä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¡¨ç¤ºå¤±è´¥æ—¶å€™è°ƒç”¨

setTimeout(resolve,ms)

setTimeoutæ˜¯JavaScriptçš„å®šæ—¶å™¨å‡½æ•°ï¼Œä½œç”¨æ˜¯ç­‰å¾…ä¸€æ®µæ—¶é—´åæ‰§è¡ŒæŸä¸ªæ“ä½œ

setTimeout(resolve,ms)ä»£è¡¨ç­‰å¾…msæ¯«ç§’åæ‰§è¡Œresolve()

### console

åœ¨ JavaScript ä¸­ï¼Œ`console` æ˜¯ä¸€ä¸ª**å…¨å±€å¯¹è±¡**ï¼Œä¸»è¦ç”¨äº**æ‰“å°è°ƒè¯•ä¿¡æ¯**ï¼Œå¸®åŠ©å¼€å‘è€…æŸ¥çœ‹ä»£ç çš„æ‰§è¡Œæƒ…å†µã€‚æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ `console.log()`ï¼Œä½† `console` è¿˜æœ‰å¾ˆå¤šå…¶ä»–åŠŸèƒ½ã€‚

```
console.log("Hello, JavaScript!");
```

consoleçš„å…¶ä»–ç”¨æ³•

![](https://cdn.nlark.com/yuque/0/2025/png/34360919/1741086687786-5e0d8cd5-cb6c-401b-aa9d-4a4a85756fe5.png)

# å˜é‡å£°æ˜å’Œæ•°æ®ç±»å‹

### å˜é‡å£°æ˜çš„ä¸‰ç§æ–¹å¼

```
// let - æ¨èä½¿ç”¨,å¯ä»¥é‡æ–°èµ‹å€¼
let age = 25;
age = 26; // å…è®¸

// const - ç”¨äºå¸¸é‡,ä¸èƒ½é‡æ–°èµ‹å€¼
const PI = 3.14;
// PI = 3.15; // è¿™ä¼šæŠ¥é”™

// var - æ—§ç‰ˆæœ¬ä½¿ç”¨,ç°åœ¨ä¸æ¨è
var name = "John";
```

### åŸºæœ¬æ•°æ®ç±»å‹

```
// æ•°å­— (Number)
let count = 42;        // æ•´æ•°
let price = 99.99;     // å°æ•°
let infinity = Infinity;//ç‰¹æ®Šç”¨æ³•ï¼Œè¡¨ç¤ºæ— ç©·å¤§
let notANumber = NaN;//not a number

// å­—ç¬¦ä¸² (String)
let firstName = "Alice";
let greeting = 'Hello';
let message = `Hello ${firstName}`; // æ¨¡æ¿å­—ç¬¦ä¸²

// å¸ƒå°”å€¼ (Boolean)
let isActive = true;
let isLoggedIn = false;

// ç©ºå€¼
let empty = null;
let undefined;

// æ•°ç»„ (Array);â¤è¿™é‡Œçš„æ•°ç»„è·Ÿpythoné‡Œé¢çš„åˆ—è¡¨ç‰¹åˆ«åƒ
let colors = ['red', 'green', 'blue'];
let numbers = [1, 2, 3, 4, 5];

// å¯¹è±¡ (Object) å¯¹è±¡éå¸¸åƒCè¯­è¨€é‡Œé¢çš„ç»“æ„ä½“
let person = {
    name: "Alice",
    age: 25,
    isStudent: true
};
```

### ç±»å‹è½¬æ¢

```
// è½¬æ¢ä¸ºæ•°å­—
let strNumber = "123";
let num1 = Number(strNumber);    // 123
let num2 = parseInt(strNumber);  // 123
let num3 = parseFloat("123.45"); // 123.45  
let bigNum=BigInt("123455677766");//bigintä¸“é—¨ç”¨äºå¤§æ•´æ•°

// è½¬æ¢ä¸ºå­—ç¬¦ä¸²
let number = 123;
let str1 = String(number);      // "123"
let str2 = number.toString();   // "123"

// è½¬æ¢ä¸ºå¸ƒå°”å€¼
let bool1 = Boolean(1);         // true
let bool2 = Boolean("");        // false
let bool3 = Boolean("hello");   // true
```

NaN

not a numberï¼›é€šå¸¸ç”¨äºç”¨æˆ·çš„è¾“å…¥æ ¡éªŒ

```
// 1. éªŒè¯ç”¨æˆ·è¾“å…¥æ˜¯å¦ä¸ºæœ‰æ•ˆæ•°å­—
function validateUserInput(input) {
    let number = parseFloat(input);
    if (isNaN(number)) {
        return "è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—";
    }
    return "è¾“å…¥æœ‰æ•ˆ";
}

// 2. æ•°å­¦è®¡ç®—é”™è¯¯æ£€æŸ¥
function divideNumbers(a, b) {
    let result = a / b;
    if (isNaN(result)) {
        return "è®¡ç®—å‡ºé”™";
    }
    return result;
}
```

æ³¨æ„æ ¡éªŒNaNä¸éœ€è¦ç”¨==å·ï¼Œå¯ä»¥ç›´æ¥ç”¨isNaN

### Hoisting

functionå…³é”®å­—å®šä¹‰çš„å‡½æ•°ä¼šè¢«å®Œæ•´çš„æå‡ï¼Œå¯ä»¥åœ¨å®šä¹‰å‰è°ƒç”¨

```
hello(); // è¾“å‡º: Hello, world!

function hello() {
    console.log("Hello, world!");
}
/*å…¶å®å°±ç›¸å½“äº*/
function hello() { // å‡½æ•°å£°æ˜è¢«æå‡
    console.log("Hello, world!");
}

hello(); // è°ƒç”¨
```

### ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°çš„è¯­æ³•

**const å‡½æ•°å = (å‚æ•°) => { å‡½æ•°ä½“ }**

```
const add = (a, b) => {
    return a + b;
};
console.log(add(2, 3)); // è¾“å‡º: 5
```

**éšå¼è¿”å›**

å¦‚æœå‡½æ•°ä½“åªæœ‰ä¸€è¡Œreturnè¯­å¥ï¼Œå¯ä»¥çœç•¥{}å’Œreturn

```
const multiply = (a, b) => a * b;
console.log(multiply(3, 4)); // è¾“å‡º: 12
```

**å‚æ•°è§„åˆ™**

![](https://cdn.nlark.com/yuque/0/2025/png/34360919/1740129457676-5a38cb23-b7a6-4133-b9da-904012844f42.png)
<!-- DAILY_CHECKIN_2026-01-14_END -->

# 2026-01-13
<!-- DAILY_CHECKIN_2026-01-13_START -->



**unchecked:**

é¿å…solidity 0.8.0å¼€å§‹çš„ç¼–è¯‘å™¨è‡ªåŠ¨å¯¹åˆçº¦åšæ•°å­¦å®‰å…¨æ£€æŸ¥ï¼Œæ¶ˆè€—gas.(é«˜é¢‘å‡½æ•°éå¸¸åœ¨æ„gas)

é¿å…ä½¿ç”¨uncheckedçš„åœºæ™¯ï¼š

1.  è¾“å…¥æ¥è‡ªç”¨æˆ·
    
2.  æ¡ä»¶ä¾èµ–å¤–éƒ¨åˆçº¦
    
3.  æ²¡æœ‰æ˜¾å¼è¾¹ç•Œæ£€æŸ¥
    
4.  é‡‘é¢/ç´¢å¼•/balanceæ“ä½œ
    

## å±é™©è°ƒç”¨

### **abi.encodePacked()**

åŠŸèƒ½ï¼šæŠŠå‡ æ®µå­—ç¬¦æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œä¸åŠ åˆ†éš”ç¬¦

æ¯”è¾ƒå®‰å…¨çš„æ–¹æ³•ï¼Œæ‹¼æ¥å›ºå®šå­—èŠ‚

-   `uint256` å›ºå®š 32 å­—èŠ‚
    
-   `address` å›ºå®š 20 å­—èŠ‚
    
-   `bytes32` å›ºå®š 32 å­—èŠ‚
    

abi.encodePacked+åŠ¨æ€ç±»å‹ +hash/æˆæƒ/æ ¡éªŒ =ï¼ï¼ï¼é£é™©

### Ambiguous evaluation order

```jsx
function foo() public pure returns(uint){
uint x=5;
return x*x++;//could be 25 or 30
}
```

vulnerability mitigation:storing intermidiate results in temporary variables.

### Approval Vulnerabilities

**æ— é™å®¡æ‰¹æ¼æ´ï¼ˆæƒé™å¤±æ§ï¼‰**

```jsx
approve(spender,type(uint256).max)
```

ç‰¹ç‚¹ï¼šæˆæƒé¢åº¦æ— é™ã€æˆæƒæ—¶é—´æ°¸ä¹…ã€ä¸ç»‘å®šå…·ä½“äº¤æ˜“\\ä¸šåŠ¡æ¡ä»¶

æ”»å‡»è·¯å¾„ï¼š

1ã€ç”¨æˆ·æˆæƒæ— é™å®¡æ‰¹ï¼ˆåˆçº¦Aï¼‰

2ã€åˆçº¦Aï¼š

-   è¢«é»‘
    
-   æœ‰åé—¨
    
-   ownerä½œæ¶
    

3ã€æ”»å‡»è€…è·å¾—åˆçº¦æ§åˆ¶æƒ

4ã€è°ƒç”¨

```jsx
token.transferFrom(
	user,
	attacker,
	token.balanceOf(user)
	);
```

**å®¡æ‰¹æŠ¢å…ˆ**

æ”»å‡»è€…åœ¨å—å®³è€…ä¿®æ”¹æˆæƒé¢åº¦ä¹‹å‰ï¼Œæå‰èŠ±å®ŒåŸæœ‰çš„æˆæƒé¢åº¦ã€‚ï¼ˆERC20ï¼‰

ä¾‹å­ï¼š

1.  é€šè¿‡æ­¤`approve x`åŠŸèƒ½ï¼Œç”¨æˆ·å…è®¸æ™ºèƒ½åˆçº¦ç³»ç»Ÿè½¬ç§»
    
    å…¶ ERC20 ä»£å¸ã€‚
    
2.  åæ¥ï¼Œä»–ä»¬é€‰æ‹©ä¿®æ”¹æˆæƒé‡‘é¢ï¼Œ`approve` y å¹¶å› æ­¤å‘é€äº†å¦ä¸€ä»½è¯·æ±‚ã€‚
    
3.  ä¸æ­¤åŒæ—¶ï¼Œåœ¨ç”¨æˆ·æä¾›çš„äº¤æ˜“è¢«åŒ…å«ä¹‹å‰ï¼Œæ”»å‡»è€…å¯åŠ¨äº†ä»ç”¨æˆ·é’±åŒ…ä¸­`transferFrom x`åˆ é™¤ä»£å¸çš„åŠŸèƒ½ã€‚
    
4.  å¦‚æœæ”»å‡»è€…çš„äº¤æ˜“å…ˆè¢«å¤„ç†ï¼Œç„¶åç”¨æˆ·çš„æ–°`approve y`äº¤æ˜“æ‰è¢«å¤„ç†ï¼Œé‚£ä¹ˆæ¶æ„è¡Œä¸ºè€…å°±å¯ä»¥è½¬ç§»é¢å¤–çš„ä»£å¸ã€‚
    
5.  æœªç»æˆæƒçš„è½¬è´¦æ€»é¢å°†è¾¾åˆ°`x+y`ä»£å¸çº§åˆ«ã€‚
    

```jsx
//allowancesçŠ¶æ€å˜é‡
mapping(address=>mapping(address=>uint256) private_allowances;
_allowances[owner][spender]=æˆæƒé¢åº¦è¿˜å‰©ä¸‹å¤šå°‘ 
```

```jsx
//ERC20æˆæƒæ¨¡å‹
approve(spender,value);//è®¾ç½®æˆæƒé¢åº¦
transferFrom(owner,to,x);//åœ¨é¢åº¦å†…è½¬è´¦
```

**Recommended Best Practices for Approval and Allowance Management**

é’ˆå¯¹ **ERC-20** æˆæƒæ›´æ–°å¯èƒ½å¼•å‘çš„æŠ¢è·‘é£é™©ï¼Œä¸€ä¸ªç›´æ¥çš„ç¼“è§£æªæ–½æ˜¯ä¼˜åŒ– allowance ç®¡ç†æ–¹å¼ã€‚ç›¸æ¯”é€šè¿‡approveä»¥è¦†ç›–å¼å†™å…¥æ–°æˆæƒå€¼ï¼Œæ›´æ¨èé‡‡ç”¨**å¢é‡è°ƒæ•´**çš„æ¨¡å¼ï¼Œä¾‹å¦‚ä½¿ç”¨ OpenZeppelin SafeERC20æä¾›çš„ safeIncreaseAllowance ä¸ safeDecreaseAllowance æ¥æŒ‰å·®å€¼æ›´æ–°æˆæƒé¢åº¦ï¼Œä»è€Œé™ä½åœ¨â€œä¿®æ”¹æˆæƒé¢åº¦â€åœºæ™¯ä¸‹å‡ºç°ç«æ€æ¡ä»¶çš„æ¦‚ç‡ã€‚

å¦ä¸€æ–¹é¢ï¼Œâ€œapproval phishingï¼ˆå®¡æ‰¹é’“é±¼ï¼‰â€è™½ä¸å±äºåˆçº¦ä»£ç å±‚é¢çš„æ¼æ´ï¼Œä½†åœ¨å‰ç«¯é­å—å†…å®¹æ³¨å…¥æˆ–è¢«ç¯¡æ”¹æ—¶ï¼Œæ”»å‡»è€…å¯å°†æˆæƒç›®æ ‡ä»é¢„æœŸåˆçº¦åœ°å€æ›¿æ¢ä¸ºå…¶æ§åˆ¶åœ°å€ï¼Œè¯±å¯¼ç”¨æˆ·å®Œæˆæ¶æ„æˆæƒã€‚ä¸ºé™ä½é£é™©ï¼Œå¼€å‘è€…åº”éµå¾ªæœ€å°æƒé™åŸåˆ™ï¼Œä»…æˆæƒä¸šåŠ¡æ‰€éœ€çš„æœ€å°é¢åº¦ï¼Œå¹¶åœ¨å¿…è¦æ—¶é‡‡ç”¨æ›´ä¸¥æ ¼çš„äº¤äº’æµç¨‹ï¼ˆä¾‹å¦‚ä¸¤æ­¥æ“ä½œã€é™é¢æˆ–å»¶æ—¶æœºåˆ¶ï¼‰ä»¥å‡å°‘å•æ¬¡æ¶æ„è¡Œä¸ºçš„å½±å“ï¼›ç”¨æˆ·åˆ™åº”å…»æˆå®šæœŸæ£€æŸ¥ä¸æ’¤é”€ä¸å†ä½¿ç”¨æˆæƒçš„ä¹ æƒ¯ï¼Œå¯å€ŸåŠ© [revoke.cash](http://revoke.cash) ç­‰å·¥å…·è¿›è¡Œæˆæƒæ¸…ç†ã€‚

# Remix

### contractæŒ‰é”®æ˜¾ç¤ºè§„åˆ™

**å˜é‡**

PublicçŠ¶æ€å˜é‡ï¼Œè‡ªåŠ¨å½¢æˆè“è‰²æŒ‰é’®å˜æˆgetter

**å‡½æ•°**

View/Pureå‡½æ•°ï¼Œè‡ªåŠ¨å˜æˆè“è‰²æŒ‰é’®ï¼Œåªè¯»

External/Publicå‡½æ•°ï¼Œæ©™è‰²æŒ‰é’®ï¼ˆä¼šæ”¹å˜çŠ¶æ€ï¼‰

Payableå‡½æ•°ï¼Œçº¢è‰²æŒ‰é’®ï¼ˆå¯ä»¥æ¥å—ETHï¼‰

![image.png](attachment:5a65c35f-3909-407a-9257-37db4007463b:image.png)
<!-- DAILY_CHECKIN_2026-01-13_END -->

# 2026-01-12
<!-- DAILY_CHECKIN_2026-01-12_START -->




![image.png](attachment:5211f265-6361-475e-ae51-59654d33eee4:image.png)

![image.png](attachment:5c11b668-535e-4415-b6b6-8f19c1688dd6:image.png)

![image.png](attachment:324ff638-f490-47ae-9054-3bf3a6d3c66d:image.png)

## grammar

**å››ç§å˜é‡å¯è§æ€§å‡½æ•°**

| å¯è§æ€§ | å…è®¸è°ƒç”¨ä½ç½® | å¸¸è§ç”¨é€” |
| --- | --- | --- |
| public | åˆçº¦å†…éƒ¨+å¤–éƒ¨+å­åˆçº¦ | é»˜è®¤æ¥å£+å¯¹å¤–æ–¹æ³• |
| external | å¤–éƒ¨è°ƒç”¨ only | å¯¹å¤–APIï¼ŒèŠ‚çœgas |
| internal | åˆçº¦å†…éƒ¨+è‡ªåˆçº¦ | å†…éƒ¨é€»è¾‘ |
| private | ä»…å½“å‰åˆçº¦ | å°è£…ç»†èŠ‚ |

**modifier**:ä¿®é¥°ç¬¦ï¼Œç»™å‡½æ•°åˆ›å»ºå‰ç½®æ¡ä»¶

```jsx
modifier onlyOwner(){
require(msg.sender == owner, "not owner");
_;//å ä½ç¬¦ï¼Œè‹¥ç¬¦åˆæ¡ä»¶åœ¨è¿™é‡Œæ‰§è¡Œå‡½æ•°
}
```

**constructor:**æ„é€ å‡½æ•°ï¼Œç”¨äºåˆå§‹åŒ–è®¾ç½®ï¼ˆåˆçº¦éƒ¨ç½²æ—¶è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼‰

```jsx
constructor(){
	owner=msg.sender;
	}
```

**receive()**:æ”¶é’±å‡½æ•°;

```jsx
receive() external payable{} //ä¸“é—¨ä»å¤–éƒ¨æ¥å—Eth
```

**calldata:** å¤–éƒ¨è°ƒç”¨çš„ä¸å¯ä¿®æ”¹çš„å‡½æ•°å‚æ•°ï¼›ï¼ˆçœgas)

```jsx
function transferMany(address[] calldata users)//é€šå¸¸æ˜¯externalçš„å‡½æ•°å‚æ•°ï¼Œæˆ–è€…æ˜¯å¤æ‚å¤§çš„å‚æ•°
```

**keccak256:**ä»»æ„é•¿åº¦çš„bytesç±»å‹ï¼Œå˜æˆ32ä½çš„hashä¸²

```jsx
bytes32 h = keccak256(data)
```

**require**(æ¡ä»¶ï¼Œâ€œé”™è¯¯ä¿¡æ¯â€ï¼‰ï¼›

if true â€”â†’ ç»§ç»­æ‰§è¡Œåç»­ä»£ç 

if false â€”â†’ ç«‹å³åœæ­¢ï¼ŒæŠ¥é”™å¹¶ä¸”å›æ»šæ‰€æœ‰æ“ä½œ âŒ

**emit:ç”¨æ¥å‡ºå‘eventçš„å…³é”®å­—ï¼Œå¾€åŒºå—é“¾æ—¥å¿—é‡Œå†™ä¸€æ¡äº‹ä»¶è®°å½•ã€‚**

```jsx
event Transfer(address from, address to, uint256 value);
function send(address to, uint256 amount) public{
balances[msg.sender]-=amount;
balances[to]+=amount;

emit Transfer(msg.sender,to,amount);
}
```

è®¾è®¡ç›®çš„ï¼š

1ã€ç»™å‰ç«¯/dAppç”¨

2ã€ç»™é“¾ä¸‹ç³»ç»Ÿç”¨ åç«¯å¯ä»¥ç›‘å¬é“¾ä¸Šè¡Œä¸º

3ã€æ¯”å­˜storageä¾¿å®œå¾ˆå¤šï¼ˆçœgas)

**call: low-level call**

```jsx
(bool ok,)=users[i].call{value:reward)(" ");//ç»™ç”¨æˆ·åœ°å€iè½¬reward weiæ•°é‡çš„ehter å¹¶ä¸”è¯»å–æ˜¯å¦æˆåŠŸæ•°æ®
address.call(bytes) //å‘èµ·ä¸€æ¬¡åº•å±‚call,è¿”å›trueæˆ–è€…falseçš„æ•°æ®

ï¼ˆbool ok,) = users[i].call{value: reward}(" ");
require(ok,"ETH transfer failed");
```

## å±é™©è°ƒç”¨

**abi.encodePacked()**

åŠŸèƒ½ï¼šæŠŠå‡ æ®µå­—ç¬¦æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œä¸åŠ åˆ†éš”ç¬¦

æ¯”è¾ƒå®‰å…¨çš„æ–¹æ³•ï¼Œæ‹¼æ¥å›ºå®šå­—èŠ‚

-   `uint256` å›ºå®š 32 å­—èŠ‚
    
-   `address` å›ºå®š 20 å­—èŠ‚
    
-   `bytes32` å›ºå®š 32 å­—èŠ‚
    

abi.encodePacked+åŠ¨æ€ç±»å‹ +hash/æˆæƒ/æ ¡éªŒ =ï¼ï¼ï¼é£é™©

## è‹±è¯­å•è¯

revert:å›æ»š
<!-- DAILY_CHECKIN_2026-01-12_END -->
<!-- Content_END -->
