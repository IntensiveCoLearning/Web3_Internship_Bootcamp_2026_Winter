---
timezone: UTC+8
---

# Axtrostom

**GitHub ID:** Axtrostom

**Telegram:** 

## Self-introduction

Web3 å®ä¹ è®¡åˆ’ 2025 å†¬å­£å®ä¹ ç”Ÿ

## Notes

<!-- Content_START -->
# 2026-01-22
<!-- DAILY_CHECKIN_2026-01-22_START -->
æ˜¨å¤©  
å¿˜äº†æ˜¨å¤©æ€ä¹ˆå›äº‹  
è¦ç”¨ Linux  
ç„¶åæŠŠå¥½ä¹…ä¹‹å‰è£…çš„åŒç³»ç»Ÿå¯åŠ¨äº†  
å¯åŠ¨è¿›å»ä¹‹åå‘ç°wifiä¹Ÿè¿æ¥ä¸ä¸Š  
è“ç‰™ä¹Ÿæ²¡æœ‰  
éº¦å…‹é£æ‰¬å£°å™¨éƒ½æ£€æµ‹ä¸åˆ°  
æ„Ÿè§‰åº”è¯¥æ˜¯é©±åŠ¨æ‰å®Œäº†  
æŠ˜è…¾äº†äºŒä¸‰ååˆ†é’Ÿï¼Œä¸æƒ³æŠ˜è…¾äº†  
æƒ³ç€ç›´æ¥é‡è£…å§  
ç„¶åå»è£… archlinux å»äº†  
æŠ˜è…¾åŠå¤©ï¼Œæƒ³ç€éƒ½è£…äº†ï¼Œå†æ¯é¥¬ä¼šç¾åŒ–åŒ…å§  
ç„¶ååˆæ¯é¥¬åŠå¤©  
ä¸è¿‡å¥½åœ¨æ€»ä¹‹æ˜¯è£…å¥½äº†

æƒ³èµ·æ¥äº†ï¼Œæ˜¯è¦å»åšé‚£ä¸ª speedrun æŒ‘æˆ˜  
éœ€è¦linuxç¯å¢ƒ  
æœ¬æ¥è¿˜æƒ³ç€æ˜¨å¤©åšå®Œæ¥ç€  
ç»“æœè¿™ç®—æ˜¯ç¯å¢ƒå°±é…äº†ä¸¤å¤©

æ˜å¤©å†åŠ æ²¹å§

è¯¥è¯´ä¸è¯´ï¼ŒArchlinuxæ•´å¥½å°±æ˜¯æ¯” ubuntu å¥½çœ‹å¤šäº†
<!-- DAILY_CHECKIN_2026-01-22_END -->

# 2026-01-21
<!-- DAILY_CHECKIN_2026-01-21_START -->

ä»Šå¤©çš„ä»»åŠ¡æ˜¯å®Œæˆ Challenge: ğŸŸ Tokenization

* * *
<!-- DAILY_CHECKIN_2026-01-21_END -->

# 2026-01-20
<!-- DAILY_CHECKIN_2026-01-20_START -->


è¿™å‘¨è¦å®Œæˆçš„ç›®æ ‡

è”é‚¦å­¦ä¹ å®éªŒä»£ç 

åŸºç¡€å’Œæ·±åº¦æŠ€æœ¯ä»»åŠ¡

solidityåŸºç¡€è¯­æ³•

ruståˆ·åˆ·åŠ›æ‰£

ä»Šå¤©ä¿åº•æŠŠ solidity åŸºç¡€è¯­æ³•çœ‹å®Œ

* * *

## Solidity

### Transient Storage ç¬æ€å­˜å‚¨

> å¿…é¡»ç¡®ä¿ EVM ç‰ˆæœ¬å’Œè™šæ‹Ÿæœºè®¾ç½®ä¸º Cancun (åæ˜†å‡çº§åçš„ç‰ˆæœ¬)

-   Storage (å­˜å‚¨): æ•°æ®å­˜å‚¨åœ¨åŒºå—é“¾ä¸Šï¼ˆæ°¸ä¹…ï¼Œå†™å…¥æè´µï¼Œå¦‚ç¡¬ç›˜ï¼‰
    
-   Memory (å†…å­˜): æ•°æ®åœ¨å‡½æ•°è°ƒç”¨ç»“æŸåæ¸…é™¤ï¼ˆä¸´æ—¶ï¼Œä¾¿å®œï¼Œå¦‚å†…å­˜æ¡ï¼‰
    
-   Transient Storage (ç¬æ€å­˜å‚¨): æ•°æ®åœ¨ã€æ•´ç¬”äº¤æ˜“ã€‘ç»“æŸåæ¸…é™¤ï¼ˆä»‹äºä¸¤è€…ä¹‹é—´ï¼Œè·¨å‡½æ•°ä¿ç•™ï¼Œäº¤æ˜“å®Œé”€æ¯ï¼‰
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// å¿…é¡»ç¡®ä¿ EVM ç‰ˆæœ¬å’Œè™šæ‹Ÿæœºè®¾ç½®ä¸º Cancun (åæ˜†å‡çº§åçš„ç‰ˆæœ¬)

interface ITest {
    function val() external view returns (uint256);
    function test() external;
}

// è¿™æ˜¯ä¸€ä¸ªè¾…åŠ©åˆçº¦ï¼Œç”¨æ¥æ¨¡æ‹Ÿâ€œå›è°ƒâ€åœºæ™¯
// å®ƒçš„ä½œç”¨æ˜¯ï¼šå½“æœ‰äººè°ƒå®ƒï¼Œå®ƒå°±åè¿‡æ¥å»è°ƒè°ƒç”¨è€…çš„ val() å‡½æ•°
contract Callback {
    uint256 public val;

    fallback() external {
        // åå‘è°ƒç”¨ msg.sender çš„ val() å‡½æ•°
        val = ITest(msg.sender).val();
    }

    function test(address target) external {
        ITest(target).test();
    }
}

// 1. ä¼ ç»Ÿ Storage æµ‹è¯•
contract TestStorage {
    uint256 public val;

    function test() public {
        val = 123; // å†™ Storage (æ˜‚è´µï¼Œæ¶ˆè€— 20000+ Gas)
        bytes memory b = "";
        // è§¦å‘å›è°ƒï¼ŒCallback ä¼šæ¥è¯»å– val
        msg.sender.call(b);
    }
}

// 2. ç¬æ€å­˜å‚¨æµ‹è¯• (ä¸»è§’)
contract TestTransientStorage {
    // å®šä¹‰ä¸€ä¸ªæ§½ä½å·
    bytes32 constant SLOT = 0;

    function test() public {
        // ä½¿ç”¨æ±‡ç¼–å†™å…¥ç¬æ€å­˜å‚¨
        // tstore(key, value)
        assembly {
            tstore(SLOT, 321)
        }
        bytes memory b = "";
        // è§¦å‘å›è°ƒ
        msg.sender.call(b);
    }

    // Callback åˆçº¦ä¼šå›è°ƒè¿™ä¸ªå‡½æ•°
    function val() public view returns (uint256 v) {
        // ä½¿ç”¨æ±‡ç¼–è¯»å–ç¬æ€å­˜å‚¨
        // tload(key)
        assembly {
            v := tload(SLOT)
        }
        // å…³é”®ç‚¹ï¼šè™½ç„¶è¿™æ˜¯å¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨ (val)ï¼Œ
        // ä½†å› ä¸ºè¿˜åœ¨åŒä¸€ç¬”äº¤æ˜“é‡Œï¼Œæ‰€ä»¥ tload èƒ½è¯»åˆ°åˆšæ‰ tstore å­˜è¿›å»çš„ 321ã€‚
    }
}

// 3. ä¼ ç»Ÿçš„é˜²é‡å…¥é” (ä½¿ç”¨ Storage)
contract ReentrancyGuard {
    bool private locked; // å ç”¨ Storage æ§½ä½

    modifier lock() {
        require(!locked);
        locked = true;  // å†™ Storage (è´µ)
        _;
        locked = false; // å†™ Storage (è´µ)
    }

    // è¿™ä¸€å¥—ä¸‹æ¥å¤§çº¦æ¶ˆè€— 35313 gas
    function test() public lock {
        // å¿½ç•¥è°ƒç”¨é”™è¯¯
        bytes memory b = "";
        msg.sender.call(b);
    }
}

// 4. ç¬æ€å­˜å‚¨é˜²é‡å…¥é” (ä½¿ç”¨ Transient Storage)
contract ReentrancyGuardTransient {
    bytes32 constant SLOT = 0;

    modifier lock() {
        assembly {
            // tload æ£€æŸ¥æ˜¯å¦ä¸Šé”
            if tload(SLOT) { revert(0, 0) }
            // tstore ä¸Šé” (éå¸¸ä¾¿å®œ)
            tstore(SLOT, 1)
        }
        _;
        assembly {
            // è§£é”
            tstore(SLOT, 0)
        }
    }

    // è¿™ä¸€å¥—ä¸‹æ¥åªè¦ 21887 gas (çœäº†çº¦ 1.4ä¸‡ Gas!)
    function test() external lock {
        // å¿½ç•¥è°ƒç”¨é”™è¯¯
        bytes memory b = "";
        msg.sender.call(b);
    }
}
```

```Solidity
interface ITest {
    function val() external view returns (uint256);
    function test() external;
}
```

ä¸Šé¢è¿™æ®µä»£ç æ˜¯å®šä¹‰æ¥å£çš„è¯­æ³•

åœ¨ Solidity ä¸­ï¼Œæ¥å£ç”¨æ¥å®šä¹‰**ä¸¤ä¸ªåˆçº¦ä¹‹é—´å¦‚ä½•å¯¹è¯**ã€‚

**å‘½åä¹ æƒ¯ï¼š** æ¥å£é€šå¸¸ä»¥å¤§å†™ `I` å¼€å¤´ï¼ˆå¦‚ `IERC20`, `ITest`ï¼‰ï¼Œæ–¹ä¾¿è¯†åˆ«ã€‚

### æ¥å£éœ€è¦è¢«å®ç°å—ï¼Ÿ

**ç†è®ºä¸Šï¼š** æ¥å£åªæ˜¯ä¸€ä¸ªç©ºå£³ï¼ˆè§„èŒƒï¼‰ï¼Œå¦‚æœæƒ³è®©ä»£ç çœŸæ­£è·‘èµ·æ¥ï¼Œå¿…é¡»æœ‰æŸä¸ªå…·ä½“çš„åˆçº¦å»**å®ç°**é‡Œé¢çš„é€»è¾‘ã€‚

**å†™æ³•ä¸Šï¼š** ä½ ä¸éœ€è¦æ˜¾å¼åœ°å†™ `contract A is ITest`ã€‚

åœ¨ Solidity ä¸­ï¼Œæ¥å£çš„ä½¿ç”¨éµå¾ª **â€œé¸­å­ç±»å‹ (Duck Typing)â€** çš„é€»è¾‘ï¼š

> â€œå¦‚æœå®ƒèµ°èµ·è·¯æ¥åƒé¸­å­ï¼ˆå‡½æ•°åä¸€æ ·ï¼‰ï¼Œå«èµ·æ¥åƒé¸­å­ï¼ˆå‚æ•°å’Œè¿”å›å€¼ä¸€æ ·ï¼‰ï¼Œé‚£å®ƒå°±æ˜¯é¸­å­ï¼ˆå®ç°äº†æ¥å£ï¼‰ã€‚â€

åªè¦ç›®æ ‡åˆçº¦é‡Œ**åŒ…å«äº†æ¥å£æ‰€è¦æ±‚çš„å‡½æ•°**ï¼ˆåå­—ã€å‚æ•°ã€è¿”å›å€¼éƒ½å¯¹å¾—ä¸Šï¼‰ï¼Œæ¥å£å°±å¯ä»¥è°ƒç”¨å®ƒï¼Œ**å®Œå…¨ä¸éœ€è¦**ç›®æ ‡åˆçº¦æ˜¾å¼åœ°å£°æ˜ `is ITest`ã€‚

è°ƒç”¨æ¥å£ï¼Œæˆ–è€…è¯´è°ƒç”¨åˆçº¦çš„è¯­æ³•å¦‚ä¸‹

```Solidity
ITest(target).test();
```

å…¶ä¸­

-   `target` **(åœ°å€):** è¿™æ˜¯ä¸€ä¸ª `address` ç±»å‹çš„å˜é‡ã€‚ å®ƒä»£è¡¨äº†ç›®æ ‡åˆçº¦åœ¨åŒºå—é“¾ä¸Šçš„â€œå®¶åº­ä½å€â€ï¼ˆä¾‹å¦‚ `0x5B38Da6a701c568545dCfcB03FcB875f56beddC4`ï¼‰ã€‚
    
-   _é—®é¢˜ï¼š_ å…‰æœ‰ä¸€ä¸ªåœ°å€ï¼Œç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“è¿™ä¸ªåœ°å€é‡Œä½äº†è°ï¼Œä¹Ÿä¸çŸ¥é“å®ƒæœ‰ä»€ä¹ˆåŠŸèƒ½ã€‚
    
-   `ITest(...)` **(åŒ…è£…/è½¬æ¢):** è¿™æ­¥å« **â€œç±»å‹è½¬æ¢â€ (Type Casting)**ã€‚ å®ƒçš„æ„æ€æ˜¯ï¼š**â€œç¼–è¯‘å™¨å¬ä»¤ï¼æŠŠ** `target` **è¿™ä¸ªåœ°å€ï¼Œå½“æˆä¸€ä¸ª** `ITest` **ç±»å‹çš„åˆçº¦æ¥çœ‹å¾…ã€‚â€**
    
-   ä¸€æ—¦ä½ å¥—ä¸Šäº† `ITest` çš„å£³ï¼Œç¼–è¯‘å™¨å°±çŸ¥é“ï¼šâ€œå“¦ï¼ŒåŸæ¥è¿™ä¸ªåœ°å€é‡Œæœ‰ä¸€ä¸ªå« `test()` çš„å‡½æ•°å•Šã€‚â€
    
-   `.test()` **(è°ƒç”¨):** è¿™æ‰æ˜¯çœŸæ­£çš„**æ‰§è¡Œ**ã€‚ å‘é‚£ä¸ªåœ°å€å‘èµ·ä¸€ç¬”äº¤æ˜“ï¼ˆæˆ–è°ƒç”¨ï¼‰ï¼Œæ‰§è¡Œå…¶ä¸­çš„ `test` å‡½æ•°ã€‚
    

```Solidity
fallback() external {
    val = ITest(msg.sender).val();
}
```

è¿™æ˜¯ Solidity ä¸­çš„ **å›é€€å‡½æ•° (Fallback Function)**ã€‚

`fallback()` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œå®ƒæ²¡æœ‰åå­—ï¼Œä¹Ÿæ²¡æœ‰å‚æ•°ã€‚å®ƒä¼šåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹è¢«**è‡ªåŠ¨è§¦å‘**ï¼š

1.  **åˆ«äººçè°ƒä½ çš„å‡½æ•°æ—¶ (Function not found):** å¦‚æœæœ‰å…¶ä»–åˆçº¦ï¼ˆæˆ–è€…äººï¼‰è°ƒç”¨äº†ä½ çš„åˆçº¦ï¼Œä½†æ˜¯**å‡½æ•°åå­—å†™é”™äº†**ï¼Œæˆ–è€…**æ ¹æœ¬ä¸å­˜åœ¨**è¿™ä¸ªå‡½æ•°ï¼ŒEVM ä¸ä¼šç›´æ¥æŠ¥é”™ï¼Œè€Œæ˜¯ä¼šæŠŠè¿™ä¸ªè¯·æ±‚è½¬ç»™ `fallback()` å¤„ç†ã€‚
    
2.  **åˆ«äººç»™ä½ å‘ç©ºæ•°æ®æ—¶:** å¦‚æœæœ‰äººå‘èµ·äº†ä¸€ç¬”äº¤æ˜“ï¼Œé€šè¿‡ `call` æˆ–è€…æ˜¯ç›´æ¥å‘æ•°æ®ï¼Œä½†æ²¡æœ‰æŒ‡å®šä»»ä½•å…·ä½“çš„å‡½æ•°ç­¾åï¼ˆå°±åƒä½ ä»£ç é‡Œçš„ `msg.sender.call(b)`ï¼‰ï¼Œä¹Ÿä¼šè§¦å‘å®ƒã€‚
    

åœ¨ Solidity ä¸­ï¼Œ`msg.sender` æ˜¯ä¸€ä¸ª**åŠ¨æ€å˜é‡**ï¼Œå®ƒæ°¸è¿œä»£è¡¨**â€œä¸Šä¸€æ‰‹è°ƒç”¨æˆ‘çš„äººï¼ˆæˆ–åˆçº¦ï¼‰â€**ã€‚

```Solidity
// 1. ä¼ ç»Ÿ Storage æµ‹è¯•
contract TestStorage {
    uint256 public val;

    function test() public {
        val = 123; // å†™ Storage (æ˜‚è´µï¼Œæ¶ˆè€— 20000+ Gas)
        bytes memory b = "";
        // è§¦å‘å›è°ƒï¼ŒCallback ä¼šæ¥è¯»å– val
        msg.sender.call(b);
    }
}
```

å¦‚æœè·¨åˆçº¦ä¼ é€’ memory ç±»å‹çš„å‚æ•°ï¼Œéœ€è¦é¢å¤–å¼€è¾Ÿä¸€ç‰‡å†…å­˜ç©ºé—´è¿›è¡Œå€¼æ‹·è´

Â Â **è·¨åˆçº¦ä¼ é€’ Memory å˜é‡çš„æœ¬è´¨ï¼š**

1.  **ä¸æ˜¯å¼•ç”¨ä¼ é€’**ï¼šæŒ‡é’ˆå‘ä¸è¿‡å»ã€‚
    
2.  **æ˜¯å€¼æ‹·è´**ï¼šæ•°æ®ä¼šè¢«â€œåºåˆ—åŒ–â€ä¼ è¾“ã€‚
    
3.  **åŒé‡æˆæœ¬**ï¼š
    
    1.  å‘é€æ–¹ï¼šéœ€è¦ Gas è¿›è¡Œ ABI ç¼–ç ã€‚
        
    2.  æ¥æ”¶æ–¹ï¼šå¦‚æœå£°æ˜ä¸º `memory`ï¼Œéœ€è¦ **å¼€è¾Ÿæ–°å†…å­˜ + å†æ¬¡æ‹·è´**ã€‚
        
4.  **ä¼˜åŒ–å»ºè®®**ï¼šæ¥æ”¶æ–¹çš„å‡½æ•°å‚æ•°å°½é‡å†™æˆ `calldata`ï¼Œé¿å…æ¥æ”¶æ—¶çš„â€œäºŒæ¬¡æ‹·è´â€å’Œå†…å­˜å¼€é”€ã€‚
    

å†…å­˜è®¡è´¹çš„æœ€å°å•ä½æ˜¯ **32 å­—èŠ‚ (32 Bytes)**ã€‚

```Solidity
// 2. ç¬æ€å­˜å‚¨æµ‹è¯• (ä¸»è§’)
contract TestTransientStorage {
    // å®šä¹‰ä¸€ä¸ªæ§½ä½å·
    bytes32 constant SLOT = 0;

    function test() public {
        // ä½¿ç”¨æ±‡ç¼–å†™å…¥ç¬æ€å­˜å‚¨
        // tstore(key, value)
        assembly {
            tstore(SLOT, 321)
        }
        bytes memory b = "";
        // è§¦å‘å›è°ƒ
        msg.sender.call(b);
    }

    // Callback åˆçº¦ä¼šå›è°ƒè¿™ä¸ªå‡½æ•°
    function val() public view returns (uint256 v) {
        // ä½¿ç”¨æ±‡ç¼–è¯»å–ç¬æ€å­˜å‚¨
        // tload(key)
        assembly {
            v := tload(SLOT)
        }
        // å…³é”®ç‚¹ï¼šè™½ç„¶è¿™æ˜¯å¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨ (val)ï¼Œ
        // ä½†å› ä¸ºè¿˜åœ¨åŒä¸€ç¬”äº¤æ˜“é‡Œï¼Œæ‰€ä»¥ tload èƒ½è¯»åˆ°åˆšæ‰ tstore å­˜è¿›å»çš„ 321ã€‚
    }
}
```

ç„¶åè¿™ä¸ªä»£ç 

æˆ‘è‰ï¼Œæœ‰ç‚¹çœ‹ä¸æ‡‚äº†

ä¸€ä¸‹å¡ä¸€å †æ²¡è§è¿‡çš„ä¸œè¥¿

**1\.** `SLOT` **å¿…é¡»æ˜¯ state å˜é‡å—ï¼Ÿå†™æˆ** `tstore(0, 321)` **ä¸€æ ·å—ï¼Ÿ**

**ç­”æ¡ˆï¼šä¸éœ€è¦æ˜¯ state å˜é‡ã€‚å†™æˆ** `0` **æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚**

åœ¨ä½ çš„ä»£ç é‡Œï¼Œ`SLOT` å…¶å®å®šä¹‰çš„æ˜¯ `constant`ï¼ˆå¸¸é‡ï¼‰ï¼š

Solidity

```Plain
bytes32 constant SLOT = 0;
```

è¿™æ„å‘³ç€åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šæŠŠä»£ç é‡Œæ‰€æœ‰çš„ `SLOT` ç›´æ¥æ›¿æ¢æˆæ•°å­— `0`ã€‚

**ä¸ºä»€ä¹ˆå¤§å®¶å–œæ¬¢ç”¨** `SLOT` **è€Œä¸æ˜¯ç›´æ¥å†™** `0`**ï¼Ÿ** è¿™çº¯ç²¹æ˜¯ä¸ºäº†**ä»£ç å¯è¯»æ€§**å’Œ**é˜²æ­¢å†²çª**ã€‚

-   å¦‚æœä½ ç›´æ¥å†™ `tstore(0, 321)`ï¼Œè¿‡ä¸¤ä¸ªæœˆä½ å†çœ‹ä»£ç ï¼šâ€œè¿™ä¸ª 0 æ˜¯å•¥æ„æ€ï¼Ÿæ˜¯åˆå§‹å€¼ï¼Ÿè¿˜æ˜¯ç¬¬ 0 ä¸ªä½ç½®ï¼Ÿâ€
    
-   å¦‚æœä½ å†™ `tstore(REENTRANCY_GUARD_SLOT, 321)`ï¼Œä½ å°±çŸ¥é“ï¼šâ€œå“¦ï¼Œè¿™ä¸ªä½ç½®æ˜¯ç”¨æ¥å­˜æ”¾é˜²é‡å…¥é”çš„ã€‚â€
    

**åº•å±‚çš„æœ¬è´¨ï¼š**`tstore` å‡½æ•°åªåœ¨ä¹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª **32å­—èŠ‚çš„æ•°å­—ï¼ˆä½ç½®ç¼–å·ï¼‰**ã€‚å®ƒä¸å…³å¿ƒè¿™ä¸ªæ•°å­—æ˜¯æ¥è‡ªå¸¸é‡ã€å˜é‡ï¼Œè¿˜æ˜¯ä½ æ‰‹å†™çš„ä¸€ä¸ª `0`ã€‚

* * *

**2\.** `assembly` **æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¿…è¦çš„å—ï¼Ÿ**

`assembly` **æ˜¯ Solidity çš„â€œåé—¨â€ï¼Œæˆ–è€…è¯´æ˜¯â€œæ‰‹åŠ¨æŒ¡æ¨¡å¼â€ã€‚**

-   **æ˜¯ä»€ä¹ˆï¼š** å®ƒå…è®¸ä½ åœ¨ Solidity ä»£ç ä¸­ç›´æ¥å†™ **Yul è¯­è¨€**ï¼ˆä¸€ç§è´´è¿‘æœºå™¨ç çš„ä½çº§è¯­è¨€ï¼‰ã€‚ä½ å¯ä»¥ç›´æ¥æŒ‡æŒ¥ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼ˆEVMï¼‰å»æ‰§è¡Œæœ€åº•å±‚çš„æŒ‡ä»¤ï¼ˆOpcodeï¼‰ã€‚
    
-   **æ˜¯å¿…è¦çš„å—ï¼Ÿ** **åœ¨è¿™ä¸ªç‰¹å®šçš„ä¾‹å­ï¼ˆç¬æ€å­˜å‚¨ï¼‰ä¸­ï¼Œæ˜¯çš„ï¼Œå®ƒæ˜¯ç»å¯¹å¿…è¦çš„ã€‚**
    

**ä¸ºä»€ä¹ˆï¼Ÿ** å› ä¸º Solidity è¯­è¨€çš„æ›´æ–°é€Ÿåº¦å¾€å¾€æ¯”ä»¥å¤ªåŠç½‘ç»œï¼ˆEVMï¼‰çš„æ›´æ–°é€Ÿåº¦è¦æ…¢åŠæ‹ï¼Œæˆ–è€…ä¸ºäº†å®‰å…¨èµ·è§æ›´åŠ ä¿å®ˆã€‚

-   **EVM è¯´ï¼š** â€œå…„å¼Ÿä»¬ï¼Œåæ˜†å‡çº§ï¼ˆCancunï¼‰å®Œæˆäº†ï¼æˆ‘ç°åœ¨æ”¯æŒç¬æ€å­˜å‚¨äº†ï¼Œæˆ‘æœ‰ä¸¤ä¸ªæ–°æŒ‡ä»¤ï¼š`TSTORE` å’Œ `TLOAD`ï¼â€
    
-   **Solidity ç¼–è¯‘å™¨è¯´ï¼š** â€œå‘ƒï¼Œæˆ‘è¿˜æ²¡æœ‰ç»™è¿™ä¸¤ä¸ªæ–°æŒ‡ä»¤è®¾è®¡ä¸“é—¨çš„è¯­æ³•ï¼ˆæ¯”å¦‚ `transient uint x;` è¿™ç§å†™æ³•è¿˜æ²¡å®Œå…¨å®šå‹æˆ–æ™®åŠï¼‰ã€‚â€
    
-   **å¼€å‘è€…è¯´ï¼š** â€œä½†æˆ‘ç°åœ¨å°±æƒ³ç”¨ï¼æ€ä¹ˆåŠï¼Ÿâ€
    
-   **è§£å†³åŠæ³•ï¼š** ä½¿ç”¨ `assembly`ã€‚é€šè¿‡æ±‡ç¼–ä»£ç ï¼Œç›´æ¥è°ƒç”¨åº•å±‚çš„ `tstore` å’Œ `tload` æŒ‡ä»¤ï¼Œç»•è¿‡ Solidity é«˜çº§è¯­æ³•çš„é™åˆ¶ã€‚
    

**æ€»ç»“ï¼š** å½“ä½ æƒ³ç”¨æœ€æ–°çš„ EVM ç‰¹æ€§ï¼Œæˆ–è€…æƒ³æè‡´ä¼˜åŒ– Gasï¼ˆçœå» Solidity è‡ªåŠ¨ç”Ÿæˆçš„å®‰å…¨æ£€æŸ¥ä»£ç ï¼‰æ—¶ï¼Œ`assembly` å°±æ˜¯å¿…è¦çš„ã€‚

* * *

**3\.** `tstore(key, value)` **æ˜¯ä»€ä¹ˆï¼Ÿ**

å®ƒæ˜¯ **Transient Storeï¼ˆç¬æ€å­˜å‚¨å†™å…¥ï¼‰** çš„ç¼©å†™ã€‚

ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸º EVM åº•å±‚çš„ä¸€ä¸ªæ“ä½œæŒ‡ä»¤ã€‚

-   **Key (æ§½ä½):** ä½ è¦æŠŠæ•°æ®å­˜åœ¨å“ªä¸ªæŸœå­é‡Œï¼Ÿï¼ˆæ¯”å¦‚ç¬¬ 0 å·æŸœå­ï¼‰ã€‚
    
-   **Value (å€¼):** ä½ è¦å­˜ä»€ä¹ˆä¸œè¥¿ï¼Ÿï¼ˆæ¯”å¦‚æ•°å­— 321ï¼‰ã€‚
    

å®ƒç¡®å®æ˜¯åœ¨åº•å±‚åˆ›å»ºäº†ä¸€ä¸ª **Key-Value é”®å€¼å¯¹**ã€‚

* * *

**4.** **ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ Memory Mappingï¼Ÿ**

æ—¢ç„¶æ˜¯â€œä¸´æ—¶å­˜å‚¨â€ï¼ŒMemory ä¸ä¹Ÿæ˜¯ä¸´æ—¶çš„å—ï¼Ÿä¸ºä»€ä¹ˆè¦æä¸ªæ–°ä¸œè¥¿ï¼Ÿè¿™é‡Œæœ‰ä¸‰ä¸ªå·¨å¤§çš„åŒºåˆ«ï¼š

**ç†ç”±ä¸€ï¼šSolidity æ ¹æœ¬ä¸æ”¯æŒ Memory Mapping**

åœ¨ Solidity ä¸­ï¼Œ`mapping` ç±»å‹**åªèƒ½**å­˜åœ¨äº `storage` ä¸­ã€‚ ä½ **ä¸èƒ½**å†™ `mapping(uint => uint) memory myMap;`ã€‚è¿™æ˜¯è¯­è¨€å±‚é¢çš„é™åˆ¶ã€‚å¦‚æœä½ æƒ³åœ¨ Memory é‡Œå®ç°ç±»ä¼¼ Mapping çš„åŠŸèƒ½ï¼Œä½ éœ€è¦è‡ªå·±å†™æå…¶å¤æ‚çš„å“ˆå¸Œç®—æ³•ï¼Œä¸ä»…ä»£ç éš¾å†™ï¼Œè€Œä¸” Gas è´¹å·¨è´µã€‚

**ç†ç”±äºŒï¼šç”Ÿå‘½å‘¨æœŸä¸åŒï¼ˆæœ€å…³é”®ç‚¹ï¼ï¼‰**

è¿™æ˜¯æœ€å®¹æ˜“æ··æ·†çš„åœ°æ–¹ï¼Œè¯·ä»”ç»†çœ‹ï¼š

-   **Memory (å†…å­˜) = å‡½æ•°çº§ç”Ÿå‘½å‘¨æœŸ**
    
    -   ä½ åœ¨ `test()` å‡½æ•°é‡Œç”³è¯·äº†ä¸€å— Memoryã€‚
        
    -   å½“ä½ è°ƒç”¨ `msg.sender.call(b)` ç¦»å¼€å½“å‰å‡½æ•°ï¼Œå»æ‰§è¡Œåˆ«äººçš„ä»£ç ï¼Œæˆ–è€…å“ªæ€•æ˜¯åˆ«äººå›è°ƒä½ çš„ `val()` å‡½æ•°æ—¶ã€‚
        
    -   **ä¹‹å‰çš„ Memory å¯¹** `val()` **æ˜¯ä¸å¯è§çš„ï¼** `val()` å¤„äºä¸€ä¸ªæ–°çš„â€œæ‰§è¡Œæ ˆå¸§ (Stack Frame)â€ä¸­ï¼Œå®ƒæœ‰è‡ªå·±ç‹¬ç«‹çš„ä¸€å— Memoryã€‚
        
    -   _æ¯”å–»ï¼šMemory æ˜¯æ¯ä¸ªäººæ‰‹é‡Œçš„è‰ç¨¿çº¸ã€‚_`test` _å†™åœ¨è‡ªå·±çº¸ä¸Šï¼Œ_`val` _æ ¹æœ¬çœ‹ä¸åˆ°_ `test` _çš„çº¸ã€‚_
        
-   **Transient Storage (ç¬æ€å­˜å‚¨) = äº¤æ˜“çº§ç”Ÿå‘½å‘¨æœŸ**
    
    -   å®ƒæ˜¯æŒ‚åœ¨å½“å‰åˆçº¦å®ä¾‹ä¸Šçš„ä¸€ä¸ª**å…¨å±€æš‚å­˜åŒº**ã€‚
        
    -   åªè¦è¿™ç¬”äº¤æ˜“è¿˜æ²¡ç»“æŸï¼Œæ— è®ºå‡½æ•°æ€ä¹ˆè·³æ¥è·³å»ï¼ˆ`test` -> `Callback` -> `val`ï¼‰ï¼Œåªè¦æ˜¯åœ¨åŒä¸€ä¸ªåˆçº¦åœ°å€ä¸‹ï¼Œå¤§å®¶éƒ½èƒ½çœ‹åˆ°è¿™ä¸ªåŒºåŸŸã€‚
        
    -   _æ¯”å–»ï¼šTransient Storage æ˜¯è´´åœ¨å¢™ä¸Šçš„ç™½æ¿ã€‚_`test` _å†™ä¸Šå»ï¼Œ_`val` _è¿›å±‹ä¹Ÿèƒ½çœ‹åˆ°ã€‚äº¤æ˜“ç»“æŸï¼Œç™½æ¿æ“¦é™¤ã€‚_
        

**ç†ç”±ä¸‰ï¼šGas æˆæœ¬**

å°±ç®—ä½ èƒ½ç”¨ Memory æ¨¡æ‹Ÿå‡ºè·¨å‡½æ•°å…±äº«ï¼ˆé€šè¿‡ç–¯ç‹‚ä¼ å‚ï¼‰ï¼Œå½“æ•°æ®é‡å¤§æˆ–è€…è°ƒç”¨å±‚çº§æ·±æ—¶ï¼Œä¸æ–­åœ° Copy Memory ä¼šéå¸¸è´µã€‚è€Œ `tstore` å°±åƒè®¿é—®ä¸€ä¸ªå…¨å±€å˜é‡ä¸€æ ·ä¾¿å®œã€‚

**tstoreå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶çš„ state ç±»å‹çš„ Mapping**

ç„¶åè¿™ä¸ªå‡½æ•°

```Solidity
    function val() public view returns (uint256 v) {
        // ä½¿ç”¨æ±‡ç¼–è¯»å–ç¬æ€å­˜å‚¨
        // tload(key)
        assembly {
            v := tload(SLOT)
        }
```

è¯»å– ç›´æ¥ä½¿ç”¨ tloade(key) å°±å¯ä»¥äº†

tloade tstore å¿…é¡»è¦åœ¨ `assembly { ... }` é‡Œé¢ä½¿ç”¨

ç›®å‰ Solidity (v0.8.26) è¿˜æ²¡æœ‰æŠŠ `tload` åšæˆä¸€ä¸ªåƒ `address(this).balance` é‚£æ ·çš„å†…ç½®å‡½æ•°ã€‚EVM è®¤è¯†å®ƒï¼Œä½† Solidity ç¼–è¯‘å™¨ä¸è®¤è¯†å®ƒã€‚æ‰€ä»¥ä½ å¿…é¡»ç”¨ `assembly` å‘Šè¯‰ç¼–è¯‘å™¨ï¼šâ€œåˆ«ç®¡è¯­æ³•äº†ï¼Œç›´æ¥æŠŠè¿™è¡Œæœºå™¨ç å¡è¿›å»â€ã€‚

ç„¶ååœ¨ assembly æ‹¬å·ä¸­è¦ä½¿ç”¨ Yul è¯­è¨€ï¼Œ

-   **åŒºåˆ«ï¼š** åœ¨ `assembly { ... }` åŒºå—é‡Œï¼ˆä¹Ÿå°±æ˜¯ Yul è¯­è¨€ä¸­ï¼‰ï¼Œ**èµ‹å€¼å¿…é¡»ç”¨** `:=`ã€‚
    
-   **ä½œç”¨ï¼š** æŠŠå³è¾¹è¿ç®—çš„ç»“æœï¼Œå¡è¿›å·¦è¾¹çš„å˜é‡é‡Œã€‚
    

çœ‹ä¸€ä¸‹å‡½æ•°å®šä¹‰ `function val() ... returns (uint256 v)`ã€‚

è¿™ä¸ª `v` æ˜¯ Solidity å®šä¹‰çš„**è¿”å›å€¼å˜é‡**ã€‚

Yul æ±‡ç¼–ä»£ç å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ Solidity å®šä¹‰çš„å±€éƒ¨å˜é‡ã€‚

å½“è¿™è¡Œä»£ç æ‰§è¡Œå®Œï¼Œ`v` å°±å˜æˆäº† `321`ã€‚å‡½æ•°ç»“æŸæ—¶ï¼Œå°±ä¼šæŠŠ `v` è¿”å›ç»™è°ƒç”¨è€…ã€‚

æ‰€ä»¥å°±ä¸éœ€è¦ å®šä¹‰ç„¶åæ˜¾ç¤ºçš„å†™ return äº†

**é˜²é‡å…¥é” (Reentrancy Guard)** æ˜¯æ™ºèƒ½åˆçº¦å®‰å…¨ä¸­**æœ€é‡è¦ã€æœ€åŸºç¡€**çš„é˜²å¾¡æœºåˆ¶ä¹‹ä¸€ã€‚

ç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯ç»™åˆçº¦çš„å‡½æ•°è£…ä¸€æŠŠ**â€œé—¨é”â€ï¼šâ€œåœ¨æˆ‘è¿˜æ²¡åŠå®Œè¿™æ¬¡ä¸šåŠ¡ä¹‹å‰ï¼Œä»»ä½•äººéƒ½åˆ«æƒ³å†è¿›æ¥ï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±ã€‚â€**

ç®€å•æ¥è¯´ï¼Œé˜²é‡å…¥é”å°±æ˜¯ç”¨äºä¿è¯åˆçº¦åŸå­æ€§çš„å·¥å…·

```Solidity
// 3. ä¼ ç»Ÿçš„é˜²é‡å…¥é” (ä½¿ç”¨ Storage)
contract ReentrancyGuard {
    bool private locked; // å ç”¨ Storage æ§½ä½

    modifier lock() {
        require(!locked);
        locked = true;  // å†™ Storage (è´µ)
        _;
        locked = false; // å†™ Storage (è´µ)
    }

    // è¿™ä¸€å¥—ä¸‹æ¥å¤§çº¦æ¶ˆè€— 35313 gas
    function test() public lock {
        // å¿½ç•¥è°ƒç”¨é”™è¯¯
        bytes memory b = "";
        msg.sender.call(b);
    }
}
```

`_;` æ˜¯ä»€ä¹ˆï¼Ÿ

è¿™æ˜¯ Solidity ä¸­ `modifier` **(ä¿®é¥°å™¨)** ç‹¬æœ‰çš„è¯­æ³•ç¬¦å·ï¼Œä½ å¯ä»¥æŠŠå®ƒå«ä½œ **â€œå ä½ç¬¦â€** æˆ–è€… **â€œä¸‹åˆ’çº¿â€**ã€‚

å®ƒçš„å«ä¹‰æ˜¯ï¼š**â€œè¯·æŠŠè¢«ä¿®é¥°å‡½æ•°çš„ä»£ç ï¼Œç²˜è´´åˆ°è¿™é‡Œæ¥æ‰§è¡Œã€‚â€**

åœ¨ä½ çš„ä»£ç ä¸­ï¼Œ`_;` èµ·åˆ°äº† **â€œä¸‰æ˜æ²»å¤¹å¿ƒâ€** çš„ä½œç”¨ï¼Œå®ƒå†³å®šäº†åŸæœ¬çš„ `test()` å‡½æ•°ä»£ç åœ¨ä»€ä¹ˆæ—¶å€™è¿è¡Œã€‚

`revert(0, 0)` æ˜¯ Solidity å†…è”æ±‡ç¼– (Yul) ä¸­**æœ€èŠ‚çœ Gas çš„æŠ¥é”™æ–¹å¼**ã€‚

å®ƒçš„æ„æ€æ˜¯ï¼š**â€œç«‹å³åœæ­¢äº¤æ˜“ï¼Œå›æ»šæ‰€æœ‰æ“ä½œï¼Œå¹¶ä¸”ä¸ç»™ä»»ä½•ç†ç”±ï¼ˆä¸è¿”å›é”™è¯¯ä¿¡æ¯ï¼‰ã€‚â€**

æˆ‘ä»¬æ¥åƒæ‹†è§£ç‚¸å¼¹ä¸€æ ·æ‹†è§£è¿™å¥æŒ‡ä»¤ï¼š

**1.** **è¯­æ³•æ‹†è§£ï¼š**`revert(p, s)`

åœ¨æ±‡ç¼–ï¼ˆAssemblyï¼‰ä¸­ï¼Œ`revert` æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š

-   **ç¬¬ä¸€ä¸ªå‚æ•°** `p` **(offset):** é”™è¯¯ä¿¡æ¯åœ¨å†…å­˜ä¸­çš„**èµ·å§‹ä½ç½®**ã€‚
    
-   **ç¬¬äºŒä¸ªå‚æ•°** `s` **(size):** é”™è¯¯ä¿¡æ¯çš„**æ•°æ®é•¿åº¦**ã€‚
    

**2\.** `(0, 0)` **ä»£è¡¨ä»€ä¹ˆï¼Ÿ**

-   **èµ·å§‹ä½ç½® 0:** ä»å†…å­˜çš„ç¬¬ 0 ä¸ªå­—èŠ‚å¼€å§‹è¯»ã€‚
    
-   **é•¿åº¦ 0:** è¯»å– 0 ä¸ªå­—èŠ‚ã€‚
    

> å†æ— è¯å¯è¯´ï¼Œè¯·é€Ÿé€ŸåŠ¨æ‰‹

### Function

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Function {
    // ã€å¤šè¿”å›å€¼ã€‘
    // å‡½æ•°å¯ä»¥ä¸€æ¬¡æ€§è¿”å›å¤šä¸ªå€¼ï¼ˆä¸éœ€è¦åƒ Java é‚£æ ·å°è£…æˆå¯¹è±¡ï¼‰
    function returnMany() public pure returns (uint256, bool, uint256) {
        return (1, true, 2);
    }

    // ã€å‘½åè¿”å›å€¼ã€‘
    // è¿”å›å€¼å¯ä»¥åœ¨ returns é‡Œç›´æ¥èµ·åå­— (x, b, y)
    function named() public pure returns (uint256 x, bool b, uint256 y) {
        return (1, true, 2);
    }

    // ã€éšå¼è¿”å›ã€‘
    // æ—¢ç„¶è¿”å›å€¼å·²ç»å‘½åäº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç»™è¿™äº›åå­—èµ‹å€¼ã€‚
    // åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥çœç•¥ 'return' è¯­å¥ï¼ŒSolidity ä¼šè‡ªåŠ¨è¿”å›è¿™äº›å˜é‡çš„å½“å‰å€¼ã€‚
    function assigned() public pure returns (uint256 x, bool b, uint256 y) {
        x = 1;
        b = true;
        y = 2;
        // è¿™é‡Œçš„ return è¢«çœç•¥äº†ï¼Œä½†æ•ˆæœå’Œä¸Šé¢ä¸€æ ·
    }

    // ã€è§£æ„èµ‹å€¼ã€‘
    // å½“è°ƒç”¨å¦ä¸€ä¸ªè¿”å›å¤šå€¼çš„å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å…ƒç»„ (tuple) æ¥æ¥ä½è¿™äº›å€¼ã€‚
    function destructuringAssignments()
        public
        pure
        returns (uint256, bool, uint256, uint256, uint256)
    {
        // è°ƒç”¨ returnManyï¼ŒæŠŠå®ƒè¿”å›çš„ä¸‰ä¸ªå€¼åˆ†åˆ«èµ‹ç»™ i, b, j
        (uint256 i, bool b, uint256 j) = returnMany();

        // ã€å€¼å¯ä»¥è¢«çœç•¥ã€‘
        // å¦‚æœä½ åªæƒ³è¦ç¬¬ 1 å’Œç¬¬ 3 ä¸ªå€¼ï¼Œä¸æƒ³è¦ç¬¬ 2 ä¸ªï¼Œå¯ä»¥ç©ºç€ä¸å†™
        // (4, 5, 6) -> 4 ç»™ x, 5 è¢«ä¸¢å¼ƒ, 6 ç»™ y
        (uint256 x, , uint256 y) = (4, 5, 6);

        return (i, b, j, x, y);
    }

    // ã€ç±»å‹é™åˆ¶ã€‘
    // ä¸èƒ½ä½¿ç”¨ mapping (æ˜ å°„) ä½œä¸ºè¾“å…¥å‚æ•°æˆ–è¾“å‡ºç»“æœ
    
    // å¯ä»¥ä½¿ç”¨ array (æ•°ç»„) ä½œä¸ºè¾“å…¥
    function arrayInput(uint256[] memory _arr) public {}

    // å¯ä»¥ä½¿ç”¨ array (æ•°ç»„) ä½œä¸ºè¾“å‡º
    uint256[] public arr;
    function arrayOutput() public view returns (uint256[] memory) {
        return arr;
    }
}

// è°ƒç”¨å‡½æ•°æ—¶çš„ã€é”®å€¼å¯¹ä¼ å‚ã€‘
contract XYZ {
    function someFuncWithManyInputs(
        uint256 x,
        uint256 y,
        uint256 z,
        address a,
        bool b,
        string memory c
    ) public pure returns (uint256) {}

    // æ–¹å¼ 1ï¼šå¸¸è§„è°ƒç”¨
    // å¿…é¡»ä¸¥æ ¼æŒ‰ç…§å®šä¹‰çš„é¡ºåºä¼ å‚
    function callFunc() external pure returns (uint256) {
        return someFuncWithManyInputs(1, 2, 3, address(0), true, "c");
    }

    // æ–¹å¼ 2ï¼šé”®å€¼å¯¹è°ƒç”¨ (Key-Value Inputs)
    // åªè¦åå­—å¯¹å¾—ä¸Šï¼Œé¡ºåºä¹±äº†ä¹Ÿæ²¡å…³ç³»ï¼Œå¯è¯»æ€§æ›´å¼º
    function callFuncWithKeyValue() external pure returns (uint256) {
        return someFuncWithManyInputs({
            a: address(0),
            b: true,
            c: "c",
            x: 1,
            y: 2,
            z: 3
        });
    }
}
```

æ„Ÿè§‰æ²¡ä»€ä¹ˆå¥½è¯´çš„

### View and Pure Functions

```JavaScript
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract ViewAndPure {
    uint256 public x = 1; // è¿™æ˜¯ä¸€ä¸ªçŠ¶æ€å˜é‡ï¼ˆå†™åœ¨åŒºå—é“¾ä¸Šçš„ï¼‰

    // ã€View å‡½æ•°ã€‘
    // æ‰¿è¯ºä¸ä¿®æ”¹çŠ¶æ€ (Promise not to modify the state)
    // å®ƒå¯ä»¥â€œçœ‹â€åˆ° xï¼Œä½†ä¸èƒ½â€œæ”¹â€ x
    function addToX(uint256 y) public view returns (uint256) {
        return x + y; // è¯»å–äº†çŠ¶æ€å˜é‡ x
    }

    // ã€Pure å‡½æ•°ã€‘
    // æ‰¿è¯ºä¸ä¿®æ”¹ä¹Ÿä¸è¯»å–çŠ¶æ€ (Promise not to modify or read from the state)
    // å®ƒå®Œå…¨ä¸ç†ä¼š xï¼Œåªå…³å¿ƒä¼ å…¥çš„å‚æ•° i å’Œ j
    function add(uint256 i, uint256 j) public pure returns (uint256) {
        return i + j; // æ—¢æ²¡è¯» xï¼Œä¹Ÿæ²¡æ”¹ x
    }
}
```

-   Getter å‡½æ•°ï¼ˆè¯»å–å‡½æ•°ï¼‰å¯ä»¥è¢«å£°æ˜ä¸º view æˆ– pureã€‚
    
-   View å‡½æ•°å£°æ˜ï¼šæ‰¿è¯ºä¸ä¼šã€ä¿®æ”¹ã€‘ä»»ä½•çŠ¶æ€ã€‚
    
-   Pure å‡½æ•°å£°æ˜ï¼šæ‰¿è¯ºæ—¢ä¸ä¼šã€ä¿®æ”¹ã€‘ä¹Ÿä¸ä¼šã€è¯»å–ã€‘ä»»ä½•çŠ¶æ€å˜é‡ã€‚
    

### Error

ä¸€ä¸ªé”™è¯¯å°†æ’¤é”€äº¤æ˜“æœŸé—´å¯¹çŠ¶æ€æ‰€åšçš„æ‰€æœ‰æ›´æ”¹ã€‚

å¯ä»¥é€šè¿‡è°ƒç”¨ `require` ã€ `revert` æˆ– `assert` æŠ›å‡ºé”™è¯¯ã€‚

-   `require` ç”¨äºåœ¨æ‰§è¡Œå‰éªŒè¯è¾“å…¥å’Œæ¡ä»¶ã€‚
    
-   `revert` ç±»ä¼¼äº requireã€‚ä»¥ä¸‹ä»£ç æä¾›äº†è¯¦ç»†ä¿¡æ¯
    
-   `assert` ç”¨äºæ£€æŸ¥æ°¸è¿œä¸åº”ä¸ºå‡çš„ä»£ç ã€‚æ–­è¨€å¤±è´¥è¿”å›é”™è¯¯ä¿¡æ¯ `Panic(0x01)`ï¼ˆAssertion failedï¼‰ï¼Œ**æ²¡æœ‰**æ–‡å­—æè¿°
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Error {
    // 1. æµ‹è¯• require
    function testRequire(uint256 _i) public pure {
        // Require ç”¨æ¥åšâ€œå®ˆé—¨å‘˜â€ï¼ŒéªŒè¯ï¼š
        // - è¾“å…¥å‚æ•°
        // - æ‰§è¡Œå‰çš„æ¡ä»¶
        // - è°ƒç”¨å…¶ä»–å‡½æ•°çš„è¿”å›å€¼
        // è¯­æ³•ï¼šrequire(æ¡ä»¶, "é”™è¯¯æç¤ºä¿¡æ¯");
        require(_i > 10, "Input must be greater than 10");
    }

    // 2. æµ‹è¯• revert
    function testRevert(uint256 _i) public pure {
        // Revert é€‚ç”¨äºåˆ¤æ–­é€»è¾‘éå¸¸å¤æ‚çš„åœºæ™¯ï¼ˆä¾‹å¦‚æœ‰å¤šå±‚ if-else åµŒå¥—ï¼‰
        // ä¸‹é¢è¿™æ®µä»£ç çš„ä½œç”¨å’Œä¸Šé¢ testRequire å®Œå…¨ä¸€æ ·
        if (_i <= 10) {
            // è¯­æ³•ï¼šrevert("é”™è¯¯æç¤ºä¿¡æ¯");
            revert("Input must be greater than 10");
        }
    }

    uint256 public num;
    
    // 3. æµ‹è¯• assert
    function testAssert() public view {
        // Assert åº”è¯¥ä»…ç”¨äºæµ‹è¯•å†…éƒ¨é”™è¯¯å’Œæ£€æŸ¥ä¸å˜é‡ (Invariants)ã€‚
        // è¿™é‡Œçš„ num æ°¸è¿œæ˜¯ 0ï¼Œå› ä¸ºåˆçº¦é‡Œæ²¡æœ‰ä¿®æ”¹ num çš„å‡½æ•°ã€‚
        // å¦‚æœè¿™é‡ŒæŠ¥é”™ï¼Œè¯´æ˜ EVM å‡ºé—®é¢˜äº†æˆ–è€…ä»£ç é€»è¾‘æœ‰ä¸¥é‡çš„ Bugã€‚
        assert(num == 0);
    }

    // 4. è‡ªå®šä¹‰é”™è¯¯ (Custom Error) - çœé’±åˆ©å™¨
    // å®šä¹‰ä¸€ä¸ªé”™è¯¯ç±»å‹ï¼Œå¯ä»¥å¸¦å‚æ•°
    error InsufficientBalance(uint256 balance, uint256 withdrawAmount);

    function testCustomError(uint256 _withdrawAmount) public view {
        uint256 bal = address(this).balance;
        // å¦‚æœä½™é¢ä¸è¶³
        if (bal < _withdrawAmount) {
            // æŠ›å‡ºè‡ªå®šä¹‰é”™è¯¯
            // è¿™ç§æ–¹å¼æ¯” require(..., "Long String") ä¾¿å®œå¾ˆå¤š
            revert InsufficientBalance({
                balance: bal,
                withdrawAmount: _withdrawAmount
            });
        }
    }
}
```

è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹

```Solidity
contract Account {
    uint256 public balance;
    // MAX_UINT æ˜¯ uint256 èƒ½å­˜çš„æœ€å¤§æ•°å­—
    uint256 public constant MAX_UINT = 2 ** 256 - 1;

    function deposit(uint256 _amount) public {
        uint256 oldBalance = balance;
        uint256 newBalance = balance + _amount;

        // ã€å‰ç½®æ£€æŸ¥ã€‘é˜²æ­¢æº¢å‡º (Overflow)
        // è¿™é‡Œçš„é€»è¾‘æ˜¯ï¼šå¦‚æœåŠ æ³•æº¢å‡ºï¼Œç»“æœä¼šå˜å°ã€‚
        // (æ³¨ï¼šSolidity 0.8.0 ä¹‹åè‡ªå¸¦æº¢å‡ºæ£€æŸ¥ï¼Œè¿™è¡Œä»£ç ä¸»è¦æ˜¯æ¼”ç¤ºé€»è¾‘)
        require(newBalance >= oldBalance, "Overflow");

        balance = newBalance;

        // ã€åç½®æ£€æŸ¥ã€‘ä¸å˜é‡æ£€æŸ¥
        // å­˜æ¬¾åï¼Œæ–°ä½™é¢ä¸€å®šè¦å¤§äºç­‰äºæ—§ä½™é¢ï¼Œè¿™æ˜¯ç»å¯¹çœŸç†ã€‚
        // å¦‚æœè¿™è¡ŒæŠ¥é”™ï¼Œè¯´æ˜ä¸Šé¢çš„åŠ æ³•é€»è¾‘æœ‰ä¸¥é‡æ¼æ´ã€‚
        assert(balance >= oldBalance);
    }

    function withdraw(uint256 _amount) public {
        uint256 oldBalance = balance;

        // ã€å‰ç½®æ£€æŸ¥ã€‘é˜²æ­¢ä¸‹æº¢ (Underflow) å’Œé€æ”¯
        require(balance >= _amount, "Underflow");

        // è¿™é‡Œå±•ç¤ºäº† if + revert çš„å†™æ³•ï¼Œæ•ˆæœåŒä¸Š
        if (balance < _amount) {
            revert("Underflow");
        }

        balance -= _amount;

        // ã€åç½®æ£€æŸ¥ã€‘
        // å–æ¬¾åï¼Œä½™é¢è‚¯å®šå˜å°‘äº†ã€‚
        assert(balance <= oldBalance);
    }
}
```

### Function Modifier

ä¿®é¥°ç¬¦æ˜¯å¯ä»¥è¿è¡Œåœ¨å‡½æ•°è°ƒç”¨ä¹‹å‰å’Œ/æˆ–ä¹‹åçš„ä»£ç ã€‚

ä¿®é¥°ç¬¦å¯ç”¨äºï¼š

-   Restrict access é™åˆ¶è®¿é—®
    
-   Validate inputs éªŒè¯è¾“å…¥
    
-   Guard against reentrancy hack é˜²èŒƒé‡å…¥æ”»å‡»
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract FunctionModifier {
    // æˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›å˜é‡æ¥æ¼”ç¤ºä¿®é¥°å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„
    address public owner;
    uint256 public x = 10;
    bool public locked;

    constructor() {
        // å°†éƒ¨ç½²åˆçº¦çš„äººï¼ˆäº¤æ˜“å‘é€è€…ï¼‰è®¾ç½®ä¸ºåˆçº¦çš„ owner
        owner = msg.sender;
    }

    // ã€ä¿®é¥°å™¨ 1ï¼šæƒé™æ§åˆ¶ã€‘
    // æ£€æŸ¥è°ƒç”¨è€…æ˜¯å¦æ˜¯åˆçº¦çš„ owner
    modifier onlyOwner() {
        require(msg.sender == owner, "Not owner");
        // ã€å…³é”®ç‚¹ã€‘ï¼šä¸‹åˆ’çº¿ _ æ˜¯ä¿®é¥°å™¨ç‰¹æœ‰çš„ç¬¦å·
        // å®ƒå‘Šè¯‰ Solidityï¼šâ€œè¯·æŠŠè¢«ä¿®é¥°å‡½æ•°çš„ä»£ç ç²˜è´´åˆ°è¿™é‡Œæ¥æ‰§è¡Œâ€
        _;
    }

    // ã€ä¿®é¥°å™¨ 2ï¼šå‚æ•°æ ¡éªŒã€‘
    // ä¿®é¥°å™¨ä¹Ÿå¯ä»¥æ¥æ”¶å‚æ•°ã€‚è¿™é‡Œæ£€æŸ¥ä¼ å…¥çš„åœ°å€ä¸æ˜¯ 0 åœ°å€ã€‚
    modifier validAddress(address _addr) {
        require(_addr != address(0), "Not valid address");
        _;
    }

    // ä½¿ç”¨ä¿®é¥°å™¨çš„å‡½æ•°
    // è¿™é‡ŒåŒæ—¶ä½¿ç”¨äº†ä¸¤ä¸ªä¿®é¥°å™¨ï¼š
    // 1. å…ˆæ‰§è¡Œ onlyOwner æ£€æŸ¥èº«ä»½
    // 2. å†æ‰§è¡Œ validAddress æ£€æŸ¥å‚æ•°
    // 3. éƒ½é€šè¿‡äº†ï¼Œæ‰æ‰§è¡Œ changeOwner çš„å¤§æ‹¬å·é‡Œçš„ä»£ç 
    function changeOwner(address _newOwner)
        public
        onlyOwner
        validAddress(_newOwner)
    {
        owner = _newOwner;
    }

    // ã€ä¿®é¥°å™¨ 3ï¼šé˜²é‡å…¥é”ã€‘
    // ä¿®é¥°å™¨å¯ä»¥åœ¨å‡½æ•°æ‰§è¡Œã€å‰ã€‘å’Œã€åã€‘éƒ½è¿è¡Œä»£ç ã€‚
    // è¿™ä¸ªä¿®é¥°å™¨é˜²æ­¢å‡½æ•°åœ¨ä»åœ¨æ‰§è¡Œæ—¶è¢«å†æ¬¡è°ƒç”¨ï¼ˆé˜²é‡å…¥ï¼‰ã€‚
    modifier noReentrancy() {
        // --- å‡½æ•°æ‰§è¡Œå‰ (Before) ---
        require(!locked, "No reentrancy");
        locked = true;
        
        // --- æ’å…¥åŸæœ¬çš„å‡½æ•°é€»è¾‘ ---
        _;
        
        // --- å‡½æ•°æ‰§è¡Œå (After) ---
        locked = false;
    }

    // è¿™æ˜¯ä¸€ä¸ªä¼šè§¦å‘é€’å½’è°ƒç”¨çš„å‡½æ•°ï¼Œç”¨æ¥æµ‹è¯•é”æ˜¯å¦ç”Ÿæ•ˆ
    function decrement(uint256 i) public noReentrancy {
        x -= i;
        if (i > 1) {
            // è¿™é‡Œå°è¯•å†æ¬¡è°ƒç”¨è‡ªå·±
            // å¦‚æœæ²¡æœ‰ noReentrancyï¼Œè¿™ä¼šæˆåŠŸé€’å½’
            // ä½†å› ä¸ºæœ‰äº†é”ï¼Œè¿™é‡Œä¼šæŠ¥é”™ revertï¼Œå› ä¸º locked è¿˜æ˜¯ true
            decrement(i - 1);
        }
    }
}
```

å‰é¢ä¹ŸåŸºæœ¬ä¸Šçœ‹äº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œè¿‡

### Events

`Events` å…è®¸è®°å½•åˆ°ä»¥å¤ªåŠåŒºå—é“¾ã€‚events çš„ä¸€äº›ç”¨ä¾‹åŒ…æ‹¬ï¼š

-   ç›‘å¬äº‹ä»¶å¹¶æ›´æ–°ç”¨æˆ·ç•Œé¢
    
-   ä¸€ç§å»‰ä»·çš„å­˜å‚¨å½¢å¼
    

-   ä¸»è¦æ˜¯ä¸ºäº†**é€šçŸ¥å‰ç«¯**æ›´æ–° UIï¼Œæˆ–è€…ä½œä¸º**å†å²æ•°æ®å­˜æ¡£**ï¼ˆå› ä¸ºæ¯” Storage ä¾¿å®œå¤ªå¤šï¼‰ã€‚
    
-   `indexed`**ï¼š** ç›¸å½“äºæ•°æ®åº“çš„ç´¢å¼•ï¼Œæœ€å¤š 3 ä¸ªï¼Œç”¨æ¥åŠ é€Ÿé“¾ä¸‹æŸ¥è¯¢ã€‚
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Event {
    // ã€å®šä¹‰äº‹ä»¶ã€‘
    // å£°æ˜ä¸€ä¸ªå« Log çš„äº‹ä»¶ã€‚
    // indexed å…³é”®å­—ï¼šæœ€å¤šå¯ä»¥æœ‰ 3 ä¸ªå‚æ•°è¢«æ ‡è®°ä¸º indexedã€‚
    // ä½œç”¨ï¼šæ ‡è®°ä¸º indexed çš„å‚æ•°ï¼Œå…è®¸ä½ åœ¨é“¾å¤–è¿›è¡Œâ€œæœç´¢â€å’Œâ€œè¿‡æ»¤â€ï¼ˆæ¯”å¦‚ï¼šåªæŸ¥å…³äºæŸä¸ªç‰¹å®šç”¨æˆ·çš„æ—¥å¿—ï¼‰ã€‚
    event Log(address indexed sender, string message);

    // å£°æ˜å¦ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„äº‹ä»¶
    event AnotherLog();

    function test() public {
        // ã€è§¦å‘äº‹ä»¶ã€‘
        // ä½¿ç”¨ emit å…³é”®å­—æ¥å‘é€äº‹ä»¶ã€‚
        // è¿™ç›¸å½“äºåœ¨åŒºå—é“¾ä¸Šæ‰“å°äº†ä¸€å¼ â€œæ”¶æ®â€ã€‚
        emit Log(msg.sender, "Hello World!");

        // å†å‘ä¸€æ¬¡
        emit Log(msg.sender, "Hello EVM!");

        // è§¦å‘é‚£ä¸ªæ²¡å‚æ•°çš„äº‹ä»¶
        emit AnotherLog();
    }
}
```

**"A cheap form of storage"**ã€‚

-   **State Storage (å˜é‡):** æ¯”å¦‚ `uint256 public x = 10;`ã€‚
    
    -   å­˜åœ¨å“ªé‡Œï¼Ÿä»¥å¤ªåŠçš„â€œçŠ¶æ€æ ‘ (State Trie)â€é‡Œã€‚
        
    -   ç‰¹ç‚¹ï¼šæ‰€æœ‰èŠ‚ç‚¹éƒ½è¦å®æ—¶ç»´æŠ¤å®ƒï¼Œåˆçº¦å¯ä»¥éšæ—¶è¯»å–å®ƒã€‚
        
    -   **ä»·æ ¼ï¼š** æè´µï¼ˆæ¯ 32 å­—èŠ‚ 20,000 Gasï¼‰ã€‚
        
-   **Events (æ—¥å¿—):** æ¯”å¦‚ `emit Log(...)`ã€‚
    
    -   å­˜åœ¨å“ªé‡Œï¼Ÿäº¤æ˜“çš„\*\*â€œæ”¶æ®æ ‘ (Receipt Trie)â€\*\*é‡Œã€‚
        
    -   ç‰¹ç‚¹ï¼šå®ƒåªæ˜¯ä½œä¸ºå†å²è®°å½•å­˜åœ¨åŒºå—é‡Œï¼Œ**åˆçº¦è‡ªå·±è¯»ä¸åˆ°å®ƒ**ï¼ˆä¸€æ—¦å‘å‡ºï¼Œæ³¼æ°´éš¾æ”¶ï¼‰ã€‚
        
    -   **ä»·æ ¼ï¼š** æä¾¿å®œï¼ˆæ¯å­—èŠ‚åªéœ€ 8 Gasï¼Œå¤–åŠ åŸºç¡€è´¹ï¼‰ã€‚
        

**æ™ºèƒ½åˆçº¦æ— æ³•è¯»å–è‡ªå·±ï¼ˆæˆ–åˆ«äººï¼‰å‘å‡ºçš„äº‹ä»¶ï¼**

```Solidity
function tryToReadLog() public {
    emit Log(msg.sender, "Hello");
    // âŒ ä¸‹é¢è¿™è¡Œä»£ç æ˜¯ä¸å­˜åœ¨çš„ï¼Solidity æ²¡æœ‰è¿™ç§è¯­æ³•ï¼
    // string memory m = readLog(msg.sender); 
}
```

-   **Events æ˜¯å•å‘çš„ï¼š** ä»é“¾ä¸Š -> å‘å°„åˆ° -> é“¾ä¸‹ã€‚
    
-   å¦‚æœä½ éœ€è¦åœ¨åˆçº¦å†…éƒ¨ä½¿ç”¨æ•°æ®ï¼Œå¿…é¡»ç”¨ **Storage** å­˜èµ·æ¥ã€‚
    
-   å¦‚æœä½ åªéœ€è¦å‘Šè¯‰å‰ç«¯â€œæˆ‘å®Œäº‹äº†â€ï¼Œæˆ–è€…ä¸ºäº†å°†æ¥æ•°æ®åˆ†æï¼ˆæ¯”å¦‚ç»Ÿè®¡ç”±äºå†å²äº¤æ˜“é‡ï¼‰ï¼Œç”¨ **Events**ã€‚
    

### Events Advanced

åœ¨ Solidity ä¸­ï¼Œäº‹ä»¶æ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å®ç°å„ç§é«˜çº§åŠŸèƒ½å’Œæ¶æ„ã€‚äº‹ä»¶çš„ä¸€äº›é«˜çº§ä½¿ç”¨æ¡ˆä¾‹åŒ…æ‹¬ï¼š

-   äº‹ä»¶è¿‡æ»¤å’Œç›‘æ§ä»¥å®ç°å®æ—¶æ›´æ–°å’Œåˆ†æ
    
-   äº‹ä»¶æ—¥å¿—åˆ†æå’Œè§£ç ï¼Œç”¨äºæ•°æ®æå–å’Œå¤„ç†
    
-   å»ä¸­å¿ƒåŒ–åº”ç”¨ï¼ˆdAppsï¼‰çš„äº‹ä»¶é©±åŠ¨æ¶æ„
    
-   äº‹ä»¶è®¢é˜…ï¼Œç”¨äºå®æ—¶é€šçŸ¥å’Œæ›´æ–°
    

`EventDrivenArchitecture` åˆçº¦å±•ç¤ºäº†ä¸€ç§äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œå…¶ä¸­äº‹ä»¶ç”¨äºåè°ƒå’Œè§¦å‘æµç¨‹çš„ä¸åŒé˜¶æ®µï¼Œä¾‹å¦‚å‘èµ·å’Œç¡®è®¤è½¬è´¦ã€‚

`EventSubscription` åˆçº¦å±•ç¤ºäº†å¦‚ä½•å®ç°äº‹ä»¶è®¢é˜…ï¼Œå…è®¸å¤–éƒ¨åˆçº¦æˆ–å®¢æˆ·ç«¯åœ¨äº‹ä»¶å‘å‡ºæ—¶è®¢é˜…å¹¶æ¥æ”¶å®æ—¶æ›´æ–°ã€‚å®ƒè¿˜å±•ç¤ºäº†å¦‚ä½•å¤„ç†äº‹ä»¶è®¢é˜…å’Œç®¡ç†è®¢é˜…ç”Ÿå‘½å‘¨æœŸã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.14;

// --- 1. äº‹ä»¶é©±åŠ¨æ¶æ„ç¤ºä¾‹ ---
contract EventDrivenArchitecture {
    // å®šä¹‰ä¸¤ä¸ªäº‹ä»¶ï¼Œåˆ†åˆ«å¯¹åº”æµç¨‹çš„ä¸¤ä¸ªé˜¶æ®µ
    event TransferInitiated(
        address indexed from, address indexed to, uint256 value
    );
    event TransferConfirmed(
        address indexed from, address indexed to, uint256 value
    );

    // ç”¨äºè®°å½•è½¬è´¦ç¡®è®¤çŠ¶æ€çš„ Mapping
    mapping(bytes32 => bool) public transferConfirmations;

    // ç¬¬ä¸€æ­¥ï¼šå‘èµ·è½¬è´¦
    function initiateTransfer(address to, uint256 value) public {
        // å‘å‡ºâ€œå‘èµ·â€äº‹ä»¶ï¼Œåç«¯æˆ–ç´¢å¼•å™¨ç›‘å¬åˆ°åä¼šè¿›è¡Œè®°å½•
        emit TransferInitiated(msg.sender, to, value);
        // ... (æ­¤å¤„çœç•¥å…·ä½“çš„å‘èµ·é€»è¾‘ï¼Œå¦‚å†»ç»“èµ„é‡‘)
    }

    // ç¬¬äºŒæ­¥ï¼šç¡®è®¤è½¬è´¦
    function confirmTransfer(bytes32 transferId) public {
        require(
            !transferConfirmations[transferId], "Transfer already confirmed"
        );
        transferConfirmations[transferId] = true;
        // å‘å‡ºâ€œç¡®è®¤â€äº‹ä»¶ï¼Œæ ‡å¿—æµç¨‹ç»“æŸ
        emit TransferConfirmed(msg.sender, address(this), 0);
        // ... (æ­¤å¤„çœç•¥ç¡®è®¤é€»è¾‘ï¼Œå¦‚å®é™…åˆ’è½¬èµ„é‡‘)
    }
}

// --- 2. äº‹ä»¶è®¢é˜…ä¸å®æ—¶æ›´æ–°ç¤ºä¾‹ ---

// å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè®¢é˜…è€…åˆçº¦å¿…é¡»å®ç°è¿™ä¸ªæ¥å£æ‰èƒ½æ¥æ”¶é€šçŸ¥
interface IEventSubscriber {
    function handleTransferEvent(address from, address to, uint256 value)
        external;
}

contract EventSubscription {
    event LogTransfer(address indexed from, address indexed to, uint256 value);
    
    // è®°å½•è°è®¢é˜…äº† (é˜²æ­¢é‡å¤è®¢é˜…)
    mapping(address => bool) public subscribers;
    // è®¢é˜…è€…åˆ—è¡¨ (ç”¨äºéå†é€šçŸ¥)
    address[] public subscriberList;

    // è®¢é˜…å‡½æ•°
    function subscribe() public {
        require(!subscribers[msg.sender], "Already subscribed");
        subscribers[msg.sender] = true;
        subscriberList.push(msg.sender); // åŠ å…¥åˆ—è¡¨
    }

    // å–æ¶ˆè®¢é˜…å‡½æ•°
    function unsubscribe() public {
        require(subscribers[msg.sender], "Not subscribed");
        subscribers[msg.sender] = false;
        
        // ã€å…³é”®æŠ€å·§ã€‘ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ çš„ä½ Gas æ–¹æ³•ï¼šSwap and Pop
        for (uint256 i = 0; i < subscriberList.length; i++) {
            if (subscriberList[i] == msg.sender) {
                // 1. æŠŠæœ€åä¸€ä¸ªå…ƒç´ ç§»åˆ°å½“å‰è¦åˆ é™¤çš„ä½ç½®
                subscriberList[i] = subscriberList[subscriberList.length - 1];
                // 2. åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆç¼©çŸ­æ•°ç»„é•¿åº¦ï¼‰
                subscriberList.pop();
                break;
            }
        }
    }

    // è§¦å‘è½¬è´¦å¹¶é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…
    function transfer(address to, uint256 value) public {
        // 1. å‘å‡ºå¸¸è§„æ—¥å¿—
        emit LogTransfer(msg.sender, to, value);
        
        // 2. é“¾ä¸Šå¹¿æ’­ï¼šéå†åˆ—è¡¨ï¼Œä¸»åŠ¨è°ƒç”¨è®¢é˜…è€…åˆçº¦çš„å‡½æ•°
        for (uint256 i = 0; i < subscriberList.length; i++) {
            // å¼ºåˆ¶è½¬æ¢åœ°å€ä¸ºæ¥å£ç±»å‹ï¼Œå¹¶è°ƒç”¨å¤„ç†å‡½æ•°
            IEventSubscriber(subscriberList[i]).handleTransferEvent(
                msg.sender, to, value
            );
        }
    }
}
```

-   ä¸ºå¯ç”¨é«˜æ•ˆçš„è¿‡æ»¤å’Œæœç´¢ï¼Œåº”ç´¢å¼•æ­£ç¡®çš„äº‹ä»¶å‚æ•°ã€‚åœ°å€é€šå¸¸åº”è¢«ç´¢å¼•ï¼Œè€Œé‡‘é¢ä¸€èˆ¬ä¸åº”è¢«ç´¢å¼•ã€‚
    
-   é¿å…å†—ä½™äº‹ä»¶ï¼Œä¸è¦å‘å‡ºå·²è¢«åº•å±‚åº“æˆ–åˆçº¦è¦†ç›–çš„äº‹ä»¶ã€‚
    
-   äº‹ä»¶ä¸èƒ½åœ¨ `view` æˆ– `pure` å‡½æ•°ä¸­ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬é€šè¿‡å­˜å‚¨æ—¥å¿—æ¥æ”¹å˜åŒºå—é“¾çŠ¶æ€ã€‚
    
-   æ³¨æ„å‘å‡ºäº‹ä»¶ç›¸å…³çš„ gas æˆæœ¬ï¼Œå°¤å…¶æ˜¯åœ¨ç´¢å¼•å‚æ•°æ—¶ï¼Œå› ä¸ºå®ƒä¼šå½±å“åˆçº¦çš„æ•´ä½“ gas æ¶ˆè€—ã€‚
    

### Constructor

æ„é€ å‡½æ•°ï¼ˆ `constructor` ï¼‰æ˜¯åœ¨åˆçº¦åˆ›å»ºæ—¶æ‰§è¡Œçš„å¯é€‰å‡½æ•°ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// åŸºç±»åˆçº¦ X (Base contract X)
contract X {
    string public name;

    // æ„é€ å‡½æ•°ï¼šéœ€è¦ä¼ å…¥ä¸€ä¸ª _name å‚æ•°
    constructor(string memory _name) {
        name = _name;
    }
}

// åŸºç±»åˆçº¦ Y (Base contract Y)
contract Y {
    string public text;

    // æ„é€ å‡½æ•°ï¼šéœ€è¦ä¼ å…¥ä¸€ä¸ª _text å‚æ•°
    constructor(string memory _text) {
        text = _text;
    }
}

// ã€æ–¹æ³• 1ï¼šé™æ€ä¼ å‚ã€‘
// æœ‰ä¸¤ç§åˆå§‹åŒ–çˆ¶åˆçº¦çš„æ–¹æ³•ã€‚
// ç¬¬ä¸€ç§ï¼šåœ¨ç»§æ‰¿åˆ—è¡¨ï¼ˆinheritance listï¼‰ä¸­ç›´æ¥æŠŠå‚æ•°å†™æ­»ã€‚
// B ç»§æ‰¿è‡ª X å’Œ Yï¼Œå¹¶ä¸”åœ¨å®šä¹‰æ—¶å°±ç»™å‡ºäº†å‚æ•°ã€‚
contract B is X("Input to X"), Y("Input to Y") {}

// ã€æ–¹æ³• 2ï¼šåŠ¨æ€ä¼ å‚ã€‘
contract C is X, Y {
    // ç¬¬äºŒç§ï¼šåœ¨å­åˆçº¦çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’å‚æ•°ï¼Œ
    // å†™æ³•ç±»ä¼¼äºå‡½æ•°ä¿®é¥°å™¨ (modifier)ã€‚
    // è¿™é‡Œ C çš„æ„é€ å‡½æ•°æ¥æ”¶å‚æ•°ï¼Œç„¶åæŠŠå®ƒä»¬â€œé€ä¼ â€ç»™ X å’Œ Yã€‚
    constructor(string memory _name, string memory _text) X(_name) Y(_text) {}
}

// ã€å…³äºæ‰§è¡Œé¡ºåºçš„é‡è¦è§„åˆ™ã€‘
// çˆ¶åˆçº¦æ„é€ å‡½æ•°æ€»æ˜¯æŒ‰ç…§â€œç»§æ‰¿åˆ—è¡¨â€ä¸­çš„å£°æ˜é¡ºåºè¢«è°ƒç”¨ã€‚
// æ— è®ºä½ åœ¨å­åˆçº¦æ„é€ å‡½æ•°é‡Œæ€ä¹ˆå†™ï¼ˆå…ˆå†™ X è¿˜æ˜¯å…ˆå†™ Yï¼‰ï¼Œéƒ½ä¸å½±å“è¿™ä¸ªé¡ºåºã€‚

// è¿™é‡Œçš„ç»§æ‰¿é¡ºåºæ˜¯ï¼šis X, Y
// æ‰€ä»¥æ„é€ å‡½æ•°è°ƒç”¨é¡ºåºæ˜¯ï¼š
// 1. X
// 2. Y
// 3. D
contract D is X, Y {
    // å³ä½¿è¿™é‡Œå…ˆå†™äº† X(...) å†å†™ Y(...)ï¼Œé¡ºåºä¾ç„¶ç”± `is X, Y` å†³å®š
    constructor() X("X was called") Y("Y was called") {}
}

// è¿™é‡Œçš„ç»§æ‰¿é¡ºåºä¾ç„¶æ˜¯ï¼šis X, Y
// æ‰€ä»¥æ„é€ å‡½æ•°è°ƒç”¨é¡ºåºä¾ç„¶æ˜¯ï¼š
// 1. X
// 2. Y
// 3. E
contract E is X, Y {
    // å…³é”®ç‚¹ï¼šå“ªæ€•ä½ åœ¨è¿™é‡Œå…ˆå†™äº† Y(...) åå†™ X(...)ï¼Œ
    // çœŸå®çš„æ‰§è¡Œé¡ºåºä¾ç„¶æ˜¯å…ˆ X å Yï¼
    constructor() Y("Y was called") X("X was called") {}
}
```

### Inheritance ç»§æ‰¿

Solidity æ”¯æŒå¤šé‡ç»§æ‰¿ã€‚åˆçº¦å¯ä»¥é€šè¿‡ä½¿ç”¨ `is` å…³é”®å­—æ¥ç»§æ‰¿å…¶ä»–åˆçº¦ã€‚

è¢«å­åˆçº¦é‡å†™çš„å‡½æ•°å¿…é¡»å£°æ˜ä¸º `virtual` ã€‚

é‡å†™çˆ¶å‡½æ•°çš„å‡½æ•°å¿…é¡»ä½¿ç”¨ `override` å…³é”®å­—ã€‚

ç»§æ‰¿é¡ºåºå¾ˆé‡è¦ã€‚

ä½ å¿…é¡»æŒ‰ç…§ä»â€œæœ€åŸºç¡€â€åˆ°â€œæœ€æ´¾ç”Ÿâ€çš„é¡ºåºåˆ—å‡ºçˆ¶åˆçº¦ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

/* ç»§æ‰¿å…³ç³»å›¾ (Graph of inheritance)
    A
   / \
  B   C
 / \ /
F  D,E
*/

// åŸºç±»åˆçº¦ A
contract A {
    // ã€å…³é”®ç‚¹ 1ã€‘virtual
    // å¦‚æœä¸€ä¸ªå‡½æ•°å°†æ¥æ‰“ç®—è¢«å­åˆçº¦ä¿®æ”¹ï¼ˆé‡å†™ï¼‰ï¼Œå¿…é¡»æ ‡è®°ä¸º virtualã€‚
    function foo() public pure virtual returns (string memory) {
        return "A";
    }
}

// åˆçº¦ä½¿ç”¨ 'is' å…³é”®å­—æ¥ç»§æ‰¿å…¶ä»–åˆçº¦
contract B is A {
    // ã€å…³é”®ç‚¹ 2ã€‘override
    // é‡å†™çˆ¶ç±» A çš„ foo å‡½æ•°ã€‚å¿…é¡»åŠ ä¸Š override å…³é”®å­—ã€‚
    function foo() public pure virtual override returns (string memory) {
        return "B";
    }
}

contract C is A {
    // é‡å†™ A çš„ foo å‡½æ•°
    function foo() public pure virtual override returns (string memory) {
        return "C";
    }
}

// ã€å…³é”®ç‚¹ 3ã€‘å¤šé‡ç»§æ‰¿ (Multiple Inheritance)
// åˆçº¦å¯ä»¥ç»§æ‰¿å¤šä¸ªçˆ¶åˆçº¦ã€‚
// å½“åŒä¸€ä¸ªå‡½æ•°åœ¨å¤šä¸ªçˆ¶åˆçº¦ä¸­éƒ½è¢«å®šä¹‰æ—¶ï¼Œçˆ¶åˆçº¦çš„æœç´¢é¡ºåºæ˜¯ï¼š
// ä»å³å‘å·¦ (Right to Left)ï¼Œå¹¶ä¸”æ˜¯æ·±åº¦ä¼˜å…ˆ (Depth-first) çš„ã€‚

contract D is B, C {
    // D.foo() ä¼šè¿”å› "C"
    // å› ä¸ºåœ¨ç»§æ‰¿åˆ—è¡¨ `is B, C` ä¸­ï¼ŒC åœ¨æœ€å³è¾¹ (Right-most)ã€‚
    // æ‰€ä»¥ C çš„ foo() ä¼šè¦†ç›– B çš„ foo()ã€‚
    
    // override(B, C) è¡¨ç¤ºï¼šæˆ‘è¦é‡å†™çš„è¿™ä¸ªå‡½æ•°ï¼Œåœ¨ B å’Œ C é‡Œéƒ½æœ‰ä»½ã€‚
    function foo() public pure override(B, C) returns (string memory) {
        // super.foo() ä¼šè°ƒç”¨ç»§æ‰¿é“¾ä¸Šçš„â€œä¸‹ä¸€ä¸ªâ€åˆçº¦ï¼Œè¿™é‡Œå°±æ˜¯ C
        return super.foo();
    }
}

contract E is C, B {
    // E.foo() ä¼šè¿”å› "B"
    // å› ä¸ºåœ¨ç»§æ‰¿åˆ—è¡¨ `is C, B` ä¸­ï¼ŒB åœ¨æœ€å³è¾¹ã€‚
    function foo() public pure override(C, B) returns (string memory) {
        return super.foo();
    }
}

// ã€å…³é”®ç‚¹ 4ã€‘ç»§æ‰¿é¡ºåº (Inheritance Order)
// ç»§æ‰¿åˆ—è¡¨å¿…é¡»æŒ‰ç…§ä»â€œæœ€åŸºç±» (Base)â€åˆ°â€œæœ€æ´¾ç”Ÿç±» (Derived)â€çš„é¡ºåºæ’åˆ—ã€‚
// A æ˜¯çˆ·çˆ·ï¼ŒB æ˜¯çˆ¸çˆ¸ã€‚ä½ å¿…é¡»å…ˆå†™ Aï¼Œå†å†™ Bã€‚
// å¦‚æœå†™æˆ `contract F is B, A`ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚
contract F is A, B {
    function foo() public pure override(A, B) returns (string memory) {
        return super.foo();
    }
```

**æœ‰** `virtual` **æ ‡ç­¾çš„å‡½æ•°ï¼Œè¢«ç»§æ‰¿æ—¶æ˜¯å¿…é¡»è¦ override çš„å—ï¼Ÿä¸æ˜¯å¿…é¡»çš„ã€‚** åªè¦çˆ¶ç±»çš„è¿™ä¸ªå‡½æ•°æœ‰â€œå‡½æ•°ä½“â€ï¼ˆå³å¤§æ‹¬å· `{ ... }` é‡Œé¢æœ‰ä»£ç ï¼‰ï¼Œå­ç±»å°±å¯ä»¥é€‰æ‹©ä¸é‡å†™ã€‚

-   _åªæœ‰ä¸€ç§æƒ…å†µæ˜¯å¿…é¡»é‡å†™çš„ï¼š_ å¦‚æœçˆ¶ç±»å‡½æ•°**æ²¡æœ‰å‡½æ•°ä½“**ï¼ˆåˆ†å·ç»“å°¾ï¼‰ï¼Œé‚£ä¹ˆå­ç±»**å¿…é¡»**å®ç°å®ƒï¼ˆé™¤éå­ç±»ä¹Ÿæ˜¯æŠ½è±¡åˆçº¦ï¼‰ã€‚
    

**å¦‚æœä¸ override èƒ½å¦ç›´æ¥ä½¿ç”¨çˆ¶ç±»çš„åŒåå‡½æ•°ï¼Ÿå®Œå…¨å¯ä»¥ï¼Œè€Œä¸”æ˜¯è‡ªåŠ¨æ‹¥æœ‰çš„ã€‚** å­åˆçº¦ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»çš„é€»è¾‘ï¼Œå°±åƒè¿™è¡Œä»£ç æ˜¯å†™åœ¨å­åˆçº¦é‡Œä¸€æ ·ã€‚

### Shadowing Inherited State Variables ç»§æ‰¿çŠ¶æ€å˜é‡çš„é®è”½

ä¸å‡½æ•°ä¸åŒï¼ŒçŠ¶æ€å˜é‡ä¸èƒ½é€šè¿‡åœ¨å­åˆçº¦ä¸­é‡æ–°å£°æ˜æ¥è¦†ç›–ã€‚

ç®€å•æ¥è¯´ï¼Œå®ƒçš„æ ¸å¿ƒè§„åˆ™æ˜¯ï¼š**ä½ ä¸èƒ½åœ¨å­åˆçº¦é‡Œå†å®šä¹‰ä¸€ä¸ªå’Œçˆ¶åˆçº¦åŒåçš„å˜é‡ï¼Œä½ åº”è¯¥ç›´æ¥ä¿®æ”¹çˆ¶åˆçº¦çš„é‚£ä¸ªå˜é‡ã€‚**

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract A {
    string public name = "Contract A";

    function getName() public view returns (string memory) {
        return name;
    }
}

// ã€é”™è¯¯ç¤ºèŒƒã€‘
// Solidity 0.6 ç‰ˆæœ¬ä¹‹åï¼Œç¦æ­¢é®è”½ï¼ˆShadowingï¼‰çŠ¶æ€å˜é‡ã€‚
// ä¸‹é¢çš„ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚
// contract B is A {
//     // é”™è¯¯ï¼šçˆ¶åˆçº¦ A å·²ç»æœ‰ä¸€ä¸ªå« 'name' çš„å˜é‡äº†ã€‚
//     // ä½ ä¸èƒ½åœ¨è¿™é‡Œé‡æ–°å£°æ˜ä¸€ä¸ª string public nameã€‚
//     string public name = "Contract B";
// }

contract C is A {
    // ã€æ­£ç¡®ç¤ºèŒƒã€‘
    // è¿™æ˜¯è¦†ç›–ç»§æ‰¿çŠ¶æ€å˜é‡çš„æ­£ç¡®æ–¹å¼ã€‚
    // ä¸è¦é‡æ–°å£°æ˜ï¼Œè€Œæ˜¯é€šè¿‡æ„é€ å‡½æ•°å»ä¿®æ”¹å®ƒçš„å€¼ã€‚
    constructor() {
        // ç›´æ¥ç»™çˆ¶ç±»å·²ç»å®šä¹‰å¥½çš„ name èµ‹å€¼
        name = "Contract C";
    }

    // è°ƒç”¨ C.getName() å°†è¿”å› "Contract C"
}
```

### Calling Parent Contracts è°ƒç”¨çˆ¶åˆçº¦

çˆ¶åˆçº¦å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œæˆ–ä½¿ç”¨å…³é”®å­— `super` ã€‚

ä½¿ç”¨å…³é”®å­— `super` ï¼Œæ‰€æœ‰ç›´æ¥çˆ¶åˆçº¦éƒ½ä¼šè¢«è°ƒç”¨ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

/* ç»§æ‰¿æ ‘ç»“æ„ (Graph of inheritance)
    A
   / \
  B   C
   \ /
    D
*/

contract A {
    // è¿™æ˜¯ä¸€ä¸ªäº‹ä»¶ã€‚ä½ å¯ä»¥ä»å‡½æ•°ä¸­å‘å‡ºäº‹ä»¶ï¼Œå®ƒä»¬ä¼šè¢«è®°å½•åœ¨äº¤æ˜“æ—¥å¿—ä¸­ã€‚
    // åœ¨æœ¬ä¾‹ä¸­ï¼Œè¿™å¯¹äºè¿½è¸ªå‡½æ•°è°ƒç”¨è·¯å¾„éå¸¸æœ‰ç”¨ã€‚
    event Log(string message);

    function foo() public virtual {
        emit Log("A.foo called");
    }

    function bar() public virtual {
        emit Log("A.bar called");
    }
}

contract B is A {
    function foo() public virtual override {
        emit Log("B.foo called");
        // ã€æ–¹å¼ 1ï¼šç›´æ¥è°ƒç”¨ã€‘æŒ‡åé“å§“åœ°è°ƒç”¨ A çš„ foo
        A.foo();
    }

    function bar() public virtual override {
        emit Log("B.bar called");
        // ã€æ–¹å¼ 2ï¼šSuper è°ƒç”¨ã€‘è°ƒç”¨ç»§æ‰¿é“¾ä¸Šçš„â€œä¸Šä¸€çº§â€
        super.bar();
    }
}

contract C is A {
    function foo() public virtual override {
        emit Log("C.foo called");
        // ã€æ–¹å¼ 1ï¼šç›´æ¥è°ƒç”¨ã€‘æŒ‡åé“å§“åœ°è°ƒç”¨ A çš„ foo
        A.foo();
    }

    function bar() public virtual override {
        emit Log("C.bar called");
        // ã€æ–¹å¼ 2ï¼šSuper è°ƒç”¨ã€‘è°ƒç”¨ç»§æ‰¿é“¾ä¸Šçš„â€œä¸Šä¸€çº§â€
        super.bar();
    }
}

// D ç»§æ‰¿äº† B å’Œ C (æ³¨æ„é¡ºåºï¼šis B, C)
contract D is B, C {
    // å°è¯•æ“ä½œï¼š
    // - è°ƒç”¨ D.foo å¹¶æ£€æŸ¥äº¤æ˜“æ—¥å¿—ã€‚
    //   è™½ç„¶ D ç»§æ‰¿äº† A, B å’Œ Cï¼Œä½†å®ƒåªè°ƒç”¨äº† Cï¼Œç„¶åæ˜¯ Aã€‚
    // - è°ƒç”¨ D.bar å¹¶æ£€æŸ¥äº¤æ˜“æ—¥å¿—ã€‚
    //   D è°ƒç”¨äº† Cï¼Œç„¶å C çš„ super è°ƒåˆ°äº† Bï¼Œæœ€å B çš„ super è°ƒåˆ°äº† Aã€‚
    //   è™½ç„¶ super è¢«è°ƒç”¨äº†ä¸¤æ¬¡ï¼ˆåœ¨ B å’Œ C ä¸­ï¼‰ï¼Œä½† A åªè¢«è°ƒç”¨äº†ä¸€æ¬¡ã€‚

    function foo() public override(B, C) {
        // è¿™é‡Œçš„ super æŒ‡å‘ C (å› ä¸º C åœ¨ç»§æ‰¿åˆ—è¡¨çš„æœ€å³è¾¹)
        super.foo();
    }

    function bar() public override(B, C) {
        // è¿™é‡Œçš„ super æŒ‡å‘ C
        super.bar();
    }
}
```

å­ç±»èƒ½ç›´æ¥è°ƒç”¨ çˆ·ç±» çš„æ¥å£

æ¯”å¦‚è¯´ä¸Šé¢çš„ä»£ç ä¸­çš„ D èƒ½ç›´æ¥ä½¿ç”¨ A çš„æ¥å£ï¼Œåªéœ€è¦å†™ A.foo() å³å¯

### Visibility å¯è§æ€§

è¿™ä¸ªå‰é¢åŸºæœ¬ä¸Šä¹Ÿçœ‹è¿‡äº†

**å‡½æ•°çš„å¯è§æ€§å¯ä»¥æ˜¯ï¼š**

-   `public` **(å…¬å¼€)**ï¼šä»»ä½•åˆçº¦ã€ä»»ä½•è´¦å·ï¼ˆEOAï¼‰éƒ½å¯ä»¥è°ƒç”¨ã€‚
    
-   `private` **(ç§æœ‰)**ï¼š**æœ€ä¸¥æ ¼**ã€‚åªæœ‰**å®šä¹‰è¯¥å‡½æ•°**çš„åˆçº¦å†…éƒ¨å¯ä»¥è°ƒç”¨ï¼ˆå­åˆçº¦ä¹Ÿä¸è¡Œï¼‰ã€‚
    
-   `internal` **(å†…éƒ¨)**ï¼šåªæœ‰åˆçº¦**å†…éƒ¨**ä»¥åŠ**ç»§æ‰¿è¯¥åˆçº¦çš„å­åˆçº¦**å¯ä»¥è°ƒç”¨ã€‚
    
-   `external` **(å¤–éƒ¨)**ï¼šåªæœ‰**å…¶ä»–åˆçº¦**å’Œ**è´¦å·**å¯ä»¥è°ƒç”¨ï¼ˆåˆçº¦å†…éƒ¨ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œå¿…é¡»ç”¨ç‰¹æ®Šæ‰‹æ®µï¼‰ã€‚
    

**çŠ¶æ€å˜é‡çš„å¯è§æ€§ï¼š**

-   å¯ä»¥æ˜¯ `public`, `private`, æˆ– `internal`ã€‚
    
-   **æ³¨æ„ï¼š** çŠ¶æ€å˜é‡**ä¸èƒ½**å®šä¹‰ä¸º `external`ã€‚
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Base {
    // ã€Private / ç§æœ‰ã€‘
    // æƒé™ï¼šä»…é™æœ¬åˆçº¦å†…éƒ¨ã€‚
    // é™åˆ¶ï¼šç»§æ‰¿äº†è¿™ä¸ªåˆçº¦çš„å­åˆçº¦ï¼ˆChildï¼‰ä¹Ÿæ— æ³•è°ƒç”¨å®ƒã€‚
    function privateFunc() private pure returns (string memory) {
        return "private function called";
    }

    // æœ¬åˆçº¦å†…éƒ¨å¯ä»¥è°ƒç”¨ private å‡½æ•°
    function testPrivateFunc() public pure returns (string memory) {
        return privateFunc();
    }

    // ã€Internal / å†…éƒ¨ã€‘
    // æƒé™ï¼šæœ¬åˆçº¦å†…éƒ¨ + å­åˆçº¦å†…éƒ¨ã€‚
    // ç±»ä¼¼äº Java/C++ ä¸­çš„ protectedã€‚
    function internalFunc() internal pure returns (string memory) {
        return "internal function called";
    }

    function testInternalFunc() public pure virtual returns (string memory) {
        return internalFunc();
    }

    // ã€Public / å…¬å¼€ã€‘
    // æƒé™ï¼šæ‰€æœ‰äººã€‚å†…éƒ¨ã€å­åˆçº¦ã€å¤–éƒ¨è´¦å·ã€å¤–éƒ¨åˆçº¦éƒ½èƒ½è°ƒã€‚
    // å¦‚æœæ˜¯çŠ¶æ€å˜é‡è®¾ä¸º publicï¼ŒSolidity ä¼šè‡ªåŠ¨ä¸ºä½ ç”Ÿæˆä¸€ä¸ª getter å‡½æ•°ã€‚
    function publicFunc() public pure returns (string memory) {
        return "public function called";
    }

    // ã€External / å¤–éƒ¨ã€‘
    // æƒé™ï¼šä»…é™å¤–éƒ¨è°ƒç”¨ã€‚
    // åœºæ™¯ï¼šé€šå¸¸ç”¨äºåªç»™ç”¨æˆ·è°ƒç”¨çš„æ¥å£ï¼Œçœ Gasï¼ˆå‚æ•°ç›´æ¥ä» calldata è¯»ï¼Œä¸å¤åˆ¶åˆ° memoryï¼‰ã€‚
    function externalFunc() external pure returns (string memory) {
        return "external function called";
    }

    // âŒ ç¼–è¯‘é”™è¯¯æ¼”ç¤ºï¼š
    // è¿™æ˜¯ä¸€ä¸ª public å‡½æ•°ï¼ˆå±äºå†…éƒ¨è°ƒç”¨çš„ä¸€ç§ï¼‰ï¼Œå®ƒä¸èƒ½ç›´æ¥è°ƒç”¨ external å‡½æ•°ã€‚
    // function testExternalFunc() public pure returns (string memory) {
    //     return externalFunc(); // æŠ¥é”™ï¼
    //     // ä¿®æ­£æ–¹æ³•ï¼šä½¿ç”¨ this.externalFunc() å‘èµ·ä¸€ä¸ªå¤–éƒ¨è°ƒç”¨ï¼ˆæè´¹ Gasï¼Œä¸æ¨èï¼‰
    // }

    // ã€çŠ¶æ€å˜é‡ã€‘
    string private privateVar = "my private variable";
    string internal internalVar = "my internal variable";
    string public publicVar = "my public variable";

    // âŒ é”™è¯¯ï¼šçŠ¶æ€å˜é‡ä¸èƒ½æ˜¯ external
    // string external externalVar = "my external variable";
}

contract Child is Base {
    // âŒ é”™è¯¯æ¼”ç¤ºï¼š
    // å­åˆçº¦æ— æ³•è®¿é—®çˆ¶åˆçº¦çš„ private å‡½æ•°æˆ–å˜é‡
    // function testPrivateFunc() public pure returns (string memory) {
    //     return privateFunc();
    // }

    // âœ… æ­£ç¡®ï¼š
    // å­åˆçº¦å¯ä»¥è®¿é—®çˆ¶åˆçº¦çš„ internal å‡½æ•°
    function testInternalFunc() public pure override returns (string memory) {
        return internalFunc();
    }
}
```

è¯¯åŒº 1ï¼š`private` çš„æ•°æ®æ˜¯ä¿å¯†çš„å—ï¼Ÿ

**ç»å¯¹ä¸æ˜¯ï¼** åœ¨åŒºå—é“¾ä¸Šï¼Œ`private` åªæ˜¯**ä»£ç å±‚é¢çš„è®¿é—®é™åˆ¶**ã€‚

-   **ä»£ç é™åˆ¶ï¼š** åˆ«çš„åˆçº¦å†™ä»£ç è°ƒä¸åˆ°ä½ çš„ `private` å˜é‡ã€‚
    
-   **æ•°æ®å…¬å¼€ï¼š** é»‘å®¢ã€æ™®é€šç”¨æˆ·é€šè¿‡åŒºå—é“¾æµè§ˆå™¨ã€æˆ–è€…ç›´æ¥è¯»å–èŠ‚ç‚¹çš„ Storage æ§½ä½ï¼Œ**å¯ä»¥è½»è€Œæ˜“ä¸¾åœ°è¯»å‡º** `private` **å˜é‡çš„å€¼**ã€‚
    
-   **è­¦ç¤ºï¼š** æ°¸è¿œä¸è¦ç”¨ `private` å˜é‡å­˜å¯†ç ã€ç§é’¥ï¼
    

è¯¯åŒº 2ï¼š`public` å’Œ `external` æ€ä¹ˆé€‰ï¼Ÿ

-   å¦‚æœä½ çš„å‡½æ•°**åªä¼šè¢«å¤–éƒ¨**ï¼ˆç”¨æˆ·æˆ–åˆ«çš„åˆçº¦ï¼‰è°ƒç”¨ï¼Œè‡ªå·±åˆçº¦å†…éƒ¨ä¸è°ƒï¼Œ**è¯·åŠ¡å¿…ç”¨** `external`ã€‚
    
-   **åŸå› ï¼š** å¤„ç†å¤§æ•°ç»„å‚æ•°æ—¶ï¼Œ`external` ç›´æ¥ä» Calldataï¼ˆåŸå§‹æ•°æ®åŒºï¼‰è¯»å–ï¼Œè€Œ `public` éœ€è¦æŠŠæ•°æ®ä» Calldata å¤åˆ¶åˆ° Memoryï¼ˆå†…å­˜åŒºï¼‰ã€‚`external` **æ›´çœ Gasã€‚**
    

è¯¯åŒº 3ï¼šçŠ¶æ€å˜é‡é»˜è®¤æ˜¯ä»€ä¹ˆï¼Ÿ

å¦‚æœä½ å†™ `uint256 x;` æ²¡åŠ ä¿®é¥°ç¬¦ï¼š

-   **çŠ¶æ€å˜é‡** é»˜è®¤ä¸º `internal`ã€‚
    
-   **å‡½æ•°** æ²¡æœ‰é»˜è®¤å€¼ï¼Œå¿…é¡»æ˜¾å¼å£°æ˜å¯è§æ€§ï¼ˆSolidity 0.5.0 ä¹‹åçš„å¼ºåˆ¶è¦æ±‚ï¼‰ã€‚
    

### Interface æ¥å£

-   ä¸èƒ½åŒ…å«ä»»ä½•å‡½æ•°å®ç°ï¼ˆåªæœ‰å‡½æ•°åã€å‚æ•°ã€è¿”å›å€¼ï¼Œæ²¡æœ‰å¤§æ‹¬å· `{...}` é‡Œçš„é€»è¾‘ï¼‰ã€‚
    
-   å¯ä»¥ç»§æ‰¿å…¶ä»–çš„æ¥å£ï¼ˆæ¥å£ä¹Ÿèƒ½æœ‰çˆ¶æ¥å£ï¼‰ã€‚
    
-   æ‰€æœ‰å£°æ˜çš„å‡½æ•°å¿…é¡»æ˜¯ `external` çš„ï¼ˆå› ä¸ºæ¥å£æœ¬æ¥å°±æ˜¯ç»™å¤–éƒ¨ç”¨çš„ï¼‰ã€‚
    
-   ä¸èƒ½å£°æ˜æ„é€ å‡½æ•°ï¼ˆå› ä¸ºå®ƒåªæ˜¯ä¸ªå¤–å£³ï¼Œä¸éœ€è¦éƒ¨ç½²åˆå§‹åŒ–ï¼‰ã€‚
    
-   ä¸èƒ½å£°æ˜çŠ¶æ€å˜é‡ï¼ˆå®ƒä¸å­˜æ•°æ®ï¼Œåªå®šä¹‰è¡Œä¸ºï¼‰ã€‚
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// 1. ç›®æ ‡åˆçº¦ï¼šè¿™æ˜¯çœŸæ­£å¹²æ´»çš„åˆçº¦
contract Counter {
    uint256 public count;

    function increment() external {
        count += 1;
    }
}

// 2. æ¥å£å®šä¹‰ï¼šè¿™æ˜¯ Counter åˆçº¦çš„â€œè¯´æ˜ä¹¦â€
// æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“ increment é‡Œé¢å…·ä½“æ˜¯æ€ä¹ˆå†™çš„ï¼ˆæ˜¯ +=1 è¿˜æ˜¯ +=10ï¼‰ï¼Œ
// æˆ‘ä»¬åªéœ€è¦çŸ¥é“å®ƒå«ä»€ä¹ˆåå­—ï¼Œæ€ä¹ˆè°ƒç”¨ã€‚
interface ICounter {
    // å¯¹åº” Counter ä¸­çš„ public count å˜é‡
    // (Public å˜é‡ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŒåçš„ getter å‡½æ•°)
    function count() external view returns (uint256);

    // å¯¹åº” Counter ä¸­çš„ increment å‡½æ•°
    function increment() external;
}

// 3. è°ƒç”¨è€…åˆçº¦
contract MyContract {
    // ä¼ å…¥ç›®æ ‡åˆçº¦çš„åœ°å€ _counter
    function incrementCounter(address _counter) external {
        // ã€å…³é”®è¯­æ³•ã€‘: ICounter(_counter)
        // æ„æ€æ˜¯ï¼šæŠŠè¿™ä¸ªåœ°å€ (_counter) å½“ä½œ ICounter æ¥å£æ¥çœ‹å¾…ã€‚
        // ç„¶åè°ƒç”¨å®ƒçš„ increment() æŒ‰é’®ã€‚
        ICounter(_counter).increment();
    }

    function getCount(address _counter) external view returns (uint256) {
        // åŒæ ·ï¼ŒæŠŠåœ°å€åŒ…è£…æˆæ¥å£ï¼Œè°ƒç”¨ count() è¯»å–æ•°æ®
        return ICounter(_counter).count();
    }
}

// Uniswap å·¥å‚åˆçº¦çš„æ¥å£
// ä½œç”¨ï¼šé€šè¿‡ä¸¤ä¸ªä»£å¸åœ°å€ï¼Œæ‰¾åˆ°å®ƒä»¬å¯¹åº”çš„äº¤æ˜“å¯¹(Pair)åœ°å€
interface UniswapV2Factory {
    function getPair(address tokenA, address tokenB)
        external
        view
        returns (address pair);
}

// Uniswap äº¤æ˜“å¯¹åˆçº¦çš„æ¥å£
// ä½œç”¨ï¼šæŸ¥è¯¢è¿™ä¸ªæ± å­é‡Œæœ‰å¤šå°‘å¸ï¼ˆæµåŠ¨æ€§å‚¨å¤‡ï¼‰
interface UniswapV2Pair {
    function getReserves()
        external
        view
        returns (uint112 reserve0, uint112 reserve1, uint32 blockTimestampLast);
}

contract UniswapExample {
    // è¿™äº›æ˜¯ Ethereum ä¸»ç½‘ä¸ŠçœŸå®çš„åˆçº¦åœ°å€
    address private factory = 0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f;
    address private dai = 0x6B175474E89094C44Da98b954EedeAC495271d0F;
    address private weth = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;

    function getTokenReserves() external view returns (uint256, uint256) {
        // ç¬¬ä¸€æ­¥ï¼šé—® Factoryï¼Œâ€œDAI å’Œ WETH çš„äº¤æ˜“æ± åœ°å€åœ¨å“ªï¼Ÿâ€
        // è¯­æ³•ï¼šæ¥å£å(åˆçº¦åœ°å€).å‡½æ•°å(å‚æ•°)
        address pair = UniswapV2Factory(factory).getPair(dai, weth);

        // ç¬¬äºŒæ­¥ï¼šé—® Pair åˆçº¦ï¼Œâ€œä½ æ± å­é‡Œç°åœ¨æœ‰å¤šå°‘ DAI å’Œ WETHï¼Ÿâ€
        // è¯­æ³•ï¼š(è¿”å›å€¼1, è¿”å›å€¼2, å¿½ç•¥çš„å€¼) = æ¥å£è°ƒç”¨()
        (uint256 reserve0, uint256 reserve1,) = UniswapV2Pair(pair).getReserves();
        // æ³¨æ„ä¸Šé¢é‚£ä¸ªé€—å· ","ï¼Œè¡¨ç¤ºæˆ‘ä»¬ä¸éœ€è¦ç¬¬ä¸‰ä¸ªè¿”å›å€¼ (æ—¶é—´æˆ³)ï¼Œç›´æ¥ä¸¢å¼ƒ
        return (reserve0, reserve1);
    }
}
```

### Payable

å£°æ˜ä¸º `payable` çš„å‡½æ•°å’Œåœ°å€å¯ä»¥æ¥æ”¶ `ether` è¿›å…¥åˆçº¦ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Payable {
    // ã€å¯æ”¯ä»˜åœ°å€ã€‘
    // åªæœ‰æ ‡è®°ä¸º address payable çš„å˜é‡ï¼Œæ‰èƒ½ä½¿ç”¨ .transfer() æˆ– .send() æ–¹æ³•ç»™å®ƒè½¬è´¦
    address payable public owner;

    // ã€å¯æ”¯ä»˜æ„é€ å‡½æ•°ã€‘
    // åŠ ä¸Š payableï¼Œæ„å‘³ç€ä½ åœ¨éƒ¨ç½²åˆçº¦çš„é‚£ä¸€åˆ»ï¼Œå°±å¯ä»¥å¾€åˆçº¦é‡Œå­˜å…¥ä¸€ç¬”åˆå§‹èµ„é‡‘
    constructor() payable {
        // msg.sender æ˜¯éƒ¨ç½²è€…ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒå¼ºåˆ¶è½¬æ¢ä¸º payable ç±»å‹å­˜èµ·æ¥
        owner = payable(msg.sender);
    }

    // ã€å­˜æ¬¾å‡½æ•°ã€‘
    // è¿™ä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶ä»¥å¤ªå¸ (Ether)ã€‚
    // è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œé™„å¸¦å‘é€ä¸€äº› Etherï¼Œåˆçº¦çš„ä½™é¢ä¼šè‡ªåŠ¨æ›´æ–°ã€‚
    // å‡½æ•°ä½“æ˜¯ç©ºçš„ {}ï¼Œä½†è¿™æ²¡å…³ç³»ï¼ŒSolidity å¼•æ“ä¼šè‡ªåŠ¨å¤„ç†è®°è´¦ã€‚
    function deposit() public payable {}

    // ã€éæ”¯ä»˜å‡½æ•°ã€‘
    // å¦‚æœä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„åŒæ—¶å°è¯•å‘é€ Etherï¼Œäº¤æ˜“ä¼šç›´æ¥å¤±è´¥ (Revert)ã€‚
    // å› ä¸ºå®ƒæ²¡æœ‰ payable æ ‡ç­¾ã€‚
    function notPayable() public {}

    // ã€ææ¬¾å‡½æ•°ã€‘
    // å°†åˆçº¦é‡Œæ‰€æœ‰çš„ Ether å–å‡ºæ¥å‘ç»™ owner
    function withdraw() public {
        // è·å–å½“å‰åˆçº¦é‡Œçš„ä½™é¢ (address(this).balance)
        uint256 amount = address(this).balance;

        // å‘é€ Ether ç»™ owner
        // è¿™æ˜¯ç›®å‰æ¨èçš„è½¬è´¦å†™æ³•ï¼šcall{value: ...}("")
        (bool success,) = owner.call{value: amount}("");
        require(success, "Failed to send Ether");
    }

    // ã€è½¬è´¦å‡½æ•°ã€‘
    // ä»åˆçº¦è½¬é’±ç»™æŒ‡å®šçš„æŸä¸ªåœ°å€
    function transfer(address payable _to, uint256 _amount) public {
        // æ³¨æ„ï¼šå‚æ•° _to å¿…é¡»å£°æ˜ä¸º payableï¼Œå¦åˆ™ä¸èƒ½ç»™å®ƒè½¬è´¦
        (bool success,) = _to.call{value: _amount}("");
        require(success, "Failed to send Ether");
    }
}
```

### Sending Ether: Transfer, Send, Call

You can send Ether to other contracts by

-   `transfer` (2300 gas, throws error)
    
-   `send` (2300 gas, returns bool)
    
-   `call` (forward all gas or set gas, returns bool)
    

**How to send Ether? (å¦‚ä½•å‘é€ï¼Ÿ)** ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å‘é€ ETH ç»™å…¶ä»–åˆçº¦ï¼š

1.  `transfer`: é™åˆ¶ **2300 gas**ï¼Œå¤±è´¥æ—¶ç›´æ¥**æŠ›å‡ºå¼‚å¸¸ (revert)**ã€‚ï¼ˆå·²è¿‡æ—¶ï¼Œä¸æ¨èï¼‰
    
2.  `send`: é™åˆ¶ **2300 gas**ï¼Œå¤±è´¥æ—¶**è¿”å›** `false`ï¼ˆä¸ä¼šè‡ªåŠ¨ revertï¼‰ã€‚ï¼ˆå·²è¿‡æ—¶ï¼Œä¸æ¨èï¼‰
    
3.  `call`: **è½¬å‘å‰©ä½™æ‰€æœ‰ gas**ï¼ˆæˆ–è€…ä½ å¯ä»¥æŒ‡å®š gasï¼‰ï¼Œå¤±è´¥æ—¶**è¿”å›** `false`ã€‚ï¼ˆ**å½“å‰æ¨èçš„æ ‡å‡†åšæ³•**ï¼‰
    

**How to receive Ether? (å¦‚ä½•æ¥æ”¶ï¼Ÿ)** ä¸€ä¸ªåˆçº¦æƒ³è¦æ¥æ”¶ ETHï¼Œå¿…é¡»è‡³å°‘åŒ…å«ä»¥ä¸‹å‡½æ•°ä¹‹ä¸€ï¼š

-   `receive() external payable`
    
-   `fallback() external payable`
    

**é€»è¾‘åˆ¤æ–­ï¼š** å¦‚æœ `msg.data` ä¸ºç©ºï¼Œä¼˜å…ˆè°ƒç”¨ `receive()`ï¼›å¦åˆ™ï¼ˆæˆ–è€… `receive` ä¸å­˜åœ¨æ—¶ï¼‰ï¼Œè°ƒç”¨ `fallback()`ã€‚

**Which method should you use? (åº”è¯¥ç”¨å“ªä¸ªï¼Ÿ)**

-   **è‡ª 2019 å¹´ 12 æœˆèµ·ï¼Œæ¨èä½¿ç”¨** `call` **ä¸é‡å…¥ä¿æŠ¤æœºåˆ¶ç»“åˆä½¿ç”¨ã€‚**
    
-   **é€šè¿‡é‡å…¥ä¿æŠ¤æœºåˆ¶æ¥é˜²èŒƒé‡å…¥æ”»å‡»ã€‚**
    
    -   **åœ¨è¿›è¡Œå…¶ä»–åˆçº¦è°ƒç”¨ä¹‹å‰è¿›è¡Œæ‰€æœ‰çŠ¶æ€å˜æ›´**
        
    -   ä½¿ç”¨ `nonReentrant` é‡å…¥ä¿æŠ¤ä¿®é¥°ç¬¦ã€‚
        

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// å¼•å…¥ Solady åº“ï¼ˆè¿™æ˜¯ä¸€ä¸ªè¿½æ±‚æè‡´ Gas ä¼˜åŒ–çš„åº“ï¼Œæ¯” OpenZeppelin æ›´çœé’±ï¼‰
import {SafeTransferLib} from "@solady/utils/SafeTransferLib.sol";

// =====================
// 1. æ¥æ”¶ ETH çš„åˆçº¦
// =====================
contract ReceiveEther {
    /*
    æ¥æ”¶é€»è¾‘å›¾ï¼š
                 å‘é€ Ether
                    |
              msg.data ä¸ºç©º?
                 /      \
               æ˜¯        å¦
              /           \
        receive()å­˜åœ¨?   fallback()
           /     \
          æ˜¯      å¦
         /         \
    receive()    fallback()
    */

    // æƒ…å†µ A: çº¯è½¬è´¦ï¼Œmsg.data ä¸ºç©º
    receive() external payable {}

    // æƒ…å†µ B: msg.data ä¸ä¸ºç©ºï¼Œæˆ–è€… receive ä¸å­˜åœ¨
    fallback() external payable {}

    function getBalance() public view returns (uint256) {
        return address(this).balance;
    }
}

// =====================
// 2. å‘é€ ETH çš„åˆçº¦
// =====================
contract SendEther {
    // ã€æµæ´¾ 1: Transfer (ä¸æ¨è)ã€‘
    // ç‰¹ç‚¹ï¼šè‡ªå¸¦ 2300 gas é™åˆ¶ã€‚
    // ç¼ºç‚¹ï¼šå¦‚æœç›®æ ‡åˆçº¦çš„ receive å‡½æ•°é€»è¾‘ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼ˆæ¶ˆè€—è¶…è¿‡ 2300 gasï¼‰ï¼Œè½¬è´¦å°±ä¼šå¤±è´¥ã€‚
    // è¿™ç§â€œå†™æ­» Gasâ€çš„åšæ³•åœ¨ä»¥å¤ªåŠå‡çº§åå¾ˆå®¹æ˜“å‡ºé—®é¢˜ã€‚
    function sendViaTransfer(address payable _to) public payable {
        _to.transfer(msg.value);
    }

    // ã€æµæ´¾ 2: Send (ä¸æ¨è)ã€‘
    // ç‰¹ç‚¹ï¼šè‡ªå¸¦ 2300 gas é™åˆ¶ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚
    // ç¼ºç‚¹ï¼šä½ éœ€è¦æ‰‹åŠ¨å¤„ç†å¤±è´¥æƒ…å†µ (require)ï¼Œä¸”åŒæ ·å— Gas é™åˆ¶å›°æ‰°ã€‚
    function sendViaSend(address payable _to) public payable {
        bool sent = _to.send(msg.value);
        require(sent, "Failed to send Ether");
    }

    // ã€æµæ´¾ 3: Call (å®˜æ–¹æ¨è)ã€‘
    // ç‰¹ç‚¹ï¼šè½¬å‘æ‰€æœ‰å‰©ä½™ Gasï¼Œè¿”å›å¸ƒå°”å€¼å’Œæ•°æ®ã€‚
    // ä¼˜ç‚¹ï¼šæœ€çµæ´»ï¼Œå…¼å®¹æ€§æœ€å¥½ï¼ˆç‰¹åˆ«æ˜¯åƒ Gnosis Safe è¿™ç§æ™ºèƒ½åˆçº¦é’±åŒ…ï¼Œå¾€å¾€éœ€è¦æ¶ˆè€—æ›´å¤š Gas æ‰èƒ½æ”¶é’±ï¼‰ã€‚
    // é£é™©ï¼šå› ä¸ºè½¬å‘äº†æ‰€æœ‰ Gasï¼Œå¯¹æ–¹å¯èƒ½ä¼šåˆ©ç”¨å‰©ä½™ Gas å›å¤´æ”»å‡»ä½ ï¼ˆé‡å…¥æ”»å‡»ï¼‰ã€‚æ‰€ä»¥å¿…é¡»é…åˆâ€œé‡å…¥é”â€ä½¿ç”¨ã€‚
    function sendViaCall(address payable _to) public payable {
        // è¯­æ³•ï¼šåœ°å€.call{value: é‡‘é¢}("")
        (bool sent, bytes memory data) = _to.call{value: msg.value}("");
        require(sent, "Failed to send Ether");
    }

    // ã€æµæ´¾ 4: Solady (é«˜æ‰‹ä¸“ç”¨)ã€‘
    // ä½¿ç”¨ Solady çš„ SafeTransferLib
    // ä¼˜ç‚¹ï¼šæ¯”åŸç”Ÿçš„ .call å†™æ³•è¿˜è¦çœ Gasï¼ˆçº¦ 0.36%ï¼‰ï¼Œä¸”ä»£ç æ›´ç®€æ´ã€‚
    // å®ƒåœ¨åº•å±‚ç”¨æ±‡ç¼– (Yul) å¤„ç†äº†è¿”å›å€¼æ£€æŸ¥ã€‚
    function sendViaSolady(address payable _to) public payable {
        // å¦‚æœå¤±è´¥ï¼Œä¼šè‡ªåŠ¨ Revert å¹¶æŠ›å‡º ETHTransferFailed é”™è¯¯
        SafeTransferLib.safeTransferETH(_to, msg.value);
    }
}
```

### Fallback å›é€€å‡½æ•°

`fallback` **æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œå®ƒä¼šåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µè¢«æ‰§è¡Œï¼š**

1.  **è°ƒç”¨äº†ä¸å­˜åœ¨çš„å‡½æ•°ï¼š** åˆ«äººå‘æ¥ä¸€ä¸ªæŒ‡ä»¤ï¼Œä½†åˆçº¦é‡Œæ²¡æœ‰åŒ¹é…çš„å‡½æ•°åã€‚
    
2.  **ç›´æ¥å‘ ETH ä¸”æ— æ³•ç”±** `receive` **å¤„ç†ï¼š**
    
    1.  åˆ«äººç›´æ¥è½¬è´¦ï¼Œä½†åˆçº¦é‡Œæ²¡å†™ `receive()` å‡½æ•°ï¼›
        
    2.  **æˆ–è€…** åˆ«äººè½¬è´¦çš„åŒæ—¶è¿˜å¸¦äº†æ•°æ® (`msg.data` ä¸ä¸ºç©º)ã€‚
        

**Gas é™åˆ¶ï¼š** å½“ä½¿ç”¨ `transfer` æˆ– `send` è°ƒç”¨ `fallback` æ—¶ï¼Œå®ƒåªæœ‰ **2300 gas** çš„é™åˆ¶ï¼ˆè¿™éå¸¸å°‘ï¼Œåªèƒ½åšæœ€ç®€å•çš„æ—¥å¿—è®°å½•ï¼Œè¿å†™å…¥çŠ¶æ€å˜é‡éƒ½ä¸å¤Ÿï¼‰ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Fallback {
    event Log(string func, uint256 gas);

    // ã€Fallback å‡½æ•°ã€‘
    // å¿…é¡»å£°æ˜ä¸º externalã€‚
    // å¦‚æœæƒ³è®©å®ƒèƒ½æ¥æ”¶ä»¥å¤ªå¸ï¼Œå¿…é¡»åŠ  payableã€‚
    fallback() external payable {
        // è¿™é‡Œçš„ gasleft() å¯ä»¥è®©æˆ‘ä»¬çœ‹åˆ°è¿˜å‰©å¤šå°‘ Gasã€‚
        // - å¦‚æœæ˜¯ç”¨ transfer/send è°ƒç”¨çš„ï¼šè¿™é‡Œå‰©ä½™ Gas å¾ˆå°‘ï¼ˆçº¦ 2300ï¼‰ã€‚
        // - å¦‚æœæ˜¯ç”¨ call è°ƒç”¨çš„ï¼šè¿™é‡Œå‰©ä½™ Gas å¾ˆå¤šï¼ˆå‡ ä¹å…¨éƒ¨ï¼‰ã€‚
        emit Log("fallback", gasleft());
    }

    // ã€Receive å‡½æ•°ã€‘
    // ä¸“é—¨ç”¨äºæ¥æ”¶çº¯ ETH è½¬è´¦ï¼ˆmsg.data ä¸ºç©ºæ—¶è§¦å‘ï¼‰ã€‚
    receive() external payable {
        emit Log("receive", gasleft());
    }

    // è¾…åŠ©å‡½æ•°ï¼šæŸ¥çœ‹åˆçº¦ä½™é¢
    function getBalance() public view returns (uint256) {
        return address(this).balance;
    }
}

contract SendToFallback {
    // ä½¿ç”¨ transfer å‘é€ ETH
    function transferToFallback(address payable _to) public payable {
        // ã€å…³é”®ç‚¹ã€‘
        // transfer è‡ªå¸¦ 2300 gas é™åˆ¶ã€‚
        // å¦‚æœç›®æ ‡åˆçº¦çš„ fallback/receive é€»è¾‘å¤ªå¤æ‚ï¼ˆæ¯”å¦‚å†™å…¥äº† Storageï¼‰ï¼Œ
        // æ¶ˆè€—è¶…è¿‡äº† 2300ï¼Œè¿™ç¬”äº¤æ˜“ä¼šç›´æ¥å¤±è´¥ (Revert)ã€‚
        _to.transfer(msg.value);
    }

    // ä½¿ç”¨ call å‘é€ ETH
    function callFallback(address payable _to) public payable {
        // ã€å…³é”®ç‚¹ã€‘
        // call ä¼šè½¬å‘æ‰€æœ‰å‰©ä½™çš„ Gasã€‚
        // è¿™æ˜¯æ¨èçš„å‘é€æ–¹å¼ï¼Œå› ä¸ºå®ƒå…è®¸ç›®æ ‡åˆçº¦æ‰§è¡Œå¤æ‚çš„é€»è¾‘ã€‚
        (bool sent,) = _to.call{value: msg.value}("");
        require(sent, "Failed to send Ether");
    }
}
```

### Call è°ƒç”¨

`call` **æ˜¯ä¸€ä¸ªç”¨äºä¸å…¶ä»–æ™ºèƒ½åˆçº¦äº¤äº’çš„ä½çº§å‡½æ•°ã€‚**

-   **æ¨èåœºæ™¯ï¼š** å½“ä½ ä»…ä»…æ˜¯æƒ³å‘é€ ETHï¼ˆè§¦å‘å¯¹æ–¹çš„ `fallback` æˆ– `receive` å‡½æ•°ï¼‰æ—¶ï¼Œè¿™æ˜¯æ¨èçš„æ–¹æ³•ã€‚
    
-   **ä¸æ¨èåœºæ™¯ï¼š** è¿™é€šå¸¸**ä¸æ˜¯**è°ƒç”¨ç°æœ‰ï¼ˆå·²çŸ¥ï¼‰å‡½æ•°çš„æ¨èæ–¹å¼ã€‚
    

**ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨ä½çº§ call æ¥è°ƒç”¨å‡½æ•°ï¼Ÿ**

1.  **Reverts are not bubbled up (å¼‚å¸¸ä¸å†’æ³¡):** å¦‚æœç›®æ ‡åˆçº¦æŠ¥é”™äº†ï¼ˆrevertï¼‰ï¼Œè°ƒç”¨è€…åˆçº¦**ä¸ä¼š**è‡ªåŠ¨æŠ¥é”™åœæ­¢ï¼Œå®ƒåªä¼šæ”¶åˆ°ä¸€ä¸ª `false` çš„è¿”å›å€¼ã€‚ä½ éœ€è¦æ‰‹åŠ¨å†™ä»£ç å»æ£€æŸ¥è¿™ä¸ªå¤±è´¥ã€‚
    
2.  **Type checks are bypassed (è·³è¿‡ç±»å‹æ£€æŸ¥):** ç¼–è¯‘å™¨ä¸ä¼šå¸®ä½ æ£€æŸ¥å‚æ•°ç±»å‹æ˜¯å¦åŒ¹é…ï¼ˆæ¯”å¦‚ä½ ä¼ äº† `uint` ç»™ `string`ï¼Œç¼–è¯‘æ—¶ä¸æŠ¥é”™ï¼Œè¿è¡Œæ—¶æ‰å‡ºé”™ï¼‰ã€‚
    
3.  **Function existence checks are omitted (çœç•¥å‡½æ•°å­˜åœ¨æ€§æ£€æŸ¥):** å¦‚æœä½ è°ƒç”¨çš„å‡½æ•°æ ¹æœ¬ä¸å­˜åœ¨ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ç®¡ï¼Œä¾ç„¶ä¼šå‘é€äº¤æ˜“ï¼Œé€šå¸¸ä¼šè§¦å‘å¯¹æ–¹çš„ `fallback`ã€‚
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Receiver {
    event Received(address caller, uint256 amount, string message);

    // å¦‚æœæœ‰äººçè°ƒå‡½æ•°ï¼ˆå‡½æ•°åå¯¹ä¸ä¸Šï¼‰ï¼Œæˆ–è€…åªå‘é’±ä¸å¸¦æ•°æ®ï¼Œå°±è¿›è¿™é‡Œ
    fallback() external payable {
        emit Received(msg.sender, msg.value, "Fallback was called");
    }

    // è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„ä¸šåŠ¡å‡½æ•°
    function foo(string memory _message, uint256 _x)
        public
        payable
        returns (uint256)
    {
        emit Received(msg.sender, msg.value, _message);
        return _x + 1;
    }
}

contract Caller {
    event Response(bool success, bytes data);

    // å‡è®¾ Caller æ²¡æœ‰ Receiver çš„æºä»£ç ï¼ˆä¹Ÿå°±æ— æ³•ä½¿ç”¨æ¥å£ Interfaceï¼‰ï¼Œ
    // ä½†æˆ‘ä»¬çŸ¥é“ Receiver çš„åœ°å€ï¼Œä»¥åŠæˆ‘ä»¬è¦è°ƒç”¨çš„å‡½æ•°åå« "foo"ã€‚
    function testCallFoo(address payable _addr) public payable {
        // ã€æ ¸å¿ƒè¯­æ³•ã€‘
        // 1. {value: ..., gas: ...} : è‡ªå®šä¹‰å‘é€çš„ ETH é‡‘é¢å’Œ Gas é™åˆ¶
        // 2. abi.encodeWithSignature(...) : å°†å‡½æ•°åå’Œå‚æ•°æ‰‹åŠ¨æ‰“åŒ…æˆäºŒè¿›åˆ¶æ•°æ®
        (bool success, bytes memory data) = _addr.call{
            value: msg.value,
            gas: 5000
        }(abi.encodeWithSignature("foo(string,uint256)", "call foo", 123));
        
        // æ³¨æ„ï¼šabi.encodeWithSignature å¯¹ç©ºæ ¼éå¸¸æ•æ„Ÿï¼
        // "foo(string, uint256)" âŒ (é€—å·åæœ‰ç©ºæ ¼ï¼Œä¼šå¯¼è‡´è®¡ç®—å‡ºçš„ Hash ä¸å¯¹)
        // "foo(string,uint256)" âœ… (å¿…é¡»ç´§å‡‘)

        emit Response(success, data);
    }

    // æ¼”ç¤ºè°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°
    function testCallDoesNotExist(address payable _addr) public payable {
        // è¯•å›¾è°ƒç”¨ "doesNotExist()"
        (bool success, bytes memory data) = _addr.call{value: msg.value}(
            abi.encodeWithSignature("doesNotExist()")
        );

        // ç»“æœï¼š
        // success ä¼šæ˜¯ true (åªè¦å¯¹æ–¹æ²¡ revert)
        // å¯¹æ–¹åˆçº¦ä¼šè§¦å‘ fallback å‡½æ•°
        emit Response(success, data);
    }
}
```

### Delegatecall å§”æ‰˜è°ƒç”¨

`delegatecall` æ˜¯ä¸€ä¸ªç±»ä¼¼äº `call` çš„ä½çº§å‡½æ•°ã€‚

å½“åˆçº¦ A å¯¹åˆçº¦ B æ‰§è¡Œ `delegatecall` æ—¶ï¼Œ**B çš„ä»£ç **ä¼šè¢«æ‰§è¡Œï¼Œä½†æ˜¯æ˜¯åœ¨ **A çš„ä¸Šä¸‹æ–‡**ä¸­æ‰§è¡Œçš„ã€‚ è¿™æ„å‘³ç€ï¼š

1.  ä¿®æ”¹çš„æ˜¯ **A çš„ Storage (å­˜å‚¨)**ã€‚
    
2.  `msg.sender` ä¾ç„¶æ˜¯ **è§¦å‘ A çš„é‚£ä¸ªåŸå§‹è°ƒç”¨è€…**ï¼ˆè€Œä¸æ˜¯ Aï¼‰ã€‚
    
3.  `msg.value` ä¾ç„¶æ˜¯ **åŸå§‹äº¤æ˜“å‘é€çš„é‡‘é¢**ã€‚
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// æ³¨æ„ï¼šå…ˆéƒ¨ç½²è¿™ä¸ªåˆçº¦ (é€»è¾‘åˆçº¦ / è€å¸ˆ)
contract B {
    // æ³¨æ„ï¼šè¿™é‡Œçš„å­˜å‚¨å¸ƒå±€å¿…é¡»å’Œåˆçº¦ A ä¸€æ¨¡ä¸€æ ·ï¼
    uint256 public num;
    address public sender;
    uint256 public value;

    function setVars(uint256 _num) public payable {
        // å½“ A delegatecall è¿™é‡Œæ—¶ï¼š
        // 1. num ä¿®æ”¹çš„æ˜¯ A çš„ num
        num = _num;
        // 2. sender æ˜¯è°ï¼Ÿæ˜¯è°ƒç”¨ A çš„é‚£ä¸ªäºº (user)ï¼Œè€Œä¸æ˜¯ A
        sender = msg.sender;
        // 3. value æ˜¯å¤šå°‘ï¼Ÿæ˜¯ user å‘ç»™ A çš„é’±
        value = msg.value;
    }
}

// è¿™æ˜¯ä¸€ä¸ªä»£ç†åˆçº¦ (Proxy / å­¦ç”Ÿ)
contract A {
    // å­˜å‚¨å¸ƒå±€å¿…é¡»å’Œ B ä¿æŒä¸€è‡´ (Slot 0, Slot 1, Slot 2)
    uint256 public num;
    address public sender;
    uint256 public value;

    function setVars(address _contract, uint256 _num) public payable {
        // ã€æ ¸å¿ƒä»£ç ã€‘
        // A è°ƒç”¨ B çš„ä»£ç ï¼Œä½†ä¿®æ”¹çš„æ˜¯ A è‡ªå·±çš„çŠ¶æ€
        (bool success, bytes memory data) = _contract.delegatecall(
            abi.encodeWithSignature("setVars(uint256)", _num)
        );
        // å¦‚æœæˆåŠŸï¼Œæ­¤æ—¶ A.num å˜äº†ï¼ŒA.sender å˜äº†ï¼Œä½† B çš„çŠ¶æ€çº¹ä¸ä¸åŠ¨ã€‚
    }
}
```

ä»£ç†è°ƒç”¨ä¼šäº§ç”Ÿé¢å¤– gas è´¹ç”¨

**åœ°å€è®¿é—®æˆæœ¬ (Address Access Cost - EIP-2929):**

-   **å†·åŠ è½½ (Cold Load):** å¦‚æœè¿™æ˜¯ä½ åœ¨æœ¬ç¬”äº¤æ˜“ä¸­ç¬¬ä¸€æ¬¡è®¿é—®é€»è¾‘åˆçº¦çš„åœ°å€ï¼Œéœ€è¦èŠ±è´¹çº¦ **2600 Gas**ã€‚
    
-   **çƒ­åŠ è½½ (Warm Load):** å¦‚æœè¿™ä¸ªåœ°å€åœ¨äº¤æ˜“ä¸­å·²ç»è¢«è®¿é—®è¿‡äº†ï¼ˆæˆ–è€…åœ¨é¢„çƒ­åˆ—è¡¨ä¸­ï¼‰ï¼Œåªéœ€è¦ **100 Gas**ã€‚
    
-   _æ³¨ï¼šåœ¨ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰ä¸­ï¼Œé€šå¸¸æ¯æ¬¡äº¤æ˜“åªè°ƒç”¨ä¸€æ¬¡é€»è¾‘åˆçº¦ï¼Œæ‰€ä»¥é€šå¸¸æ˜¯å†·åŠ è½½çš„ 2600 Gasã€‚_
    

**å†…å­˜æ‰©å±•ä¸æ•°æ®æ‹·è´ (Memory Expansion & Copying):**

-   ä½ éœ€è¦æŠŠå‚æ•°ä» Calldata æˆ– Memory å¤åˆ¶ä¸€ä»½ä¼ ç»™ `delegatecall`ã€‚
    
-   å¦‚æœæœ‰è¿”å›å€¼ï¼Œè¿˜éœ€è¦æŠŠè¿”å›å€¼å¤åˆ¶å›æ¥ã€‚
    
-   è¿™éƒ¨åˆ†å–å†³äºä½ çš„å‚æ•°æ•°æ®æœ‰å¤šå¤§ï¼ˆé€šå¸¸å‡ ååˆ°å‡ ç™¾ Gasï¼‰ã€‚
    

### Function Selector

å½“è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œ `calldata` çš„å‰ 4 ä¸ªå­—èŠ‚æŒ‡å®šè¦è°ƒç”¨çš„å‡½æ•°ã€‚

è¿™ 4 ä¸ªå­—èŠ‚ç§°ä¸ºå‡½æ•°é€‰æ‹©å™¨ã€‚

ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ã€‚å®ƒä½¿ç”¨ `call` åœ¨åœ°å€ `addr` çš„åˆçº¦ä¸Šæ‰§è¡Œ `transfer` ã€‚

```Solidity
addr.call(abi.encodeWithSignature("transfer(address,uint256)", 0xSomeAddress, 123))
```

ä» `abi.encodeWithSignature(....)` è¿”å›çš„å‰ 4 ä¸ªå­—èŠ‚æ˜¯å‡½æ•°é€‰æ‹©å™¨ã€‚

æˆ–è®¸å¯ä»¥åœ¨ä»£ç ä¸­é¢„è®¡ç®—å¹¶å†…è”å‡½æ•°é€‰æ‹©å™¨ï¼Œä»è€ŒèŠ‚çœä¸€ç‚¹ gasï¼Ÿ

**ä¼˜åŒ–å†™æ³• (çœ Gas):** æˆ‘ä»¬å·²ç»çŸ¥é“ `transfer` çš„é€‰æ‹©å™¨æ˜¯ `0xa9059cbb`ï¼Œç›´æ¥å†™æ­»å®ƒã€‚

ç›´æ¥ `abi.encodeWithSelector` ä¼ å…¥å‡½æ•°çš„é€‰æ‹©å™¨

```Solidity
addr.call(abi.encodeWithSelector(0xa9059cbb, recipient, amount));
```

å°±æ˜¯è¯´ï¼ŒencodeWithSelectorä¼šæŠŠå‡½æ•°åï¼Œæ¯”å¦‚è¯´"transfer(address,uint256)"ï¼Œç›´æ¥è½¬åŒ–ä¸ºä¸€ä¸ª4å­—èŠ‚çš„è¯†åˆ«ç ï¼Œç”¨äºæ‰¾åˆ°å¯¹åº”çš„å‡½æ•°

å½“ä½ å‘ä»¥å¤ªåŠç½‘ç»œå‘é€ä¸€ç¬”äº¤æ˜“å»è°ƒç”¨åˆçº¦å‡½æ•°æ—¶ï¼Œä½ å‘é€çš„æ•°æ®ï¼ˆInput Data / Calldataï¼‰å…¶å®æ˜¯ä¸€ä¸²é•¿é•¿çš„åå…­è¿›åˆ¶ç¼–ç ã€‚

**ç»“æ„å¦‚ä¸‹ï¼š**`[ 4å­—èŠ‚: å‡½æ•°é€‰æ‹©å™¨ ]` + `[ Nå­—èŠ‚: å‚æ•°ç¼–ç  ]`

### Calling Other Contract é«˜å±‚çº§è°ƒç”¨ (High-level Call

åˆçº¦å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è°ƒç”¨å…¶ä»–åˆçº¦ã€‚

æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç›´æ¥è°ƒç”¨ï¼Œä¾‹å¦‚ `A.foo(x, y, z)` ã€‚

å¦ä¸€ç§è°ƒç”¨å…¶ä»–åˆçº¦çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä½çº§åˆ«çš„ `call` ã€‚è¿™ç§æ–¹æ³•ä¸æ¨èä½¿ç”¨ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// 1. è¢«è°ƒç”¨æ–¹ (Callee)
// è¿™æ˜¯æˆ‘ä»¬è¦å»è°ƒç”¨çš„ç›®æ ‡åˆçº¦
contract Callee {
    uint256 public x;
    uint256 public value;

    // æ™®é€šå‡½æ•°ï¼šä¿®æ”¹ x å¹¶è¿”å› x
    function setX(uint256 _x) public returns (uint256) {
        x = _x;
        return x;
    }

    // å¯æ”¯ä»˜å‡½æ•°ï¼šæ—¢ä¿®æ”¹ xï¼Œåˆæ¥æ”¶ ETH
    function setXandSendEther(uint256 _x)
        public
        payable
        returns (uint256, uint256)
    {
        x = _x;
        value = msg.value; // è®°å½•æ”¶åˆ°äº†å¤šå°‘é’±
        return (x, value);
    }
}

// 2. è°ƒç”¨æ–¹ (Caller)
// è¿™ä¸ªåˆçº¦è´Ÿè´£å»â€œæˆ³â€ä¸Šé¢çš„åˆçº¦
contract Caller {
    
    // ã€åœºæ™¯ Aï¼šç›´æ¥ä¼ å…¥åˆçº¦ç±»å‹ã€‘
    // å‚æ•° _callee çš„ç±»å‹ç›´æ¥å°±æ˜¯åˆçº¦ Callee
    function setX(Callee _callee, uint256 _x) public {
        // ç¼–è¯‘å™¨çŸ¥é“ _callee é‡Œæœ‰ä¸ªå‡½æ•°å« setXï¼Œç›´æ¥è°ƒå°±è¡Œ
        uint256 x = _callee.setX(_x);
    }

    // ã€åœºæ™¯ Bï¼šä¼ å…¥åœ°å€ï¼Œè‡ªå·±è½¬æ¢ã€‘ï¼ˆæœ€å¸¸ç”¨ï¼‰
    // é€šå¸¸æˆ‘ä»¬åœ¨å‰ç«¯åªçŸ¥é“ç›®æ ‡åˆçº¦çš„åœ°å€ (address 0x...)
    function setXFromAddress(address _addr, uint256 _x) public {
        // å…³é”®æ­¥éª¤ï¼šå¼ºåˆ¶ç±»å‹è½¬æ¢
        // æŠŠâ€œå…‰ç§ƒç§ƒâ€çš„åœ°å€ _addrï¼ŒåŒ…è£…æˆ Callee ç±»å‹çš„åˆçº¦å®ä¾‹
        Callee callee = Callee(_addr);
        
        // ç°åœ¨å¯ä»¥è°ƒç”¨äº†
        callee.setX(_x);
    }

    // ã€åœºæ™¯ Cï¼šè°ƒç”¨å‡½æ•°å¹¶é™„å¸¦ ETHã€‘
    // ç±»ä¼¼äºä½çº§è°ƒç”¨çš„ {value: ...}ï¼Œé«˜çº§è°ƒç”¨ä¹Ÿå¯ä»¥è¿™æ ·å†™
    function setXandSendEther(Callee _callee, uint256 _x) public payable {
        // è¯­æ³•ï¼šåˆçº¦å¯¹è±¡.å‡½æ•°å{value: é‡‘é¢}(å‚æ•°)
        // è¿™é‡ŒæŠŠ Caller æ”¶åˆ°çš„é’± (msg.value) è½¬å‘ç»™äº† Callee
        (uint256 x, uint256 value) = 
            _callee.setXandSendEther{value: msg.value}(_x);
    }
}
```

### Contract that Creates other Contracts é€šè¿‡åˆçº¦åˆ›å»ºåˆçº¦ï¼ˆ**å·¥å‚æ¨¡å¼**ï¼‰

é€šè¿‡ `new` å…³é”®å­—ï¼Œå…¶ä»–åˆçº¦å¯ä»¥åˆ›å»ºåˆçº¦ã€‚è‡ª 0.8.0 ç‰ˆæœ¬èµ·ï¼Œ `new` å…³é”®å­—é€šè¿‡æŒ‡å®š `salt` é€‰é¡¹æ”¯æŒ `create2` åŠŸèƒ½ã€‚

CREATE å’Œ CREATE2 çš„å¼€é”€å·®åˆ«éå¸¸å°ï¼Œé€šå¸¸å¯ä»¥å¿½ç•¥ä¸è®¡

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

//è¦åˆ›å»ºçš„åˆçº¦ï¼Œè¿™æ˜¯æˆ‘ä»¬è¦ç”Ÿäº§çš„â€œè½¦â€ã€‚
contract Car {
    address public owner;
    string public model;
    address public carAddr;

    // æ„é€ å‡½æ•°æ˜¯ payable çš„ï¼Œæ„å‘³ç€ä½ åœ¨åˆ›å»ºè¿™è¾†è½¦æ—¶ï¼Œå¯ä»¥é¡ºä¾¿å¡é’±è¿›å»
    constructor(address _owner, string memory _model) payable {
        owner = _owner;
        model = _model;
        carAddr = address(this);
    }
}

//å·¥å‚
contract CarFactory {
    Car[] public cars; // ç”¨äºè®°å½•æ‰€æœ‰ç”Ÿäº§å‡ºæ¥çš„è½¦çš„åœ°å€

    // ã€æ–¹å¼ 1: æ™®é€šåˆ›å»º (CREATE)ã€‘
    // ä½¿ç”¨ä¼ ç»Ÿçš„ `new` å…³é”®å­—ã€‚
    // æ–°åˆçº¦åœ°å€ = hash(å·¥å‚åœ°å€, å·¥å‚çš„ nonce)
    // è¿™ç§æ–¹å¼ç”Ÿæˆçš„åœ°å€éš¾ä»¥é¢„æµ‹ï¼ˆå› ä¸º nonce ä¼šå˜ï¼‰ã€‚
    function create(address _owner, string memory _model) public {
        Car car = new Car(_owner, _model);
        //car çš„ç±»å‹æ˜¯ Car ï¼Œ address(car) è·å¾—ç›¸åº”çš„ åœ°å€
        cars.push(car);
    }

    // ã€æ–¹å¼ 2: å¸¦èµ„è¿›ç»„ã€‘
    // åœ¨åˆ›å»ºåˆçº¦çš„åŒæ—¶ï¼Œç»™æ–°åˆçº¦è½¬å…¥ ETHã€‚
    // è¯­æ³•ï¼š(new ContractName){value: é‡‘é¢}(æ„é€ å‡½æ•°å‚æ•°)
    function createAndSendEther(address _owner, string memory _model)
        public
        payable
    {
        // æ³¨æ„ï¼šCar çš„æ„é€ å‡½æ•°å¿…é¡»æ˜¯ payable çš„ï¼Œè¿™é‡Œæ‰ä¸ä¼šæŠ¥é”™
        Car car = (new Car){value: msg.value}(_owner, _model);
        cars.push(car);
    }

    // ã€æ–¹å¼ 3: ç¡®å®šæ€§åˆ›å»º (CREATE2)ã€‘
    // ä½¿ç”¨ `salt` é€‰é¡¹ã€‚
    // æ–°åˆçº¦åœ°å€ = hash(0xFF, å·¥å‚åœ°å€, salt, æ–°åˆçº¦å­—èŠ‚ç )
    // åªè¦ salt ä¸å˜ï¼Œä»£ç ä¸å˜ï¼Œç”Ÿæˆçš„åœ°å€æ°¸è¿œæ˜¯å›ºå®šçš„ï¼
    // è¿™å« "Counterfactual instantiation" (åäº‹å®å®ä¾‹åŒ–)ã€‚
    function create2(address _owner, string memory _model, bytes32 _salt)
        public
    {
        // è¯­æ³•ï¼š(new ContractName){salt: ç›å€¼}(æ„é€ å‡½æ•°å‚æ•°)
        Car car = (new Car){salt: _salt}(_owner, _model);
        cars.push(car);
    }

    // ã€æ–¹å¼ 4: å…¨å®¶æ¡¶ (å¸¦é’± + å¸¦ salt)ã€‘
    function create2AndSendEther(
        address _owner,
        string memory _model,
        bytes32 _salt
    ) public payable {
        Car car = (new Car){value: msg.value, salt: _salt}(_owner, _model);
        cars.push(car);
    }

    // è¾…åŠ©å‡½æ•°ï¼šè¯»å–æŸè¾†è½¦çš„ä¿¡æ¯
    function getCar(uint256 _index)
        public
        view
        returns (
            address owner,
            string memory model,
            address carAddr,
            uint256 balance
        )
    {
        Car car = cars[_index];
        return (car.owner(), car.model(), car.carAddr(), address(car).balance);
    }
}
```

### try / catch

`try / catch` åªèƒ½æ•è·æ¥è‡ªå¤–éƒ¨å‡½æ•°è°ƒç”¨å’Œåˆçº¦åˆ›å»ºçš„é”™è¯¯ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// ç”¨äºæ¼”ç¤º try / catch çš„å¤–éƒ¨åˆçº¦
contract Foo {
    address public owner;

    constructor(address _owner) {
        // æƒ…å†µ A: å¦‚æœ owner æ˜¯ 0åœ°å€ï¼ŒæŠ›å‡ºå¸¦å­—ç¬¦ä¸²çš„é”™è¯¯ (Error)
        require(_owner != address(0), "invalid address");
        // æƒ…å†µ B: å¦‚æœ owner æ˜¯ 0x...01ï¼ŒæŠ›å‡º Panic é”™è¯¯ (assert äº§ç”Ÿ)
        assert(_owner != 0x0000000000000000000000000000000000000001);
        owner = _owner;
    }

    function myFunc(uint256 x) public pure returns (string memory) {
        // å¦‚æœ x ä¸º 0ï¼ŒæŠ›å‡ºé”™è¯¯
        require(x != 0, "require failed");
        return "my func was called";
    }
}

contract Bar {
    event Log(string message);
    event LogBytes(bytes data);

    Foo public foo;

    constructor() {
        // è¿™é‡Œåˆ›å»ºä¸€ä¸ª Foo å®ä¾‹ï¼Œç”¨äºä¸‹é¢çš„å¤–éƒ¨è°ƒç”¨æ¼”ç¤º
        foo = new Foo(msg.sender);
    }

    // ã€ç¤ºä¾‹ 1ï¼šæ•è·å¤–éƒ¨å‡½æ•°è°ƒç”¨çš„é”™è¯¯ã€‘
    // è¾“å…¥ 0 => è§¦å‘ require æŠ¥é”™ => è¿›å…¥ catch => è¾“å‡º Log("external call failed")
    // è¾“å…¥ 1 => æ­£å¸¸è¿è¡Œ => è¿›å…¥ try ä»£ç å— => è¾“å‡º Log("my func was called")
    function tryCatchExternalCall(uint256 _i) public {
        // è¯­æ³•ï¼štry å¤–éƒ¨è°ƒç”¨ returns (è¿”å›å€¼) { ...æ— æŠ¥é”™æ‰§è¡Œ } catch { ...æŠ¥é”™æ—¶æ‰§è¡Œ }
        // æ³¨æ„ï¼šè¿™é‡Œç”¨çš„æ˜¯ this.foo æˆ–è€…ç›´æ¥ foo (å› ä¸º foo æ˜¯å¤–éƒ¨åˆçº¦å˜é‡)ï¼Œè¿™å±äºå¤–éƒ¨è°ƒç”¨
        try foo.myFunc(_i) returns (string memory result) {
            emit Log(result);
        } catch {
            // è¿™ç§å†™æ³•æ˜¯é€šç”¨çš„ catchï¼Œä¸ç®¡ä»€ä¹ˆé”™è¯¯éƒ½è¿›è¿™é‡Œ
            emit Log("external call failed");
        }
    }

    // ã€ç¤ºä¾‹ 2ï¼šæ•è·åˆçº¦åˆ›å»ºï¼ˆnewï¼‰æ—¶çš„é”™è¯¯ã€‘
    // è¾“å…¥ address(0) => è§¦å‘ require => è¿›å…¥ catch Error => è¾“å‡º "invalid address"
    // è¾“å…¥ address(1) => è§¦å‘ assert  => è¿›å…¥ catch (bytes) => è¾“å‡º åŸå§‹å­—èŠ‚æ•°æ®
    // è¾“å…¥ address(2) => æˆåŠŸåˆ›å»º => è¿›å…¥ try ä»£ç å— => è¾“å‡º "Foo created"
    function tryCatchNewContract(address _owner) public {
        // è¯­æ³•ï¼štry new åˆçº¦(...) returns (å®ä¾‹å˜é‡) { ... }
        try new Foo(_owner) returns (Foo foo) {
            // åˆ›å»ºæˆåŠŸï¼Œåœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨æ–°åˆ›å»ºçš„ foo å˜é‡
            emit Log("Foo created");
        } catch Error(string memory reason) {
            // ã€ç‰¹å®šæ•è· 1ã€‘
            // ä¸“é—¨æ•è· require(..., "reason") æˆ– revert("reason") æŠ›å‡ºçš„é”™è¯¯
            emit Log(reason);
        } catch (bytes memory reason) {
            // ã€ç‰¹å®šæ•è· 2ã€‘
            // è¿™æ˜¯ä¸€ä¸ªâ€œå…œåº•â€æ•è·ã€‚
            // å®ƒå¯ä»¥æ•è· assert å¤±è´¥ (Panic)ã€é™¤ä»¥é›¶ã€æˆ–è€…æ²¡æœ‰é”™è¯¯ä¿¡æ¯çš„ revertã€‚
            emit LogBytes(reason);
        }
    }
}
```

è¯­æ³•ï¼š

```Solidity
try å¤–éƒ¨è°ƒç”¨ returns (è¿”å›å€¼) { 
    ...æ— æŠ¥é”™æ‰§è¡Œ 
} catch {
    ...æŠ¥é”™æ—¶æ‰§è¡Œ 
 }
```

é”™è¯¯ç±»å‹

| é”™è¯¯ç±»å‹ | è§¦å‘ä»£ç ç¤ºä¾‹ | å¯¹åº”çš„ Catch å— |
| æ ‡å‡† Error | require(false, "No!"); | catch Error(string memory reason) |
| Panic | assert(false); æˆ– 1/0; | catch Panic(uint256 code) |
| Custom Error | revert MyError(); | catch (bytes memory data) (å…œåº•) |
| Empty Revert | revert(); | catch (bytes memory data) (å…œåº•) |

### Import

Local (æœ¬åœ°å¼•ç”¨)

è¿™æ˜¯æˆ‘ä»¬çš„æ–‡ä»¶å¤¹ç»“æ„ï¼ˆå‡è®¾è¿™ä¸¤ä¸ªæ–‡ä»¶åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼‰ï¼š

```Solidity
â”œâ”€â”€ Import.sol
â””â”€â”€ Foo.sol
```

**æ–‡ä»¶åï¼šFoo.sol (è¢«å¯¼å…¥çš„æ–‡ä»¶)**

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// 1. å®šä¹‰ä¸€ä¸ªç»“æ„ä½“
struct Point {
    uint256 x;
    uint256 y;
}

// 2. å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰é”™è¯¯
error Unauthorized(address caller);

// 3. å®šä¹‰ä¸€ä¸ªâ€œè‡ªç”±å‡½æ•°â€(Free Function)
// æ³¨æ„ï¼šè¿™ä¸ªå‡½æ•°æ˜¯åœ¨åˆçº¦å¤–é¢å®šä¹‰çš„ï¼Œä¸å±äºä»»ä½•åˆçº¦ï¼Œå±äºå…¨å±€ä½œç”¨åŸŸ
function add(uint256 x, uint256 y) pure returns (uint256) {
    return x + y;
}

// 4. å®šä¹‰ä¸€ä¸ªåˆçº¦
contract Foo {
    string public name = "Foo";
}
```

**æ–‡ä»¶åï¼šImport.sol (æ‰§è¡Œå¯¼å…¥çš„æ–‡ä»¶)**

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// ã€æ–¹å¼ 1: å…¨å±€å¯¼å…¥ã€‘
// å¯¼å…¥å½“å‰ç›®å½•ä¸‹çš„ Foo.sol æ–‡ä»¶ä¸­çš„æ‰€æœ‰å†…å®¹
import "./Foo.sol";

// ã€æ–¹å¼ 2:ä»¥æ­¤ä¸ºå‡†çš„å…·åå¯¼å…¥ (æ¨è)ã€‘
// åªå¯¼å…¥ä½ éœ€è¦çš„éƒ¨åˆ†ï¼Œè¿˜å¯ä»¥é‡å‘½å (Alias)
// è¯­æ³•: import { åŸå as æ–°å, åŸå } from "è·¯å¾„";
import {Unauthorized, add as func, Point} from "./Foo.sol";

contract Import {
    // åˆå§‹åŒ– Foo åˆçº¦
    Foo public foo = new Foo();

    // æµ‹è¯•è·å– Foo çš„åå­—
    function getFooName() public view returns (string memory) {
        return foo.name();
    }
}
```

External (å¤–éƒ¨å¼•ç”¨)

ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç›´æ¥å¤åˆ¶ GitHub çš„ URL æ¥å¯¼å…¥æ–‡ä»¶ï¼ˆé€šå¸¸ç”¨äº Remix ç¼–è¾‘å™¨ï¼‰ã€‚

```Solidity
// è¯­æ³•ç¤ºä¾‹ï¼šimport "https://github.com/owner/repo/blob/branch/path/to/Contract.sol";

// ç¤ºä¾‹ï¼šä» OpenZeppelin çš„ä»£ç åº“å¯¼å…¥ ECDSA åº“ (release-v4.5 åˆ†æ”¯)
import "https://github.com/OpenZeppelin/openzeppelin-contracts/blob/release-v4.5/contracts/utils/cryptography/ECDSA.sol";
```

### æ·±åº¦è§£æï¼šä¸‰ç§å¯¼å…¥å§¿åŠ¿

åœ¨ Solidity å¼€å‘ä¸­ï¼ŒæŒæ¡æ­£ç¡®çš„ `import` å§¿åŠ¿éå¸¸é‡è¦ï¼Œè¿™å…³ç³»åˆ°ä»£ç çš„æ•´æ´åº¦å’Œç¼–è¯‘æ•ˆç‡ã€‚

A. å…¨å±€å¯¼å…¥ (Global Import)

> `import "./Foo.sol";`

-   **å«ä¹‰ï¼š** æŠŠ `Foo.sol` é‡Œæ‰€æœ‰èƒ½å¯¼å‡ºçš„ä¸œè¥¿ï¼ˆåˆçº¦ã€å‡½æ•°ã€ç»“æ„ä½“ã€é”™è¯¯ï¼‰å…¨æ‹¿è¿‡æ¥ã€‚
    
-   **ç¼ºç‚¹ï¼š** æ±¡æŸ“å‘½åç©ºé—´ã€‚å¦‚æœ `Foo.sol` é‡Œæœ‰ä¸ª `struct Point`ï¼Œè€Œä½ çš„æ–‡ä»¶é‡Œä¹Ÿæœ‰ä¸ª `struct Point`ï¼Œå°±ä¼šå†²çªæŠ¥é”™ã€‚
    
-   **é€‚ç”¨åœºæ™¯ï¼š** å¿«é€ŸåŸå‹å¼€å‘ï¼Œæˆ–è€…æ–‡ä»¶å†…å®¹å¾ˆå°‘æ—¶ã€‚
    

B. å…·åå¯¼å…¥ (Named Import) â€”â€” **æ¨èåšæ³•**

> `import {Unauthorized, add as func, Point} from "./Foo.sol";`

è¿™æ˜¯ Solidity 0.7.0 ä¹‹åå¼•å…¥çš„ç°ä»£åŒ–å†™æ³•ï¼Œæ¨¡ä»¿äº† JS çš„ ES6 è¯­æ³•ã€‚

-   **ç²¾ç¡®æ§åˆ¶ï¼š** åªå¼•å…¥ä½ éœ€è¦çš„ç»„ä»¶ã€‚
    
-   **èµ·åˆ«å (Aliasing)ï¼š** ä½¿ç”¨ `as` å…³é”®å­—ã€‚
    
    -   ä¾‹å¦‚ï¼š`add as func`ã€‚åœ¨ `Import.sol` é‡Œï¼Œä½ å°±ä¸å«å®ƒ `add` äº†ï¼Œæ”¹å« `func`ã€‚
        
    -   **ä½œç”¨ï¼š** å®Œç¾è§£å†³å‘½åå†²çªã€‚å¦‚æœä¸¤ä¸ªæ–‡ä»¶éƒ½æœ‰ `add` å‡½æ•°ï¼Œä½ å¯ä»¥åˆ†åˆ«é‡å‘½åä¸º `addA` å’Œ `addB`ã€‚
        

C. å¤–éƒ¨å¯¼å…¥ (External Import)

> `import "https://github.com/..."`

-   **Remix ä¸“å±ï¼š** è¿™ç§ç›´æ¥å†™ç½‘å€çš„æ–¹å¼ï¼Œä¸»è¦æ˜¯åœ¨ **Remix IDE** ç½‘é¡µç‰ˆé‡Œä½¿ç”¨ã€‚Remix ä¼šè‡ªåŠ¨å»ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ã€‚
    
-   **æœ¬åœ°å¼€å‘ (Hardhat/Foundry)ï¼š** åœ¨æœ¬åœ°å¼€å‘æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¸å†™ç½‘å€ï¼Œè€Œæ˜¯ä½¿ç”¨ `npm` å®‰è£…åº“ï¼Œç„¶åè¿™æ ·å¯¼å…¥ï¼š
    

```Solidity
// æœ¬åœ°å¼€å‘æ ‡å‡†å†™æ³•
import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
```

### è¡¥å……çŸ¥è¯†ç‚¹ï¼šè‡ªç”±å‡½æ•° (Free Functions)

åœ¨ `Foo.sol` ä¸­ï¼Œä½ çœ‹åˆ°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼š

```Solidity
function add(uint256 x, uint256 y) pure returns (uint256) { ... }
```

è¿™ä¸ªå‡½æ•°**æ²¡æœ‰è¢«åŒ…è£¹åœ¨** `contract { ... }` **é‡Œé¢**ã€‚

-   è¿™å« **Top-level Function (é¡¶çº§å‡½æ•°)** æˆ– **Free Function**ã€‚
    
-   **ç‰¹ç‚¹ï¼š** å®ƒä»¬ä¸éœ€è¦å®ä¾‹åŒ–åˆçº¦å°±å¯ä»¥ä½¿ç”¨ï¼Œç±»ä¼¼å…¶ä»–è¯­è¨€çš„é™æ€å·¥å…·å‡½æ•°ã€‚
    
-   **ç”¨é€”ï¼š** å¸¸ç”¨äºæ•°å­¦è®¡ç®—åº“ã€è¾…åŠ©å·¥å…·åº“ã€‚
    

### Library

**æ ¸å¿ƒå®šä¹‰ï¼š**

-   åº“å’Œåˆçº¦ï¼ˆContractï¼‰å¾ˆåƒï¼Œä½†æœ‰ä¸¤å¤§é™åˆ¶ï¼š
    
    -   **ä¸èƒ½å£°æ˜ä»»ä½•çŠ¶æ€å˜é‡**ï¼ˆState Variableï¼‰ã€‚
        
    -   **ä¸èƒ½æ¥æ”¶ ETH**ã€‚
        

**éƒ¨ç½²è§„åˆ™ï¼ˆé¢è¯•è€ƒç‚¹ï¼‰ï¼š**

-   **å†…åµŒ (Embedded):** å¦‚æœåº“é‡Œ**æ‰€æœ‰**å‡½æ•°éƒ½æ˜¯ `internal`ï¼ˆå†…éƒ¨çš„ï¼‰ï¼Œé‚£ä¹ˆåº“çš„ä»£ç ä¼šç›´æ¥è¢«**å¤åˆ¶ç²˜è´´**åˆ°è°ƒç”¨å®ƒçš„åˆçº¦é‡Œã€‚éƒ¨ç½²æ—¶ä¸éœ€è¦å•ç‹¬éƒ¨ç½²åº“ã€‚
    
-   **é“¾æ¥ (Linked):** å¦‚æœåº“é‡Œæœ‰ `public` æˆ– `external` å‡½æ•°ï¼Œåº“å¿…é¡»å…ˆå•ç‹¬éƒ¨ç½²ã€‚ç„¶åï¼Œä¸»åˆçº¦åœ¨éƒ¨ç½²æ—¶éœ€è¦é€šè¿‡â€œé“¾æ¥â€çš„æ–¹å¼æ‰¾åˆ°è¿™ä¸ªåº“çš„åœ°å€ã€‚
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

library Math {
    // ã€å…³é”®ç‚¹ 1ã€‘ internal
    // å› ä¸ºæ˜¯ internalï¼Œè¿™éƒ¨åˆ†ä»£ç ç¼–è¯‘æ—¶ä¼šç›´æ¥åµŒå…¥åˆ° TestMath åˆçº¦ä¸­ã€‚
    // ä¸ä¼šäº§ç”Ÿå¤–éƒ¨è°ƒç”¨å¼€é”€ã€‚
    function sqrt(uint256 y) internal pure returns (uint256 z) {
        if (y > 3) {
            z = y;
            uint256 x = y / 2 + 1;
            // å·´æ¯”ä¼¦æ³•æ±‚å¹³æ–¹æ ¹ï¼ˆç‰›é¡¿è¿­ä»£æ³•ï¼‰
            while (x < z) {
                z = x;
                x = (y / x + x) / 2;
            }
        } else if (y != 0) {
            z = 1;
        }
        // é»˜è®¤ä¸º 0
    }
}

contract TestMath {
    function testSquareRoot(uint256 x) public pure returns (uint256) {
        // è°ƒç”¨æ–¹å¼ï¼šåº“å.å‡½æ•°å(å‚æ•°)
        return Math.sqrt(x);
    }
}

// è¿™æ˜¯ä¸€ä¸ªç”¨äºåˆ é™¤æ•°ç»„å…ƒç´ å¹¶é‡æ–°æ•´ç†æ•°ç»„çš„åº“
library Array {
    // ã€å…³é”®ç‚¹ 2ã€‘ storage æŒ‡é’ˆ
    // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ `uint256[] storage arr`ã€‚
    // è¿™æ„å‘³ç€è¿™ä¸ªå‡½æ•°ä¼šç›´æ¥ä¿®æ”¹è°ƒç”¨è€…åˆçº¦é‡Œçš„çŠ¶æ€å˜é‡ï¼ˆé‚£ä¸ªçœŸå®çš„æ•°ç»„ï¼‰ã€‚
    function remove(uint256[] storage arr, uint256 index) public {
        require(arr.length > 0, "Can't remove from empty array");
        
        // ã€æ ¸å¿ƒç®—æ³•ï¼šSwap and Popã€‘
        // ç›®æ ‡ï¼šåˆ é™¤ index ä½ç½®çš„å…ƒç´ ï¼Œä¸”èŠ‚çœ Gasã€‚
        // åšæ³•ï¼šæŠŠæ•°ç»„â€œæœ€åä¸€ä¸ªå…ƒç´ â€æ¬è¿‡æ¥ï¼Œè¦†ç›–æ‰â€œindex ä½ç½®çš„å…ƒç´ â€ï¼Œç„¶åæŠŠå°¾å·´åˆ æ‰ã€‚
        // ä»£ä»·ï¼šæ•°ç»„çš„é¡ºåºä¼šè¢«æ‰“ä¹±ï¼ˆæ— åºåˆ é™¤ï¼‰ã€‚
        
        arr[index] = arr[arr.length - 1]; // 1. æ¬è¿å°¾éƒ¨å…ƒç´ è¦†ç›–ç›®æ ‡
        arr.pop();                        // 2. åˆ æ‰å°¾éƒ¨
    }
}

contract TestArray {
    // ã€å…³é”®ç‚¹ 3ã€‘ Using è¯­æ³•ç³–
    // æ„æ€æ˜¯ï¼šæŠŠ Array åº“é‡Œçš„åŠŸèƒ½ï¼Œåº”ç”¨åˆ° uint256[] ç±»å‹çš„æ•°æ®ä¸Šã€‚
    // æ•ˆæœï¼šåŸæœ¬éœ€è¦å†™ Array.remove(arr, 1)ï¼Œç°åœ¨å¯ä»¥å†™ arr.remove(1)ã€‚
    // ç±»ä¼¼äºç»™ uint256[] ç±»å‹â€œæ‰©å±•â€äº†æ–°æ–¹æ³•ã€‚
    using Array for uint256[];

    uint256[] public arr;

    function testArrayRemove() public {
        // åˆå§‹åŒ–æ•°ç»„ [0, 1, 2]
        for (uint256 i = 0; i < 3; i++) {
            arr.push(i);
        }

        // è°ƒç”¨åº“å‡½æ•°åˆ é™¤ç´¢å¼•ä¸º 1 çš„å…ƒç´  (ä¹Ÿå°±æ˜¯æ•°å­— 1)
        // è¿‡ç¨‹æ¼”ç¤ºï¼š
        // åˆå§‹: [0, 1, 2]
        // ç›®æ ‡: åˆ é™¤ index 1
        // æ¬è¿: æŠŠæœ«å°¾çš„ 2 æ¬åˆ° index 1 -> [0, 2, 2]
        // Pop : åˆ æ‰æœ«å°¾ -> [0, 2]
        arr.remove(1);

        assert(arr.length == 2);
        assert(arr[0] == 0);
        assert(arr[1] == 2); // æ³¨æ„ï¼šåŸæœ¬æœ€åçš„å…ƒç´ è·‘åˆ°ä¸­é—´æ¥äº†
    }
}
```

**ä¸ºä»€ä¹ˆç”¨åº“ï¼Ÿ**

-   **å¤ç”¨ä»£ç ï¼š** ä¸è¦é‡å¤é€ è½®å­ï¼ˆæ¯”å¦‚ `SafeMath` æˆ–å­—ç¬¦ä¸²å¤„ç†å·¥å…·ï¼‰ã€‚
    
-   **èŠ‚çœ Gasï¼ˆé’ˆå¯¹ Internalï¼‰ï¼š** å¦‚æœä»£ç å¤ç”¨ç‡é«˜ï¼Œinternal åº“å¯ä»¥é¿å…å¤šæ¬¡éƒ¨ç½²ç›¸åŒé€»è¾‘ã€‚
    
-   **èŠ‚çœåˆçº¦å¤§å°ï¼ˆé’ˆå¯¹ Publicï¼‰ï¼š** ä¼ ç»Ÿçš„åˆçº¦æœ€å¤§é™åˆ¶æ˜¯ 24KBã€‚å¦‚æœä½ æŠŠå¤§æ®µé€»è¾‘æ‹†åˆ†åˆ° public åº“é‡Œå•ç‹¬éƒ¨ç½²ï¼Œä¸»åˆçº¦åªå­˜ä¸€ä¸ªé“¾æ¥åœ°å€ï¼Œå°±å¯ä»¥çªç ´å¤§å°é™åˆ¶ã€‚
    

å¦‚æœ `Array` åº“é‡Œçš„å‡½æ•°å†™çš„æ˜¯ `public`ï¼Œæƒ…å†µå°±å®Œå…¨å˜äº†ã€‚è¿™æ—¶å€™å®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„â€œå®ä½“â€ã€‚

1.  éƒ¨ç½²æµç¨‹ï¼ˆå¿…é¡»åˆ†ä¸¤æ­¥èµ°ï¼‰
    

ä½ ä¸èƒ½ç›´æ¥éƒ¨ç½²ä¸»åˆçº¦ã€‚æµç¨‹å¦‚ä¸‹ï¼š

1.  **å…ˆéƒ¨ç½²åº“ï¼š** æŠŠ `Array` åº“éƒ¨ç½²åˆ°é“¾ä¸Šï¼Œå‡è®¾è·å¾—åœ°å€ `0xAA...AA`ã€‚
    
2.  **å†éƒ¨ç½²ä¸»åˆçº¦ï¼š** éƒ¨ç½² `TestArray`ã€‚
    

2.  æ€ä¹ˆå®šä½ï¼Ÿï¼ˆå…³é”®æ¦‚å¿µï¼šé“¾æ¥ Linkingï¼‰
    

è¿™å°±æ˜¯ä½ é—®çš„æ ¸å¿ƒï¼š**ä¸»åˆçº¦æ€ä¹ˆçŸ¥é“åº“åœ¨** `0xAA...AA`**ï¼Ÿ**

è¿™æ˜¯åœ¨**éƒ¨ç½²å‰**ç”±ç¼–è¯‘å™¨å’Œéƒ¨ç½²å·¥å…·ï¼ˆå¦‚ Remix, Hardhatï¼‰å®Œæˆçš„ï¼Œè¿™ä¸ªè¿‡ç¨‹å« **é“¾æ¥ï¼ˆLinkingï¼‰**ã€‚

**å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š**

-   **Step A: ç¼–è¯‘æœŸï¼ˆæŒ–å‘ï¼‰** å½“ä½ ç¼–è¯‘ `TestArray` æ—¶ï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“åº“çš„åœ°å€ã€‚å®ƒä¼šåœ¨ç”Ÿæˆçš„å­—èŠ‚ç é‡Œç•™ä¸€ä¸ª **â€œå ä½ç¬¦â€ï¼ˆPlaceholderï¼‰**ã€‚
    
-   ç”Ÿæˆçš„å­—èŠ‚ç çœ‹èµ·æ¥åƒè¿™æ ·ï¼š `60806040...CALL...$Array_Library_Path$...`_(ä¸­é—´é‚£ä¸²å¥‡æ€ªçš„å­—ç¬¦å°±æ˜¯ç•™ç»™åº“åœ°å€çš„å‘ä½)_
    
-   **Step B: é“¾æ¥æœŸï¼ˆå¡«å‘ï¼‰** åœ¨éƒ¨ç½² `TestArray` **ä¹‹å‰**ï¼Œéƒ¨ç½²å·¥å…·ï¼ˆRemix/Hardhatï¼‰ä¼šé—®ä½ ï¼ˆæˆ–è€…è‡ªåŠ¨æŸ¥æ‰¾ï¼‰ï¼šâ€œå˜¿ï¼ŒArray åº“éƒ¨ç½²åœ¨å“ªé‡Œäº†ï¼Ÿâ€
    
-   ä½ å‘Šè¯‰å®ƒï¼š`0xAA...AA`ã€‚
    
-   å·¥å…·ä¼šæŠŠå­—èŠ‚ç é‡Œçš„ `$Array_Library_Path$` æ›¿æ¢æˆ `0xAA...AA`ã€‚
    
-   **Step C: éƒ¨ç½²æœŸï¼ˆä¸Šé“¾ï¼‰** å°†è¿™å°±â€œå¡«å¥½å‘â€çš„å®Œæ•´å­—èŠ‚ç éƒ¨ç½²åˆ°é“¾ä¸Šã€‚æ­¤æ—¶ï¼Œ`TestArray` å°±åœ¨ä»£ç é‡Œæ°¸è¿œè®°ä½äº† `Array` åœ¨ `0xAA...AA`ã€‚
    

å¯¹äº **Public Libraryï¼ˆéœ€è¦å•ç‹¬éƒ¨ç½²å’Œé“¾æ¥çš„åº“ï¼‰**ï¼Œä½ ä¸èƒ½åƒè°ƒç”¨æ™®é€šåˆçº¦é‚£æ ·ï¼ˆæ¯”å¦‚ `ICallee(åœ°å€).func()`ï¼‰ç›´æ¥åœ¨ä»£ç é‡Œå†™åœ°å€è°ƒç”¨ã€‚

ä½ éœ€è¦åœ¨ **â€œéƒ¨ç½²é˜¶æ®µâ€** å‘Šè¯‰ä½ çš„åˆçº¦ï¼šâ€œå˜¿ï¼Œé‚£ä¸ªåº“åœ¨é“¾ä¸Šçš„åœ°å€æ˜¯ `0x...`â€ã€‚è¿™ä¸ªè¿‡ç¨‹å« **é“¾æ¥ (Linking)**ã€‚

ä»¥ä¸‹æ˜¯å…·ä½“çš„æ“ä½œæ­¥éª¤ï¼š

1.  **ä»£ç å±‚é¢ï¼š** ä½ ç…§å¸¸å†™ä»£ç ï¼Œå‡è£…è¿™ä¸ªåº“å°±åœ¨ä½ æœ¬åœ°ã€‚
    
2.  **ç¼–è¯‘å±‚é¢ï¼š** ç¼–è¯‘å™¨ä¼šç”Ÿæˆå¸¦æœ‰â€œå¡«ç©ºé¢˜â€ï¼ˆå ä½ç¬¦ï¼‰çš„å­—èŠ‚ç ã€‚
    
3.  **éƒ¨ç½²å±‚é¢ï¼ˆå…³é”®ï¼‰ï¼š** ä½ å¿…é¡»åœ¨éƒ¨ç½²è„šæœ¬é‡Œï¼ŒæŠŠé‚£ä¸ªå·²ç»åœ¨é“¾ä¸Šçš„åº“åœ°å€ï¼Œ**å¡«å…¥**è¿™ä¸ªâ€œç©ºâ€é‡Œã€‚
    

ç¬¬ä¸€æ­¥ï¼šä»£ç æ€ä¹ˆå†™ï¼Ÿ

å‡è®¾é“¾ä¸Šå·²ç»æœ‰ä¸€ä¸ª `MathLib`ï¼Œä½ éœ€è¦åœ¨ä½ çš„ä»£ç é‡Œ **æ‹¥æœ‰å®ƒçš„æºä»£ç ï¼ˆæˆ–è€…æ¥å£å®šä¹‰ï¼‰**ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// 1. ä½ å¿…é¡»å¼•å…¥åº“çš„å®šä¹‰ï¼ˆæºæ–‡ä»¶ï¼‰
// å³ä½¿åº“å·²ç»åœ¨é“¾ä¸Šäº†ï¼Œç¼–è¯‘å™¨ä¹Ÿéœ€è¦çŸ¥é“å®ƒé‡Œé¢æœ‰å“ªäº›å‡½æ•°
import "./MathLib.sol"; 

contract MyContract {
    function test() public {
        // 2. ç›´æ¥ç”¨åº“çš„åå­—è°ƒç”¨
        // æ³¨æ„ï¼šåƒä¸‡ä¸è¦å†™æˆ MathLib(0xåœ°å€).add(1, 2) â€”â€” è¿™æ˜¯é”™çš„ï¼
        // å°±ç›´æ¥å†™ MathLib.add(1, 2);
        MathLib.add(1, 2);
    }
}
```

ç¬¬äºŒæ­¥ï¼šæ€ä¹ˆæŠŠåœ°å€å‘Šè¯‰åˆçº¦ï¼Ÿï¼ˆæ€ä¹ˆé“¾æ¥ï¼‰

è¿™å–å†³äºä½ ç”¨ä»€ä¹ˆå·¥å…·å¼€å‘ã€‚æˆ‘ä»¬åˆ† **Remix** å’Œ **Hardhat** ä¸¤ç§æƒ…å†µè®²ã€‚

3.  å¦‚æœä½ ç”¨ Remix
    

Remix æ¯”è¾ƒæ™ºèƒ½ï¼Œå®ƒé€šå¸¸ä¼šåœ¨éƒ¨ç½²é¢æ¿è‡ªåŠ¨å¤„ç†ï¼Œä½†å¦‚æœæ˜¯å·²ç»å­˜åœ¨çš„é“¾ä¸Šåº“ï¼Œæ“ä½œå¦‚ä¸‹ï¼š

1.  ç¡®ä¿ `MathLib.sol` åœ¨ä½ çš„æ–‡ä»¶åˆ—è¡¨é‡Œã€‚
    
2.  ç¼–è¯‘ `MyContract`ã€‚
    
3.  åœ¨ **Deploy & Run** ç•Œé¢ï¼Œæ‰¾åˆ° **Deploy** æŒ‰é’®ä¸Šé¢ä¸€ç‚¹ç‚¹ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼ˆåœ¨æ—§ç‰ˆ Remix ä¸­å¯èƒ½éœ€è¦æ‰‹åŠ¨éƒ¨ç½²åº“ï¼›åœ¨æ–°ç‰ˆä¸­ï¼Œå¦‚æœæ£€æµ‹åˆ°åº“ï¼‰ï¼š
    
    1.  **æƒ…å†µ Aï¼ˆä½ è‡ªå·±éƒ¨ç½²ï¼‰ï¼š** ä½ å…ˆéƒ¨ç½² `MathLib`ï¼Œæ‹¿åˆ°åœ°å€ã€‚ç„¶ååœ¨éƒ¨ç½² `MyContract` æ—¶ï¼ŒRemix ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°ä½ åˆšæ‰éƒ¨ç½²çš„åº“ï¼Œå¹¶è‡ªåŠ¨é“¾æ¥ã€‚
        
    2.  **æƒ…å†µ Bï¼ˆé“¾æ¥åˆ°ç°æœ‰åœ°å€ï¼‰ï¼š** è¿™åœ¨ Remix ç½‘é¡µç‰ˆé‡Œæ“ä½œæ¯”è¾ƒéšè”½ã€‚é€šå¸¸æœ€ç®€å•çš„åŠæ³•æ˜¯ï¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ `address_file.json` å‘Šè¯‰ Remix åº“çš„åœ°å€ï¼ˆæ¯”è¾ƒéº»çƒ¦ï¼‰ã€‚
        
    3.  **æš´åŠ›è§£æ³•ï¼š** åœ¨ Remix é‡Œï¼Œå¤§éƒ¨åˆ†äººä¼šé€‰æ‹©**é‡æ–°éƒ¨ç½²ä¸€éåº“**ï¼ˆå› ä¸ºåº“é€šå¸¸å¾ˆå°ï¼Œé‡éƒ¨ç½²æˆæœ¬ä½ï¼‰ï¼Œç„¶å Remix ä¼šè‡ªåŠ¨é“¾æ¥æ–°éƒ¨ç½²çš„è¿™ä¸ªã€‚
        

2.  å¦‚æœä½ ç”¨ Hardhat (æ¨èï¼Œæœ€å¸¸ç”¨)
    

è¿™æ˜¯æœ€æ ‡å‡†çš„å·¥ç¨‹åšæ³•ã€‚ä½ åœ¨å†™éƒ¨ç½²è„šæœ¬ï¼ˆDeploy Scriptï¼‰æ—¶ï¼Œæ˜¾å¼åœ°å¡«å…¥åœ°å€ã€‚

å‡è®¾é“¾ä¸Šçš„ `MathLib` åœ°å€æ˜¯ `0x5FbDB2315678...`ã€‚

**éƒ¨ç½²è„šæœ¬ (**`scripts/deploy.js`**)ï¼š**

```JavaScript
const hre = require("hardhat");

async function main() {
  // 1. å‡è®¾è¿™æ˜¯é“¾ä¸Šé‚£ä¸ªå·²æœ‰çš„åº“åœ°å€const libraryAddress = "0x5FbDB2315678..."; 

  // 2. è·å–ä½ çš„åˆçº¦å·¥å‚const MyContract = await hre.ethers.getContractFactory("MyContract", {
    // ã€å…³é”®æ­¥éª¤ã€‘ï¼šåœ¨è¿™é‡Œé…ç½® librarieslibraries: {
      // åº“çš„åå­— : åº“çš„åœ°å€MathLib: libraryAddress,
    },
  });

  // 3. éƒ¨ç½²åˆçº¦// Hardhat ä¼šè‡ªåŠ¨æŠŠ libraryAddress å¡«å…¥ MyContract çš„å­—èŠ‚ç å ä½ç¬¦é‡Œconst myContract = await MyContract.deploy();
  await myContract.waitForDeployment();

  console.log("MyContract deployed to:", myContract.target);
}

main().catch((error) => {
  console.error(error);
  process.exitCode = 1;
});
```

å½“ä½ æƒ³è¦è°ƒç”¨ä¸€ä¸ªé“¾ä¸Šå·²æœ‰çš„ Public Libraryï¼š

1.  **ä»£ç é‡Œï¼š** ä¸éœ€è¦å†™åœ°å€ã€‚åªç®¡ `import` æºä»£ç ï¼Œç„¶å `LibName.func()`ã€‚
    
2.  **éƒ¨ç½²æ—¶ï¼š** å¿…é¡»ä½¿ç”¨ **Linkï¼ˆé“¾æ¥ï¼‰** æ“ä½œã€‚
    
    1.  **Hardhat:** åœ¨ `getContractFactory` çš„å‚æ•°é‡Œä¼ å…¥ `libraries: { LibName: "0x..." }`ã€‚
        
    2.  **Remix:** æœ€å¥½æ˜¯è®© Remix å¸®ä½ é‡æ–°éƒ¨ç½²åº“å¹¶è‡ªåŠ¨é“¾æ¥ï¼Œæˆ–è€…ä½¿ç”¨è„šæœ¬æ³¨å…¥åœ°å€ã€‚
        

### Gas Saving Techniques

-   **Replacing** `memory` **with** `calldata`: å°†å‚æ•°çš„å­˜å‚¨ä½ç½®ä»å†…å­˜æ”¹ä¸º `calldata`ã€‚
    
-   **Loading state variable to memory**: å°†çŠ¶æ€å˜é‡è¯»å–åˆ°æœ¬åœ°å†…å­˜ï¼ˆæ ˆï¼‰ä¸­å¤„ç†ã€‚
    
-   **Replace for loop** `i++` **with** `++i`: å¾ªç¯ä¸­ç”¨ `++i` ä»£æ›¿ `i++`ã€‚
    
-   **Caching array elements**: ç¼“å­˜æ•°ç»„å…ƒç´ ï¼ˆå’Œé•¿åº¦ï¼‰ã€‚
    
-   **Short circuit**: åˆ©ç”¨é€»è¾‘è¿ç®—çš„â€œçŸ­è·¯â€ç‰¹æ€§ã€‚
    

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// Gas é«˜å°”å¤«ï¼ˆæé™ä¼˜åŒ–ï¼‰
contract GasGolf {
    // åˆå§‹çŠ¶æ€ Gas æ¶ˆè€—å‚è€ƒï¼š
    // start - 50908 gas (å®Œå…¨æ²¡ä¼˜åŒ–)
    // use calldata - 49163 gas (ä½¿ç”¨ calldata)
    // load state variables to memory - 48952 gas (ç¼“å­˜çŠ¶æ€å˜é‡)
    // short circuit - 48634 gas (çŸ­è·¯è¿ç®—)
    // loop increments - 48244 gas (å¾ªç¯è‡ªå¢ä¼˜åŒ–)
    // cache array length - 48209 gas (ç¼“å­˜æ•°ç»„é•¿åº¦)
    // load array elements to memory - 48047 gas (ç¼“å­˜æ•°ç»„å…ƒç´ )
    // uncheck i overflow/underflow - 47309 gas (ä¸æ£€æŸ¥ i æº¢å‡º - æœ€ç»ˆå½¢æ€)

    uint256 public total;

    // ã€æœªä¼˜åŒ–ç‰ˆæœ¬ã€‘
    // function sumIfEvenAndLessThan99(uint[] memory nums) external {
    //     for (uint i = 0; i < nums.length; i += 1) { // æ¯æ¬¡éƒ½è¯» nums.length
    //         bool isEven = nums[i] % 2 == 0;
    //         bool isLessThan99 = nums[i] < 99;
    //         if (isEven && isLessThan99) { // ä¸¤ä¸ªçŠ¶æ€éƒ½è¯»å†™ï¼Œæ²¡æœ‰æœ‰æ•ˆåˆ©ç”¨çŸ­è·¯
    //             total += nums[i]; // æ¯æ¬¡éƒ½å¤šæ¬¡è¯»å†™ Storage å˜é‡ total
    //         }
    //     }
    // }

    // ã€Gas ä¼˜åŒ–ç»ˆæç‰ˆã€‘
    // è¾“å…¥ç¤ºä¾‹: [1, 2, 3, 4, 5, 100]
    function sumIfEvenAndLessThan99(uint256[] calldata nums) external {
        // ä¼˜åŒ– 1: å°† storage å˜é‡ total è¯»å–åˆ°æœ¬åœ° stack å˜é‡ _total
        // é¿å…åœ¨å¾ªç¯ä¸­åå¤è¯»å†™æ˜‚è´µçš„ storage
        uint256 _total = total;
        
        // ä¼˜åŒ– 2: ç¼“å­˜æ•°ç»„é•¿åº¦ï¼Œé¿å…æ¯æ¬¡å¾ªç¯éƒ½å»è¯»å– nums.length
        uint256 len = nums.length;

        // å¾ªç¯å¤´éƒ¨ç•™ç©ºï¼ŒæŠŠ ++i æ”¾åˆ°æœ€å
        for (uint256 i = 0; i < len;) {
            // ä¼˜åŒ– 3: æŠŠå½“å‰å…ƒç´ å–å‡ºæ¥å­˜åˆ° stack å˜é‡ï¼Œé¿å…å¤šæ¬¡è®¿é—®æ•°ç»„ç´¢å¼•
            uint256 num = nums[i];

            // ä¼˜åŒ– 4: çŸ­è·¯è¿ç®—
            // å¦‚æœ num æ˜¯å¥‡æ•°ï¼Œnum < 99 å°±ä¸ä¼šè¢«æ‰§è¡Œ
            if (num % 2 == 0 && num < 99) {
                _total += num; // ä¿®æ”¹çš„æ˜¯æœ¬åœ°å˜é‡
            }

            // ä¼˜åŒ– 5: Unchecked ä»£ç å—
            // çœç•¥äº† i è‡ªå¢æ—¶çš„æº¢å‡ºæ£€æŸ¥ (å› ä¸º i ä¸å¯èƒ½è¶…è¿‡æ•°ç»„é•¿åº¦)
            // ä¼˜åŒ– 6: ä½¿ç”¨å‰ç¼€è‡ªå¢ ++i (æ¯” i++ ç¨å¾®çœä¸€ç‚¹ç‚¹)
            unchecked {
                ++i;
            }
        }

        // å¾ªç¯ç»“æŸï¼Œåªå†™å›ä¸€æ¬¡ storage
        total = _total;
    }
}
```

è¿˜æœ‰ä¸€äº›æ²¡çœ‹

ä½†æ˜¯æ„Ÿè§‰è¿™äº›åº”è¯¥å¤Ÿç°åœ¨ç”¨çš„äº†

åé¢å†æœ‰éœ€è¦çš„å†è¡¥å§
<!-- DAILY_CHECKIN_2026-01-20_END -->

# 2026-01-19
<!-- DAILY_CHECKIN_2026-01-19_START -->




## SolidityåŸºç¡€è¯­æ³•

### åŸºç¡€æ•°æ®ç±»å‹

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Primitives {

    bool public boo = true;

    uint8 public u8 = 1;
    uint256 public u256 = 456;
    uint public u = 123; // uint æ˜¯ uint256 çš„åˆ«å (å³é»˜è®¤å°±æ˜¯ 256 ä½)

    int8 public i8 = -1;
    int256 public i256 = 456;
    int public i = -123; // int ä¸ int256 ç›¸åŒ

    // int çš„æœ€å°å€¼å’Œæœ€å¤§å€¼
    int256 public minInt = type(int256).min;
    int256 public maxInt = type(int256).max;

    address public addr = 0xCA35b7d915458EF540aDe6068dFe2F44E8fa733c;

    /*
    åœ¨ Solidity ä¸­ï¼Œbyte æ•°æ®ç±»å‹ä»£è¡¨å­—èŠ‚åºåˆ—ã€‚
    Solidity æä¾›ä¸¤ç§ç±»å‹çš„å­—èŠ‚æ•°ç»„ï¼š

     - å®šé•¿å­—èŠ‚æ•°ç»„ (fixed-sized byte arrays)
     - åŠ¨æ€å­—èŠ‚æ•°ç»„ (dynamically-sized byte arrays)
     
     Solidity ä¸­çš„æœ¯è¯­ bytes (å¸¦s) ä»£è¡¨åŠ¨æ€å­—èŠ‚æ•°ç»„ã€‚
     å®ƒæ˜¯ byte[] çš„ç®€å†™ã€‚
    */
    bytes1 a = 0xb5; //  [10110101]
    bytes1 b = 0x56; //  [01010110]

    // é»˜è®¤å€¼
    // æœªèµ‹å€¼çš„å˜é‡ä¼šè‡ªåŠ¨æ‹¥æœ‰ä¸€ä¸ªé»˜è®¤å€¼
    bool public defaultBoo; // é»˜è®¤å€¼ä¸º false
    uint256 public defaultUint; // é»˜è®¤å€¼ä¸º 0
    int256 public defaultInt; // é»˜è®¤å€¼ä¸º 0
    address public defaultAddr; // é»˜è®¤å€¼ä¸º 0x0000000000000000000000000000000000000000
}
```

åªæœ‰æ•´æ•°ï¼Œæ²¡æœ‰å°æ•°

ç¼–è¾‘å™¨ä¼šè¦æ±‚å…ˆå£°æ˜ç‰ˆæƒï¼Œä¸€èˆ¬ä½¿ç”¨ä¸‹é¢è¿™ä¸ªï¼Œæ„æ€æ˜¯è°éƒ½èƒ½ç”¨ï¼Œå‡ºäº‹ä¸ç®¡

```Solidity
// SPDX-License-Identifier: MIT
```

ä¹‹åè¦å£°æ˜ solidity çš„ç‰ˆæœ¬

-   `pragma solidity ^0.8.0;`å…è®¸ 0.8.x ç³»åˆ—çš„æ‰€æœ‰ç‰ˆæœ¬
    
-   `pragma solidity 0.8.19;`**é”æ­»ç‰ˆæœ¬**ï¼Œå¿…é¡»æ˜¯ 0.8.19
    
-   `pragma solidity >=0.7.0 <0.9.0;`èŒƒå›´æ›´å¹¿ï¼Œè·¨è¶Šå¤§ï¼Œæ„æ€æ˜¯è¦ç‰ˆæœ¬åœ¨ 0.7.0 ä»¥ä¸Šï¼Œ 0.9.0 ä»¥ä¸‹
    

Gas è´¹ç”¨æ˜¯æ ¹æ®ä½ åœ¨æœ¬æ¬¡äº¤æ˜“ä¸­è§¦ç¢°åˆ°çš„**æœ€å¤§å†…å­˜ä½ç½®ï¼ˆMax Offsetï¼‰** æ¥è®¡ç®—çš„ã€‚

-   å¦‚æœä½ æ›¾ç»ç”¨åˆ°äº†ç¬¬ 128KB çš„ä½ç½®ï¼Œç³»ç»Ÿå°±è®°ä½äº†â€œè¿™ä¸ªç”¨æˆ·ç”¨äº† 128KBâ€ã€‚
    
-   **ä½ ä¸éœ€è¦ä¸ºå·²ç»ä¹°è¿‡çš„ç©ºé—´å†æ¬¡ä»˜è´¹**ã€‚
    

ä½†æ˜¯ï¼Œsolidity ä¸­æ— æ³•é‡Šæ”¾å†…å­˜ï¼Œ

**çœ‹çœ‹ä½ çš„åœºæ™¯åœ¨ Solidity é‡Œé€šè¿‡** `new` **å…³é”®å­—æ˜¯å¦‚ä½•å®é™…å‘ç”Ÿçš„ï¼š**

1.  **ç¬¬ä¸€æ­¥ï¼š** ç”³è¯· 128KB æ•°ç»„ `Array A`ã€‚
    
    1.  å†…å­˜æŒ‡é’ˆä» `0` ç§»åˆ°äº† `128KB`ã€‚
        
    2.  **è´¹ç”¨ï¼š** æ”¯ä»˜ 128KB çš„ Gasã€‚
        
2.  **ç¬¬äºŒæ­¥ï¼š** ä½ â€œé‡Šæ”¾â€äº† `Array A` (æ¯”å¦‚ `delete a` æˆ–è€…ç¦»å¼€äº†å‡½æ•°ä½œç”¨åŸŸ)ã€‚
    
    1.  **æ®‹é…·çš„ç°å®ï¼š** å†…å­˜æŒ‡é’ˆ**ä¾ç„¶åœç•™åœ¨ 128KB**ã€‚Solidity ä¸ä¼šæŠŠæŒ‡é’ˆæ‹¨å›å»ï¼Œå®ƒåªæ˜¯å¿˜æ‰äº†å˜é‡ `a` è€Œå·²ã€‚
        
3.  **ç¬¬ä¸‰æ­¥ï¼š** ç”³è¯· 64KB æ•°ç»„ `Array B`ã€‚
    
    1.  Solidity ä¼šä»æŒ‡é’ˆå½“å‰çš„ä½ç½®ï¼ˆ128KBï¼‰å¼€å§‹å¾€ååˆ†é…ã€‚
        
    2.  æ–°çš„æŒ‡é’ˆä½ç½® = `128KB + 64KB` = **192KB**ã€‚
        
    3.  **è´¹ç”¨ï¼š** ä½ ä¸ä»…æ²¡æœ‰â€œå…è´¹â€ï¼Œåè€Œå› ä¸ºä¸ä»…æ‰©å®¹äº†ï¼ˆä» 128 åˆ° 192ï¼‰ï¼Œè€Œä¸”è¿™éƒ¨åˆ†æ‰©å®¹è¿˜æ˜¯å¤„äº**æ›´æ˜‚è´µçš„äºŒæ¬¡æ–¹è®¡è´¹åŒºé—´**ï¼Œæ‰€ä»¥ Gas è´¹æ›´è´µäº†ï¼
        

ä½†æ˜¯å¯ä»¥é€šè¿‡ç§»åŠ¨ç©ºé—²å†…å­˜æŒ‡é’ˆçš„æ–¹æ³•é‡å¤åˆ©ç”¨ç©ºé—´

```Solidity
function reuseMemory() public pure {
    // 1. æ­£å¸¸ç”³è¯·å†…å­˜
    uint[] memory a = new uint[](100); // æŒ‡é’ˆç§»åˆ°äº†åé¢
    
    // ... ç”¨å®Œäº† a ...

    // 2. ã€å…³é”®ã€‘æ‰‹åŠ¨æŠŠâ€œç©ºé—²å†…å­˜æŒ‡é’ˆâ€æ‹¨å›å»ï¼
    // 0x40 æ˜¯ Solidity è®°å½•â€œä¸‹ä¸€ä¸ªç©ºé—²å†…å­˜ä½ç½®åœ¨å“ªé‡Œâ€çš„ç‰¹æ®Šåœ°å€
    assembly {
        // å¼ºåˆ¶å‘Šè¯‰ EVMï¼šç°åœ¨çš„ç©ºé—²ä½ç½®æ˜¯åˆå§‹ä½ç½® (æ¯”å¦‚ 0x80)ï¼Œå¿½ç•¥åˆšæ‰ç”³è¯·çš„ a
        mstore(0x40, 0x80) 
    }

    // 3. å†æ¬¡ç”³è¯·å†…å­˜
    uint[] memory b = new uint[](50); 
    // è¿™æ¬¡ b ä¼šç›´æ¥è¦†ç›–ä¹‹å‰ a çš„ä½ç½®ã€‚
    // å› ä¸ºæœ€å¤§å†…å­˜ä½ç½®æ²¡æœ‰è¶…è¿‡ä¹‹å‰çš„ä¸Šé™ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥æ˜¯ã€å…è´¹ã€‘çš„ï¼ˆæŒ‡æ‰©å±•æˆæœ¬ä¸º0ï¼‰ã€‚
}
```

### å®šä¹‰å˜é‡

Solidity ä¸­å˜é‡åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§

-   Local åœ¨å‡½æ•°å†…éƒ¨å£°æ˜ï¼Œä¸å­˜å‚¨åœ¨é“¾ä¸Šï¼Œä¾¿å®œ
    
-   State åœ¨å‡½æ•°å¤–éƒ¨å£°æ˜ï¼Œå­˜å‚¨åœ¨é“¾ä¸Šï¼Œè´µ
    
-   Global æä¾›æœ‰å…³åŒºå—é“¾çš„ä¿¡æ¯ï¼Œå…¶å®å°±æ˜¯é€šè¿‡æ¥å£è·å–ä¸€äº›å…¨å±€çš„ä¿¡æ¯
    

```Solidity
contract Variables {
    // ã€çŠ¶æ€å˜é‡ (State Variables)ã€‘
    // çŠ¶æ€å˜é‡å­˜å‚¨åœ¨åŒºå—é“¾ä¸Šã€‚
    // (ç‰¹ç‚¹ï¼šå†™å…¥éœ€è¦æ¶ˆè€—è¾ƒé«˜çš„ Gasï¼Œæ•°æ®æ°¸ä¹…å­˜åœ¨ï¼Œç›´åˆ°åˆçº¦é”€æ¯)
    string public text = "Hello";
    uint256 public num = 123;

    function doSomething() public view {
        // ã€å±€éƒ¨å˜é‡ (Local Variables)ã€‘
        // å±€éƒ¨å˜é‡ä¸ä¼šä¿å­˜åˆ°åŒºå—é“¾ä¸Šã€‚
        // (ç‰¹ç‚¹ï¼šåªåœ¨å‡½æ•°æ‰§è¡Œçš„ç¬é—´å­˜åœ¨ï¼Œå‡½æ•°è·‘å®Œå°±é”€æ¯ï¼Œä¸å é“¾ä¸Šç©ºé—´ï¼Œå¾ˆä¾¿å®œ)
        uint256 i = 456;

        // ã€å…¨å±€å˜é‡ (Global Variables)ã€‘
        // è¿™é‡Œåˆ—å‡ºäº†ä¸€äº›å…¨å±€å˜é‡
        // (ç‰¹ç‚¹ï¼šè¿™æ˜¯ Solidity æä¾›çš„â€œå†…ç½®ä¿¡æ¯â€ï¼Œä½ å¯ä»¥ç›´æ¥è¯»å–å½“å‰é“¾çš„çŠ¶æ€)
        
        uint256 timestamp = block.timestamp; // å½“å‰åŒºå—çš„æ—¶é—´æˆ³ (å³ï¼šè¿™ä¸ªåŒºå—æ˜¯å‡ ç‚¹å‡ åˆ†è¢«æŒ–å‡ºæ¥çš„)
        address sender = msg.sender; // è°ƒç”¨è€…çš„åœ°å€ (å³ï¼šæ˜¯è°å‘èµ·äº†è¿™ç¬”äº¤æ˜“/è°ç‚¹äº†æŒ‰é’®)
    }
}
```

å¸¸é‡ï¼Œç¡¬ç¼–ç ï¼Œä¸å ç”¨å†…å­˜

```Solidity
contract Constants {
    // å¸¸é‡å…¨ç”¨å¤§å†™
    address public constant MY_ADDRESS =
        0x777788889999AaAAbBbbCcccddDdeeeEfFFfCcCc;
    uint256 public constant MY_UINT = 123;
}
```

ä¸å¯å˜å˜é‡

```Solidity
contract Immutable {
    // ç¼–ç è§„èŒƒï¼šå¸¸é‡ï¼ˆå’Œä¸å¯å˜é‡ï¼‰é€šå¸¸ä½¿ç”¨å…¨å¤§å†™å­—æ¯å‘½å
    // è¿™æ ·åšæ˜¯ä¸ºäº†è®©è¯»è€…ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼šè¿™ä¸ªå˜é‡æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„
    address public immutable MY_ADDRESS;
    uint256 public immutable MY_UINT;

    // æ„é€ å‡½æ•°ï¼šåˆçº¦éƒ¨ç½²æ—¶æ‰§è¡Œ
    constructor(uint256 _myUint) {
        // åœ¨è¿™é‡Œè¿›è¡Œèµ‹å€¼ã€‚
        // æ³¨æ„ï¼šè¿™æ˜¯ä¸å¯å˜é‡ (immutable) å”¯ä¸€ä¸€æ¬¡å¯ä»¥è¢«èµ‹å€¼çš„æœºä¼šï¼
        MY_ADDRESS = msg.sender;
        MY_UINT = _myUint;
    }
}
```

ä¸€èˆ¬ä¸å¯å˜å˜é‡éƒ½æ˜¯ state çš„ï¼Œåœ¨éƒ¨ç½²åˆçº¦çš„åŒæ—¶è®°å½•ä¸€äº›ä¿¡æ¯ç”¨

åœ¨åˆçº¦éƒ¨ç½²çš„é‚£ä¸€ç¬é—´ï¼ŒEVM ä¼šæŠŠå®ƒçš„å€¼ç›´æ¥ **â€œç¡¬ç¼–ç â€ (Hardcode)** è¿›åˆçº¦çš„**ä»£ç é€»è¾‘ (Bytecode)** é‡Œã€‚

è¯»å†™çŠ¶æ€å˜é‡

```Solidity
contract SimpleStorage {
    // ã€çŠ¶æ€å˜é‡ã€‘
    // ç”¨äºå­˜å‚¨ä¸€ä¸ªæ•°å­—ã€‚å®ƒä¼šæ°¸ä¹…ä¿å­˜åœ¨åŒºå—é“¾ä¸Šã€‚
    uint256 public num;

    // ã€å†™æ“ä½œã€‘
    // ä½ å¿…é¡»å‘é€ä¸€ç¬”â€œäº¤æ˜“â€ (Transaction) æ‰èƒ½ä¿®æ”¹çŠ¶æ€å˜é‡ã€‚
    // è¿™æ„å‘³ç€ï¼šéœ€è¦æ¶ˆè€— Gasï¼Œä¸”éœ€è¦ç­‰å¾…çŸ¿å·¥æ‰“åŒ…ç¡®è®¤ã€‚
    function set(uint256 _num) public {
        num = _num;
    }

    // ã€è¯»æ“ä½œã€‘
    // ä½ å¯ä»¥åœ¨â€œä¸å‘é€äº¤æ˜“â€çš„æƒ…å†µä¸‹è¯»å–çŠ¶æ€å˜é‡ã€‚
    // è¿™æ„å‘³ç€ï¼šå…è´¹ï¼Œä¸”ç«‹åˆ»è¿”å›ç»“æœã€‚
    function get() public view returns (uint256) {
        return num;
    }
}
```

1 `ether` = 10^18 `wei`

**Giga-wei** = 10^9 wei

### æ­»å¾ªç¯å¤ªçƒ§äº†

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=N2VjYmM2ZGIzMzUzMmZlMDIxNjBhMjkxODAwOTExOWRfaWZKaEs3ZUJxOEttQzJGMFlCZnhsNnJnUjNleWNCd3BfVG9rZW46QUd6T2Jhclpxb3NaVlJ4VXpsaWNuU2VRbnF5XzE3Njg4Mjc4OTg6MTc2ODgzMTQ5OF9WNA)

### If else ä¸ç”¨çœ‹

```Solidity
contract IfElse {
    function foo(uint256 x) public pure returns (uint256) {
        if (x < 10) {
            return 0;
        } else if (x < 20) {
            return 1;
        } else {
            return 2;
        }
    }

    function ternary(uint256 _x) public pure returns (uint256) {
        return _x < 10 ? 1 : 2;
    }
}
```

### ç„¶åæ˜¯ for å’Œ whileï¼ŒåŸºæœ¬ä¸Šè·Ÿ cpp ä¸€æ ·

```Solidity
contract Loop {
    function loop() public {
        // for loop
        for (uint256 i = 0; i < 10; i++) {
            if (i == 3) {
                continue;
            }
            if (i == 5) {
                break;
            }
        }
        uint256 j;
        while (j < 10) {
            j++;
        }
    }
}
```

### ç„¶åæ˜¯ struct

ç»“æ„ä½“å¯ä»¥åœ¨åˆçº¦å¤–éƒ¨å£°æ˜ï¼Œå¹¶åœ¨å¦ä¸€ä¸ªåˆçº¦ä¸­å¯¼å…¥ã€‚

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Todos {
    struct Todo {
        string text;      
        bool completed;   
    }

    // ã€ç»“æ„ä½“æ•°ç»„ã€‘
    // è¿™æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œé‡Œé¢å­˜çš„å…¨æ˜¯ Todo ç±»å‹çš„æ•°æ®
    Todo[] public todos;

    function create(string calldata _text) public {
        // ã€3ç§åˆå§‹åŒ–ç»“æ„ä½“çš„æ–¹æ³•ã€‘
        
        // æ–¹æ³• 1: åƒå‡½æ•°è°ƒç”¨ä¸€æ · (æ¨èç”¨äºå­—æ®µå°‘çš„ç»“æ„ä½“)
        todos.push(Todo(_text, false));

        // æ–¹æ³• 2: é”®å€¼å¯¹æ˜ å°„ (Key-value mapping) â€”â€” ã€æœ€æ¨èã€‘
        todos.push(Todo({text: _text, completed: false}));

        // æ–¹æ³• 3: å…ˆåˆå§‹åŒ–ä¸€ä¸ªç©ºçš„ï¼Œå†æ‰‹åŠ¨èµ‹å€¼
        Todo memory todo;
        todo.text = _text;
        // todo.completed é»˜è®¤å°±æ˜¯ falseï¼Œæ‰€ä»¥ä¸å†™ä¹Ÿè¡Œ
        todos.push(todo); // æœ€åæŠŠå®ƒæ¨å…¥æ•°ç»„ï¼ˆæ‹·è´è¿› Storageï¼‰
    }

    // Solidity ä¼šè‡ªåŠ¨ä¸º public çš„æ•°ç»„ç”Ÿæˆè¯»å–å‡½æ•°ï¼Œ
    // æ‰€ä»¥å…¶å®ä½ ä¸éœ€è¦æ‰‹å†™ä¸‹é¢è¿™ä¸ª get å‡½æ•°ã€‚
    // ä½†è¿™ä¸ªå‡½æ•°å±•ç¤ºäº†å¦‚ä½•æ‰‹åŠ¨è§£æ„è¿”å›æ•°æ®ã€‚
    function get(uint256 _index)
        public
        view
        returns (string memory text, bool completed)
    {
        // ä»æ•°ç»„é‡Œå–å‡ºç¬¬ _index ä¸ªä»»åŠ¡
        // æ³¨æ„ï¼šè¿™é‡Œç”¨äº† storageï¼Œä½†åªæ˜¯ä¸ºäº†è¯»å–
        Todo storage todo = todos[_index];
        return (todo.text, todo.completed);
    }

    // ã€ä¿®æ”¹ä»»åŠ¡å†…å®¹ã€‘
    function updateText(uint256 _index, string calldata _text) public {
        // å…³é”®ç‚¹ï¼šã€storageã€‘å…³é”®å­—ï¼
        // è¿™æ„å‘³ç€ `todo` æ˜¯ä¸€ä¸ªæŒ‡å‘é“¾ä¸Šæ•°æ®çš„â€œæŒ‡é’ˆâ€ã€‚
        // ä¿®æ”¹ `todo.text` ä¼šç›´æ¥ä¿®æ”¹åŒºå—é“¾ä¸Šçš„åŸå§‹æ•°æ®ã€‚
        Todo storage todo = todos[_index];
        todo.text = _text;
    }

    // ã€åˆ‡æ¢å®ŒæˆçŠ¶æ€ã€‘
    function toggleCompleted(uint256 _index) public {
        Todo storage todo = todos[_index];
        // å–åï¼šå¦‚æœæ˜¯ true å˜ falseï¼Œå¦‚æœæ˜¯ false å˜ true
        todo.completed = !todo.completed;
    }
}
```

å…³äºè¿™ä¸ª get å‡½æ•°

```Solidity
    function get(uint256 _index)
        public
        view
        returns (string memory text, bool completed){
        Todo storage todo = todos[_index];
        return (todo.text, todo.completed);
    }
```

View æ„æ€æ˜¯è¯´è¿™ä¸ªå‡½æ•°æ˜¯ åªè¯» çš„ï¼ŒåŒæ—¶æ„å‘³ç€ä¸ä¼šäº§ç”Ÿå¤ªå¤šå¼€é”€ï¼ˆä¸ºä»€ä¹ˆè¦æ˜¾ç¤ºå†™æ˜ viewï¼Ÿï¼‰

> é™¤äº†â€œåªè¯»â€ï¼Œå†™æ˜ `view` è¿˜æœ‰ä¸¤ä¸ªæ ¸å¿ƒä½œç”¨ï¼š
> 
> 1.  **å®‰å…¨é” (Compiler Safety)ï¼š** è¿™æ˜¯ä¸€ä¸ªç»™ç¼–è¯‘å™¨çš„æ‰¿è¯ºã€‚å¦‚æœä½ åœ¨ `view` å‡½æ•°é‡Œä¸å°å¿ƒå†™äº†ä¿®æ”¹æ•°æ®çš„ä»£ç ï¼ˆæ¯”å¦‚ `i += 1`ï¼‰ï¼Œ**ç¼–è¯‘å™¨ä¼šç›´æ¥æŠ¥é”™**ï¼Œé˜»æ­¢ä½ ç¼–è¯‘é€šè¿‡ã€‚å®ƒé˜²æ­¢äº†ç¨‹åºå‘˜çŠ¯å‚»ã€‚
>     
> 2.  **å‰ç«¯äº¤äº’ (ABI Interface)ï¼š** è¿™ä¸€ç‚¹è‡³å…³é‡è¦ã€‚å½“ Remixã€MetaMask æˆ–å‰ç«¯ä»£ç ï¼ˆWeb3.jsï¼‰çœ‹åˆ° `view` æ ‡ç­¾æ—¶ï¼Œå®ƒä»¬å°±çŸ¥é“ï¼š**â€œè¿™ä¸ªæ“ä½œä¸éœ€è¦æ¶ˆè€— Gasï¼Œä¸éœ€è¦å¼¹å‡ºå°ç‹ç‹¸é’±åŒ…è®©ç”¨æˆ·ç­¾åï¼Œç›´æ¥åœ¨æœ¬åœ°èŠ‚ç‚¹è¯»å–å³å¯ã€‚â€** å¦‚æœä¸å†™ `view`ï¼Œå‰ç«¯å¯èƒ½ä¼šæŠŠå®ƒå½“æˆä¸€ç¬”äº¤æ˜“ï¼Œå»æ”¶ç”¨æˆ·çš„ Gas è´¹ã€‚
>     

`Todo storage todo = todos[_index];`è¿™ä¸€å¥c

Solidity æœ‰äº›æ—¶å€™è¦å†™æ˜å˜é‡çš„å­˜å‚¨ä½ç½®

è¿™ä¸€å¥å·®ä¸å¤šæ„æ€æ˜¯å®šä¹‰äº†ä¸€ä¸ªå­˜å‚¨åœ¨åŒºé“¾ä¸Šçš„å˜é‡çš„ç´¢å¼•

ç±»å‹ æ˜¯ Todo storage ï¼Œ å˜é‡åæ˜¯ todo

ç„¶åå‡½æ•°è¿”å›å€¼ä¸­çš„`string memory text`

æ„æ€æ˜¯ è¿”å›å€¼æ˜¯ä¸´æ—¶å­˜æ”¾åœ¨ å†…å­˜ä¸­ çš„ï¼Œè€Œä¸æ˜¯å­˜æ”¾åœ¨ é“¾ä¸Š çš„

ä¸ºä»€ä¹ˆ \_index completed è¿™äº›å˜é‡æ²¡å†™ï¼Ÿ

å› ä¸ºå¯¹äº`uint`, `int`, `bool`, `address`, `bytes1`~`bytes32`è¿™äº›æ•°æ®ç±»å‹ï¼Œæ•°æ®é‡å¾ˆå°ï¼Œé•¿åº¦å›ºå®šï¼Œå®ƒä»¬é»˜è®¤é€šè¿‡**å€¼æ‹·è´**çš„æ–¹å¼ä¼ é€’ï¼Œé€šå¸¸ç›´æ¥æ”¾åœ¨ EVM çš„**æ ˆ (Stack)** ä¸Šã€‚å› ä¸ºå¤ªç®€å•äº†ï¼Œç¼–è¯‘å™¨ä¸éœ€è¦ä½ æ“å¿ƒå®ƒä»¬çš„ä½ç½®ã€‚**æ‰€ä»¥ä¸éœ€è¦ï¼ˆä¹Ÿä¸èƒ½ï¼‰å†™å…³é”®å­—ã€‚**

åé¢è¿™ä¸ªå‡½æ•°

```Solidity
    // ã€ä¿®æ”¹ä»»åŠ¡å†…å®¹ã€‘
    function updateText(uint256 _index, string calldata _text) public {
        Todo storage todo = todos[_index];
        todo.text = _text;
    }
```

ä½¿ç”¨äº† `calldata` å…³é”®å­—ï¼Œæ„æ€æ˜¯è¿™ä¸ªå˜é‡æ˜¯ç›´æ¥å¼•ç”¨äº†ã€äº¤æ˜“çš„åŸå§‹è¾“å…¥æ•°æ®ã€‘ï¼Œè€Œä¸æ˜¯æŠŠå®ƒå¤åˆ¶åˆ°å†…å­˜é‡Œã€‚å®ƒæ˜¯åªè¯»çš„ï¼Œä¸”æœ€çœ Gasã€‚

ç„¶åå¯ä»¥è°ƒç”¨åˆ«çš„ sol æ–‡ä»¶ä¸­çš„æ•°æ®ç»“æ„

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;
// This is saved 'StructDeclaration.sol'

struct Todo {
    string text;
    bool completed;
}
```

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

import "./StructDeclaration.sol";

contract Todos {
    // An array of 'Todo' structs
    Todo[] public todos;
}
```

### è‡ªå®šæ•°æ®ç±»å‹ï¼Œæˆ–è€…è¯´ç»™æ•°æ®ç±»å‹èµ·åˆ«å

ç„¶åå¯ä»¥è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œé˜²æ­¢å¼ å† ææˆ´ï¼Œä¹Ÿå¯ä»¥å®ç°åº•å±‚ä½æ“ä½œèŠ‚çœGasï¼Œç›´æ¥çœ‹ä¸‹é¢è¿™ä¸ªä»£ç å§

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

// Code copied from optimism
// https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts-bedrock/src/dispute/lib/LibUDT.sol

type Duration is uint64;

type Timestamp is uint64;

type Clock is uint128;

library LibClock {
    function wrap(Duration _duration, Timestamp _timestamp)
        internal
        pure
        returns (Clock clock_)
    {
        assembly {
            // data | Duration | Timestamp
            // bit  | 0 ... 63 | 64 ... 127
            clock_ := or(shl(0x40, _duration), _timestamp)
        }
    }

    function duration(Clock _clock)
        internal
        pure
        returns (Duration duration_)
    {
        assembly {
            duration_ := shr(0x40, _clock)
        }
    }

    function timestamp(Clock _clock)
        internal
        pure
        returns (Timestamp timestamp_)
    {
        assembly {
            timestamp_ := shr(0xC0, shl(0xC0, _clock))
        }
    }
}

// Clock library without user defined value type
library LibClockBasic {
    function wrap(uint64 _duration, uint64 _timestamp)
        internal
        pure
        returns (uint128 clock)
    {
        assembly {
            clock := or(shl(0x40, _duration), _timestamp)
        }
    }
}

contract Examples {
    function example_no_uvdt() external {
        // Without UDVT
        uint128 clock;
        uint64 d = 1;
        uint64 t = uint64(block.timestamp);
        clock = LibClockBasic.wrap(d, t);
        // Oops! wrong order of inputs but still compiles
        clock = LibClockBasic.wrap(t, d);
    }

    function example_uvdt() external {
        // Turn value type into user defined value type
        Duration d = Duration.wrap(1);
        Timestamp t = Timestamp.wrap(uint64(block.timestamp));
        // Turn user defined value type back into primitive value type
        uint64 d_u64 = Duration.unwrap(d);
        uint64 t_u54 = Timestamp.unwrap(t);

        // LibClock example
        Clock clock = Clock.wrap(0);
        clock = LibClock.wrap(d, t);
        // Oops! wrong order of inputs
        // This will not compile
        // clock = LibClock.wrap(t, d);
    }
}
```

### Mappingï¼Œä¸å¯è¿­ä»£

ç®€å•æ¥è¯´å°±æ˜¯é”®å€¼å¯¹

```Solidity
contract Mapping {
    // ã€å®šä¹‰æ˜ å°„ã€‘
    // è¯­æ³•ï¼šmapping(KeyType => ValueType)
    // è¿™é‡Œæ˜¯å»ºç«‹ä¸€ä¸ªä» "åœ°å€ (address)" åˆ° "æ•°å­— (uint)" çš„æ˜ å°„
    // å…¸å‹åœºæ™¯ï¼šå­˜å‚¨æ¯ä¸ªç”¨æˆ·çš„ä»£å¸ä½™é¢
    mapping(address => uint256) public myMap;

    function get(address _addr) public view returns (uint256) {
        return myMap[_addr];
    }
    function set(address _addr, uint256 _i) public {
        // Mapping æ°¸è¿œä¼šè¿”å›ä¸€ä¸ªå€¼ã€‚
        // å¦‚æœè¿™ä¸ªé”® (key) ä»æ¥æ²¡æœ‰è¢«è®¾ç½®è¿‡ï¼Œå®ƒä¼šè¿”å›è¯¥ç±»å‹çš„ã€é»˜è®¤å€¼ã€‘ã€‚
        // å¯¹äº uint æ¥è¯´ï¼Œé»˜è®¤å€¼æ˜¯ 0ã€‚
        myMap[_addr] = _i;
    }

    function remove(address _addr) public {
        // å°†è¯¥åœ°å€å¯¹åº”çš„å€¼é‡ç½®ä¸ºé»˜è®¤å€¼ (0)ã€‚
        // æ³¨æ„ï¼šå®ƒä¸æ˜¯ä»å†…å­˜ä¸­â€œç§»é™¤â€è¿™ä¸ªé”®ï¼Œè€Œæ˜¯æŠŠå€¼æ¸…é›¶ã€‚
        delete myMap[_addr];
    }
}

contract NestedMapping {
    // ã€åµŒå¥—æ˜ å°„ (Nested Mapping)ã€‘
    // æ˜ å°„å¥—æ˜ å°„ (ä» address æ˜ å°„åˆ° å¦ä¸€ä¸ªæ˜ å°„)
    // ç»“æ„ï¼šåœ°å€ -> (ID -> æ˜¯å¦å®Œæˆ)
    // å…¸å‹åœºæ™¯ï¼šæ£€æŸ¥æŸä¸ªç”¨æˆ·(address) æ˜¯å¦å®Œæˆäº† ç¬¬Né¡¹ä»»åŠ¡(uint)
    mapping(address => mapping(uint256 => bool)) public nested;

    function get(address _addr1, uint256 _i) public view returns (bool) {
        // ä½ å¯ä»¥ä»åµŒå¥—æ˜ å°„ä¸­è·å–å€¼
        // å³ä½¿å®ƒæ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œä¹Ÿä¼šè¿”å› false (bool çš„é»˜è®¤å€¼)
        return nested[_addr1][_i];
    }

    function set(address _addr1, uint256 _i, bool _boo) public {
        // å†™å…¥åµŒå¥—æ˜ å°„ï¼šåƒäºŒç»´æ•°ç»„ä¸€æ ·æ“ä½œ
        nested[_addr1][_i] = _boo;
    }

    function remove(address _addr1, uint256 _i) public {
        // é‡ç½®åµŒå¥—æ˜ å°„ä¸­çš„æŸä¸€ä¸ªå…·ä½“çš„å€¼
        delete nested[_addr1][_i];
    }
```

### Array

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Array {
    // ã€åˆå§‹åŒ–æ•°ç»„çš„å‡ ç§æ–¹å¼ã€‘
    // åŠ¨æ€æ•°ç»„ï¼šé•¿åº¦ä¸å›ºå®šï¼Œå¯ä»¥éšæ—¶å¢åŠ æˆ–å‡å°‘
    uint256[] public arr;
    // åˆå§‹åŒ–æ—¶è¿™å°±èµ‹å€¼ï¼šåŒ…å« 1, 2, 3 çš„åŠ¨æ€æ•°ç»„
    uint256[] public arr2 = [1, 2, 3];
    
    // å®šé•¿æ•°ç»„ï¼šé•¿åº¦å›ºå®šä¸º 10ï¼Œä¸èƒ½ push æˆ– pop
    // åˆå§‹åŒ–æ—¶æ‰€æœ‰å…ƒç´ é»˜è®¤éƒ½æ˜¯ 0
    uint256[10] public myFixedSizeArr;

    function get(uint256 i) public view returns (uint256) {
        return arr[i];
    }

    // Solidity å¯ä»¥è¿”å›æ•´ä¸ªæ•°ç»„ã€‚
    // ã€è­¦å‘Šã€‘å¦‚æœæ•°ç»„é•¿åº¦å¯èƒ½æ— é™å¢é•¿ï¼Œåº”é¿å…ä½¿ç”¨æ­¤å‡½æ•°ã€‚
    // å› ä¸ºå¦‚æœæ•°ç»„å¤ªå¤§ï¼Œè¿”å›å®ƒä¼šæ¶ˆè€—è¿‡å¤š Gasï¼Œç”šè‡³å¯¼è‡´äº¤æ˜“å¤±è´¥ã€‚
    function getArr() public view returns (uint256[] memory) {
        return arr;
    }

    function push(uint256 i) public {
        // å°† i æ·»åŠ åˆ°æ•°ç»„æœ«å°¾ï¼Œæ•°ç»„é•¿åº¦ +1
        arr.push(i);
    }

    function pop() public {
        // ç§»é™¤æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ•°ç»„é•¿åº¦ -1
        arr.pop();
    }

    function getLength() public view returns (uint256) {
        return arr.length;
    }

    function remove(uint256 index) public {
        // ã€æ³¨æ„ã€‘delete å…³é”®å­—å¹¶ä¸ä¼šæ”¹å˜æ•°ç»„é•¿åº¦ï¼
        // å®ƒåªæ˜¯å°† index ä½ç½®çš„å€¼é‡ç½®ä¸ºé»˜è®¤å€¼ã€‚
        // åœ¨è¿™é‡Œï¼Œarr[index] ä¼šå˜æˆ 0ï¼Œä½†æ•°ç»„é•¿åº¦ä¸å˜ã€‚
        delete arr[index];
    }

    function examples() external pure {
        // ã€å†…å­˜æ•°ç»„ã€‘
        // åœ¨å†…å­˜ä¸­åˆ›å»ºæ•°ç»„ï¼Œå¿…é¡»æŒ‡å®šé•¿åº¦ï¼ˆè¿™é‡Œæ˜¯5ï¼‰ã€‚
        // å†…å­˜ä¸­ä¸èƒ½åˆ›å»ºå˜é•¿æ•°ç»„ï¼ˆä¸èƒ½ push/popï¼‰ã€‚
        uint256[] memory a = new uint256[](5);
        // æ›´æ–°å†…å­˜æ•°ç»„çš„å€¼
        a[1] = 123;
    }
}
```

Solidity å››ç§å¯è§æ€§ä¿®é¥°ç¬¦ï¼ˆ`public`, `private`, `internal`, `external`ï¼‰ï¼Œç”¨æ¥å®šä¹‰å‡½æ•°çš„ ã€è°ƒç”¨æƒé™ã€‘ï¼ˆå³ï¼šè°æœ‰èµ„æ ¼è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼‰

Â Â **public (å…¬å¼€çš„)**ï¼š

-   **æƒé™**ï¼š**æ‰€æœ‰äºº**éƒ½å¯ä»¥è°ƒç”¨ã€‚
    
-   **èŒƒå›´**ï¼šåˆçº¦**å†…éƒ¨**å¯ä»¥è°ƒï¼Œåˆçº¦**å¤–éƒ¨**ï¼ˆç”¨æˆ·é’±åŒ…ã€å…¶ä»–åˆçº¦ï¼‰ä¹Ÿå¯ä»¥è°ƒã€‚
    
-   _æ³¨æ„ï¼šå˜é‡ä¹Ÿå¯ä»¥è®¾ä¸º publicï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆ getter å‡½æ•°ã€‚_
    

Â Â **private (ç§æœ‰çš„)**ï¼š

-   **æƒé™**ï¼š**åªæœ‰å½“å‰åˆçº¦è‡ªå·±**å¯ä»¥è°ƒç”¨ã€‚
    
-   **èŒƒå›´**ï¼šæœ€ä¸¥æ ¼çš„æƒé™ã€‚è¿**ç»§æ‰¿**äº†è¿™ä¸ªåˆçº¦çš„å­åˆçº¦**éƒ½ä¸èƒ½**è°ƒç”¨ã€‚
    

Â Â **internal (å†…éƒ¨çš„)**ï¼š

-   **æƒé™**ï¼š**è‡ªå·±å’Œâ€œå­©å­ä»¬â€**å¯ä»¥è°ƒç”¨ã€‚
    
-   **èŒƒå›´**ï¼šå½“å‰åˆçº¦å¯ä»¥è°ƒï¼Œ**ç»§æ‰¿**äº†è¯¥åˆçº¦çš„å­åˆçº¦ä¹Ÿå¯ä»¥è°ƒã€‚
    
-   _æ³¨æ„ï¼šè¿™æ˜¯çŠ¶æ€å˜é‡çš„é»˜è®¤å¯è§æ€§ã€‚_
    

Â Â **external (å¤–éƒ¨çš„)**ï¼š

-   **æƒé™**ï¼š**åªæœ‰å¤–éƒ¨**å¯ä»¥è°ƒç”¨ã€‚
    
-   **èŒƒå›´**ï¼šåˆçº¦**å†…éƒ¨ä¸èƒ½**ç›´æ¥è°ƒç”¨ï¼ˆé™¤éç”¨ `this.func()` å¼ºåˆ¶è°ƒç”¨ï¼Œä½†è¿™å¾ˆè´¹é’±ï¼‰ã€‚
    
-   _ä¼˜åŠ¿ï¼šå½“å‚æ•°æ˜¯å¤§å‹æ•°ç»„æ—¶ï¼Œexternal æ¯” public æ›´çœ Gasï¼ˆå› ä¸ºç›´æ¥è¯» calldata ä¸ç”¨æ‹·è´åˆ° memoryï¼‰ã€‚_
    

ä¸‰ç§çŠ¶æ€ä¿®é¥°ç¬¦ï¼ˆ`write`, `view`, `pure`ï¼‰ï¼Œç”¨æ¥å®šä¹‰å‡½æ•°çš„ **ã€åŒºå—é“¾çŠ¶æ€è¯»å†™æƒé™ã€‘ï¼ˆå³ï¼šèƒ½å¦è¯»å–æˆ–ä¿®æ”¹é“¾ä¸Šçš„æ•°æ®ï¼‰**

Â Â **write (é»˜è®¤/æ— å…³é”®å­—)**ï¼š

-   _ï¼ˆæ³¨ï¼šSolidity ä»£ç ä¸­æ²¡æœ‰_ `write` _è¿™ä¸ªå…³é”®å­—ï¼Œä¸å†™ view æˆ– pure å°±æ˜¯é»˜è®¤çŠ¶æ€ï¼‰_
    
-   **æƒé™**ï¼š**å¯è¯» + å¯å†™**ã€‚
    
-   **ä»£ä»·**ï¼šæ‰§è¡Œæ—¶éœ€è¦å‘é€äº¤æ˜“ï¼Œ**æ¶ˆè€— Gas**ã€‚
    
-   _åœºæ™¯ï¼šè½¬è´¦ã€ä¿®æ”¹ä½™é¢ã€æ›´æ–°å˜é‡ã€‚_
    

Â Â **view (æŸ¥çœ‹)**ï¼š

-   **æƒé™**ï¼š**åªè¯» + ä¸å¯å†™**ã€‚
    
-   **ä»£ä»·**ï¼šå¤–éƒ¨è°ƒç”¨æ—¶**å…è´¹**ï¼ˆæœ¬åœ°æŸ¥è¯¢ï¼‰ï¼›å†…éƒ¨è¢«å…¶ä»– write å‡½æ•°è°ƒç”¨æ—¶æ¶ˆè€— Gasã€‚
    
-   _åœºæ™¯ï¼šæŸ¥è¯¢ä½™é¢_ `balanceOf`_ã€æŸ¥è¯¢çŠ¶æ€ã€‚_
    

Â Â **pure (çº¯å‡€)**ï¼š

-   **æƒé™**ï¼š**ä¸è¯» + ä¸å¯å†™**ã€‚
    
-   **ä»£ä»·**ï¼šå¤–éƒ¨è°ƒç”¨æ—¶**å…è´¹**ã€‚
    
-   _åœºæ™¯ï¼šæ•°å­¦è®¡ç®—åº“ï¼ˆå¦‚_ `1+1`_ï¼‰ã€å·¥å…·å‡½æ•°ï¼Œä¸é“¾ä¸ŠçŠ¶æ€å®Œå…¨æ— å…³ã€‚_
    

ç„¶åä¸ºäº†è§£å†³ Array ä¸èƒ½åˆ é™¤çš„é—®é¢˜ï¼Œæœ‰ä»¥ä¸‹ä¸¤ä¸ªè§£å†³æ–¹å¼

ä¸€ä¸ªæ˜¯å°†åé¢åŠæˆªçš„æ•°ç»„å·¦ç§»

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract ArrayRemoveByShifting {
    // [1, 2, 3] -- remove(1) --> [1, 3, 3] --> [1, 3]
    // [1, 2, 3, 4, 5, 6] -- remove(2) --> [1, 2, 4, 5, 6, 6] --> [1, 2, 4, 5, 6]
    // [1, 2, 3, 4, 5, 6] -- remove(0) --> [2, 3, 4, 5, 6, 6] --> [2, 3, 4, 5, 6]
    // [1] -- remove(0) --> [1] --> []

    uint256[] public arr;

    function remove(uint256 _index) public {
        require(_index < arr.length, "index out of bound");

        for (uint256 i = _index; i < arr.length - 1; i++) {
            arr[i] = arr[i + 1];
        }
        arr.pop();
    }

    function test() external {
        arr = [1, 2, 3, 4, 5];
        remove(2);
        // [1, 2, 4, 5]
        assert(arr[0] == 1);
        assert(arr[1] == 2);
        assert(arr[2] == 4);
        assert(arr[3] == 5);
        assert(arr.length == 4);

        arr = [1];
        remove(0);
        // []
        assert(arr.length == 0);
    }
}
```

ä¸€ä¸ªæ˜¯å°†æœ€åä¸€ä¸ªå…ƒç´ ç§»åˆ°åˆ é™¤çš„ä½ç½®

```Solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract ArrayReplaceFromEnd {
    uint256[] public arr;

    // Deleting an element creates a gap in the array.
    // One trick to keep the array compact is to
    // move the last element into the place to delete.
    function remove(uint256 index) public {
        // Move the last element into the place to delete
        arr[index] = arr[arr.length - 1];
        // Remove the last element
        arr.pop();
    }

    function test() public {
        arr = [1, 2, 3, 4];

        remove(1);
        // [1, 4, 3]
        assert(arr.length == 3);
        assert(arr[0] == 1);
        assert(arr[1] == 4);
        assert(arr[2] == 3);

        remove(2);
        // [1, 4]
        assert(arr.length == 2);
        assert(arr[0] == 1);
        assert(arr[1] == 4);
    }
}
```

### Enum

```Solidity
contract Enum {
    // ã€å®šä¹‰æšä¸¾ã€‘
    enum Status {
        Pending,  // å¾…å¤„ç† (å¯¹åº” 0)
        Shipped,  // å·²å‘è´§ (å¯¹åº” 1)
        Accepted, // å·²ç­¾æ”¶ (å¯¹åº” 2)
        Rejected, // å·²æ‹’æ”¶ (å¯¹åº” 3)
        Canceled  // å·²å–æ¶ˆ (å¯¹åº” 4)
    }

    // ã€çŠ¶æ€å˜é‡ã€‘
    // é»˜è®¤å€¼æ˜¯è¯¥ç±»å‹å®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚
    // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œstatus åˆå§‹å€¼å°±æ˜¯ "Pending" (ä¹Ÿå°±æ˜¯ 0)
    Status public status;

    // ã€è¯»å–æšä¸¾ã€‘
    // è™½ç„¶è¿”å›ç±»å‹å†™çš„æ˜¯ Statusï¼Œä½†åœ¨åº•å±‚å’Œ Remix çš„è¾“å‡ºä¸­ï¼Œ
    // å®ƒè¿”å›çš„æ˜¯ uint (æ— ç¬¦å·æ•´æ•°)ã€‚
    // Pending  - 0
    // Shipped  - 1
    // Accepted - 2
    // Rejected - 3
    // Canceled - 4
    function get() public view returns (Status) {
        return status;
    }

    // ã€æ›´æ–°çŠ¶æ€ã€‘
    // ä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ª uint (æ¯”å¦‚ 1)ï¼Œå®ƒä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„ Enum (Shipped)
    // æˆ–è€…ç›´æ¥ä¼ å…¥ Status ç±»å‹
    function set(Status _status) public {
        status = _status;
    }

    // ã€æ›´æ–°ä¸ºç‰¹å®šå€¼ã€‘
    // ä½ å¯ä»¥åƒè¿™æ ·ç›´æ¥å¼•ç”¨æšä¸¾é‡Œçš„æŸä¸ªé€‰é¡¹
    function cancel() public {
        status = Status.Canceled; // æŠŠçŠ¶æ€æ”¹æˆ 4
    }

    // ã€é‡ç½®ã€‘
    // delete ä¼šæŠŠå˜é‡é‡ç½®ä¸ºå®ƒçš„é»˜è®¤å€¼
    // å¯¹äºæšä¸¾æ¥è¯´ï¼Œé»˜è®¤å€¼å°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´  (ç´¢å¼•ä¸º0çš„å…ƒç´ )ï¼Œå³ Pending
    function reset() public {
        delete status;
    }
```

å°±åƒ Struct ä¸€æ ·ï¼ŒEnum ä¹Ÿå¯ä»¥å®šä¹‰åœ¨å•ç‹¬çš„æ–‡ä»¶é‡Œï¼Œæ–¹ä¾¿å¤šä¸ªåˆçº¦å¤ç”¨ã€‚

## Data Locations - Storage, Memory and Calldata

```Solidity
contract DataLocations {
    // å˜é‡è¢«å£°æ˜ä¸º storageã€memory æˆ– calldataï¼Œä»¥æ˜¾å¼æŒ‡å®šæ•°æ®çš„å­˜å‚¨ä½ç½®ã€‚
    // storage  - å˜é‡æ˜¯çŠ¶æ€å˜é‡ï¼ˆå­˜å‚¨åœ¨åŒºå—é“¾ä¸Šï¼Œå°±åƒç¡¬ç›˜ï¼‰
    // memory   - å˜é‡ä½äºå†…å­˜ä¸­ï¼Œä»…åœ¨å‡½æ•°è°ƒç”¨æœŸé—´å­˜åœ¨ï¼ˆå°±åƒ RAMï¼‰
    // calldata - åŒ…å«å‡½æ•°å‚æ•°çš„ç‰¹æ®Šæ•°æ®ä½ç½®ï¼ˆåªè¯»ï¼Œä¸”éå¸¸çœé’±ï¼‰

    uint256[] public arr;
    mapping(uint256 => address) map;
    
    struct MyStruct {
        uint256 foo;
    }
    
    mapping(uint256 => MyStruct) myStructs;

    function f() public {
        // ã€æ ¸å¿ƒæ¼”ç¤º 1ï¼šä¼ é€’ Storage æŒ‡é’ˆã€‘
        // ä½¿ç”¨çŠ¶æ€å˜é‡è°ƒç”¨ _f å‡½æ•°ã€‚
        // æ³¨æ„ï¼šè¿™é‡Œä¼ è¿›å»çš„æ˜¯â€œå¼•ç”¨â€ï¼ˆæŒ‡é’ˆï¼‰ï¼Œä¸æ˜¯æ‹·è´ã€‚
        _f(arr, map, myStructs[1]);

        // ã€æ ¸å¿ƒæ¼”ç¤º 2ï¼šStorage å¼•ç”¨ã€‘
        // ä»æ˜ å°„ä¸­è·å–ä¸€ä¸ªç»“æ„ä½“ã€‚
        // å…³é”®ç‚¹ï¼šä½¿ç”¨äº† 'storage' å…³é”®å­—ã€‚
        // è¿™æ„å‘³ç€ myStruct åªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘é“¾ä¸Šæ•°æ®åº“é‡Œçš„é‚£ä¸ªæ•°æ®ã€‚
        // ä¿®æ”¹ myStruct.foo ä¼šç›´æ¥ä¿®æ”¹åŒºå—é“¾ä¸Šçš„æ•°æ®ï¼
        MyStruct storage myStruct = myStructs[1];

        // ã€æ ¸å¿ƒæ¼”ç¤º 3ï¼šMemory å‰¯æœ¬ã€‘
        // åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªç»“æ„ä½“ã€‚
        // å…³é”®ç‚¹ï¼šä½¿ç”¨äº† 'memory' å…³é”®å­—ã€‚
        // è¿™æ„å‘³ç€ myMemStruct åªæ˜¯ä¸€ä¸ªä¸´æ—¶çš„å˜é‡ã€‚
        // ä¿®æ”¹ myMemStruct.foo ä¸ä¼šå½±å“ä»»ä½•é“¾ä¸Šæ•°æ®ï¼Œå‡½æ•°ç»“æŸå®ƒå°±æ¶ˆå¤±äº†ã€‚
        MyStruct memory myMemStruct = MyStruct(0);
    }

    function _f(
        // è¿™é‡Œæ¥æ”¶çš„å‚æ•°æ˜¯ storage ç±»å‹
        // è¿™æ„å‘³ç€è¿™ä¸ªå‡½æ•°å¯ä»¥ç›´æ¥ä¿®æ”¹ä¼ å…¥çš„åŸå§‹çŠ¶æ€å˜é‡
        uint256[] storage _arr,
        mapping(uint256 => address) storage _map,
        MyStruct storage _myStruct
    ) internal {
        // å¯¹ storage å˜é‡åšä¸€äº›æ“ä½œ
        _arr.push(1); // ä¼šç›´æ¥æ”¹å˜å¤–é¢çš„ arr æ•°ç»„
        _myStruct.foo = 123; // ä¼šç›´æ¥æ”¹å˜å¤–é¢çš„ myStructs æ˜ å°„
    }

    // ä½ å¯ä»¥è¿”å› memory å˜é‡
    // memory é€‚ç”¨äºå‡½æ•°å†…éƒ¨çš„ä¸´æ—¶è®¡ç®—ï¼Œæˆ–è€…ä½œä¸ºè¿”å›å€¼
    function g(uint256[] memory _arr) public returns (uint256[] memory) {
        // å¯¹ memory æ•°ç»„åšä¸€äº›æ“ä½œ
    }

    // calldata ä¸“é—¨ç”¨äºå¤–éƒ¨å‡½æ•°çš„è¾“å…¥å‚æ•°
    // å®ƒæ˜¯åªè¯»çš„ï¼Œä¸å¯ä¿®æ”¹ï¼Œä½†æ¯” memory æ›´çœ Gas
    function h(uint256[] calldata _arr) external {
        // å¯¹ calldata æ•°ç»„åšä¸€äº›æ“ä½œ
    }
}
```

å‰é¢çœ‹å·®ä¸å¤šäº†

ç„¶åè¯¥è¡¥å……çš„ç›´æ¥çœ‹ä»£ç é‡Œé¢çš„æ³¨é‡Šå§

`storage` - å˜é‡æ˜¯çŠ¶æ€å˜é‡ï¼ˆå­˜å‚¨åœ¨åŒºå—é“¾ä¸Šï¼‰ `Memory` - å˜é‡ä½äºå†…å­˜ä¸­ï¼Œå¹¶åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶å­˜åœ¨ `calldata` - ç‰¹æ®Šæ•°æ®ä½ç½®ï¼ŒåŒ…å«å‡½æ•°å‚æ•°
<!-- DAILY_CHECKIN_2026-01-19_END -->

# 2026-01-18
<!-- DAILY_CHECKIN_2026-01-18_START -->





1.  ### åŸºç¡€äº¤æ˜“ä¸ Gas è´¹æœºåˆ¶ (Basic Transactions & Gas)
    

-   **ä»£å¸ä¼ è¾“æœºåˆ¶ï¼š** è§†é¢‘å¼€å§‹æ¼”ç¤ºäº†ä»ä¸€ä¸ªè´¦æˆ·å‘é€ DAIï¼ˆç¨³å®šå¸ï¼‰åˆ°å¦ä¸€ä¸ªè´¦æˆ·ã€‚Austin å¼ºè°ƒäº†ä¸€ä¸ªæ¦‚å¿µï¼š**ä»£å¸å¹¶ä¸å­˜å‚¨åœ¨æµè§ˆå™¨æˆ–é’±åŒ…é‡Œ**ï¼Œé’±åŒ…åªæ˜¯åœ¨è¯»å–é“¾ä¸Šçš„è´¦æœ¬ã€‚å‘é€ä»£å¸å®é™…ä¸Šæ˜¯å‘ DAI çš„æ™ºèƒ½åˆçº¦å‘é€æŒ‡ä»¤ï¼Œè®©å…¶æ›´æ–°ä½™é¢ã€‚
    
-   **æ•…æ„åˆ¶é€ â€œå µå¡â€äº¤æ˜“ï¼š**
    
    -   ä»–ä»¬å°è¯•å‘é€ä¸€ç¬”äº¤æ˜“ï¼Œä½†æ•…æ„å°† **Gas Price (Max Fee)** è®¾ç½®å¾—éå¸¸ä½ï¼ˆä¾‹å¦‚ 10 Gweiï¼Œè€Œå½“æ—¶å¸‚åœºä»·çº¦ 30 Gweiï¼‰ã€‚
        
    -   **ç»“æœï¼š** äº¤æ˜“è¿›å…¥äº† **Mempoolï¼ˆå†…å­˜æ± ï¼‰**ï¼Œä½†çŸ¿å·¥å› ä¸ºè´¹ç”¨å¤ªä½è€Œä¸æ‰“åŒ…å®ƒï¼Œå¯¼è‡´äº¤æ˜“å¤„äº "Pending"ï¼ˆæŒ‚èµ·ï¼‰çŠ¶æ€ã€‚
        
-   **Nonceï¼ˆäº¤æ˜“åºå·ï¼‰çš„é‡è¦æ€§ï¼š**
    
    -   ä»–ä»¬è§£é‡Šäº† **Nonce** çš„æ¦‚å¿µï¼šè¿™æ˜¯ä¸ºäº†é˜²æ­¢é‡æ”¾æ”»å‡»çš„è®¡æ•°å™¨ã€‚
        
    -   å¦‚æœä½ æœ‰ä¸€ç¬” Nonce ä¸º 6 çš„äº¤æ˜“å¡ä½äº†ï¼Œé‚£ä¹ˆ Nonce ä¸º 7ã€8 çš„åç»­äº¤æ˜“éƒ½ä¼šæ’é˜Ÿç­‰å¾…ï¼Œæ— æ³•æ‰§è¡Œã€‚å¿…é¡»å…ˆè§£å†³ Nonce 6 çš„é—®é¢˜ã€‚
        

### è§£å†³â€œå¡ä½â€çš„äº¤æ˜“ (Fixing Stuck Transactions)

è§†é¢‘æ¼”ç¤ºäº†ä¸‰ç§å¤„ç†å¡é¡¿äº¤æ˜“çš„æ–¹æ³•ï¼š

1.  **åŠ é€Ÿ (Speed Up)ï¼š** ä½¿ç”¨ MetaMask çš„åŠ é€ŸæŒ‰é’®ï¼Œå®è´¨ä¸Šæ˜¯å‘é€ä¸€ç¬”å†…å®¹ç›¸åŒä½† Gas è´¹æ›´é«˜çš„æ–°äº¤æ˜“æ¥è¦†ç›–æ—§äº¤æ˜“ã€‚
    
2.  **æ‰‹åŠ¨å–æ¶ˆ (Manual Cancel)ï¼š**
    
    1.  è¿™æ˜¯ä¸€ç§é«˜çº§æŠ€å·§ã€‚åŸç†æ˜¯å‘**è‡ªå·±çš„åœ°å€**å‘é€ **0 ETH**ï¼Œä½†æ‰‹åŠ¨å°† **Nonce** è®¾ç½®ä¸ºä¸é‚£ç¬”å¡ä½çš„äº¤æ˜“**ç›¸åŒ**ï¼ˆä¾‹å¦‚ Nonce 6ï¼‰ï¼Œå¹¶æ”¯ä»˜æ­£å¸¸çš„ Gas è´¹ã€‚
        
    2.  ä¸€æ—¦è¿™ç¬”â€œç©ºäº¤æ˜“â€è¢«æ‰“åŒ…ï¼ŒåŸæ¥çš„äº¤æ˜“å°±ä¼šè¢«è¦†ç›–å¹¶å¤±æ•ˆï¼ˆDroppedï¼‰ã€‚
        
    3.  _æ¼”ç¤ºæ’æ›²ï¼š_ MetaMask çš„ç•Œé¢åœ¨æ‰‹åŠ¨è®¾ç½® Nonce æ—¶å‡ºç°äº†ä¸€äº› UI æ•…éšœï¼Œè¿™ä¹Ÿæ˜¯è§†é¢‘æƒ³è¦å±•ç¤ºçš„çœŸå® Web3 å¼€å‘ä½“éªŒâ€”â€”å·¥å…·å¹¶ä¸å®Œç¾ã€‚
        
3.  **é‡ç½®è´¦æˆ· (Reset Account)ï¼š** Austin å±•ç¤ºäº†åœ¨ MetaMask è®¾ç½®ä¸­â€œé‡ç½®è´¦æˆ·â€ã€‚è¿™ä¸ä¼šä¸¢å¤±èµ„é‡‘ï¼Œåªæ˜¯æ¸…é™¤äº†æœ¬åœ°çš„äº¤æ˜“å†å²è®°å½•ã€‚è¿™é€šå¸¸ç”¨äºè§£å†³ MetaMask çŠ¶æ€ä¸é“¾ä¸ŠçŠ¶æ€ä¸ä¸€è‡´å¯¼è‡´çš„ UI å¡æ­»é—®é¢˜ã€‚
    

### ç›´æ¥ä¸åˆçº¦äº¤äº’ (Direct Contract Interaction)

-   é™¤äº†ä½¿ç”¨é’±åŒ…ç•Œé¢ï¼Œä»–ä»¬æ¼”ç¤ºäº†å¦‚ä½•ç›´æ¥åœ¨ **Etherscan** ä¸Šæ“ä½œã€‚
    
-   **æ“ä½œï¼š** æ‰¾åˆ° DAI çš„æ™ºèƒ½åˆçº¦é¡µé¢ï¼Œä½¿ç”¨ "Write Contract" åŠŸèƒ½ç›´æ¥è°ƒç”¨ `transfer` å‡½æ•°ã€‚
    
-   **æŠ€æœ¯ç»†èŠ‚ï¼š** è¿™é‡Œå±•ç¤ºäº†å¼€å‘è€…éœ€è¦æ³¨æ„çš„ç²¾åº¦é—®é¢˜ï¼ˆDecimalsï¼‰ã€‚åœ¨åˆçº¦å±‚é¢å‘é€ 5 ä¸ª DAIï¼Œéœ€è¦è¾“å…¥ `5000000000000000000`ï¼ˆ18ä¸ªé›¶ï¼‰ï¼Œè€Œä¸æ˜¯ç®€å•çš„ "5"ã€‚
    

### Layer 2 ä¸ è·¨é“¾ (Layer 2 & Bridging)

-   **è·¨é“¾æ¡¥ (Bridging)ï¼š** æ¼”ç¤ºäº†å°† ETH ä»ä»¥å¤ªåŠä¸»ç½‘ï¼ˆL1ï¼‰è·¨é“¾åˆ° **Optimism**ï¼ˆL2ï¼‰ã€‚
    
    -   ä½“éªŒäº†è·¨é“¾çš„ç­‰å¾…æ—¶é—´ï¼ˆGrace Periodï¼‰ï¼Œèµ„é‡‘ä» L1 æ¶ˆå¤±ä½†å°šæœªåˆ°è¾¾ L2 çš„â€œææ…Œæ—¶åˆ»â€ã€‚
        
-   **L2 çš„ä¼˜åŠ¿ï¼š** èµ„é‡‘åˆ°è¾¾ Optimism åï¼Œä»–ä»¬å±•ç¤ºäº†äº¤æ˜“é€Ÿåº¦æå¿«ä¸” Gas è´¹æä½ï¼ˆå‡ ç¾åˆ† vs ä¸»ç½‘çš„å‡ åç¾å…ƒï¼‰ã€‚
    
-   **NFT é“¸é€ ï¼š** åœ¨ Optimism ä¸Šé“¸é€ äº†ä¸€ä¸ª "Optimistic Loogie" NFTï¼Œå¹¶éšååœ¨ Quixoticï¼ˆOptimism ä¸Šçš„ NFT å¸‚åœºï¼‰ä¸ŠæŒ‚å•å‡ºå”®ã€‚
    

### DeFi æ“ä½œä¸æˆæƒæ¨¡å¼ (DeFi & Approve Pattern)

-   **Uniswap/Matcha äº¤æ˜“ï¼š** æ¼”ç¤ºäº†ä»£å¸å…‘æ¢ï¼ˆSwapï¼‰ã€‚
    
-   **Approveï¼ˆæˆæƒï¼‰æœºåˆ¶ï¼š** è§†é¢‘é‡ç‚¹è®²è§£äº† ERC-20 ä»£å¸çš„ä¸€ä¸ªé‡è¦æ¨¡å¼ã€‚å½“ä½ æƒ³ç”¨åˆçº¦ï¼ˆå¦‚ Uniswapï¼‰å¤„ç†ä½ çš„ä»£å¸ï¼ˆå¦‚ DAIï¼‰æ—¶ï¼Œä½ å¿…é¡»å…ˆå‘é€ä¸€ç¬” **Approve** äº¤æ˜“ï¼Œæˆæƒåˆçº¦åŠ¨ç”¨ä½ çš„èµ„é‡‘ï¼Œç„¶åå†å‘é€ç¬¬äºŒç¬”äº¤æ˜“è¿›è¡Œ **Swap**ã€‚
    
-   **å€Ÿè´· (Aave)ï¼š** ä»–ä»¬å°è¯•åœ¨ Aave ä¸ŠæŠµæŠ¼ ETH å€Ÿå‡º DAIã€‚
    
    -   _æ•™è®­ï¼š_ åœ¨ä¸»ç½‘æ“ä½œ DeFi éå¸¸æ˜‚è´µã€‚ä¸ºäº†å€Ÿå‡ºä¸€å°ç¬”é’±ï¼Œå¯èƒ½éœ€è¦æ”¯ä»˜æé«˜çš„ Gas è´¹ï¼ˆè§†é¢‘ä¸­å…‰æ˜¯æŠµæŠ¼å°±è¦ 20-30 ç¾å…ƒæ‰‹ç»­è´¹ï¼‰ï¼Œè¿™è¯´æ˜äº†ä¸ºä»€ä¹ˆ L2 å¯¹æ™®é€šç”¨æˆ·å¦‚æ­¤é‡è¦ã€‚
        

### å¤šç­¾é’±åŒ… (Multisig / Gnosis Safe)

è§†é¢‘èŠ±äº†å¾ˆå¤§ç¯‡å¹…ä»‹ç»äº† **Gnosis Safe**ï¼ˆç°å Safeï¼‰ï¼š

-   **ä¸ºä»€ä¹ˆéœ€è¦å¤šç­¾ï¼š** ä¸ºäº†å®‰å…¨ã€‚å•ç§é’¥é’±åŒ…ï¼ˆåŠ©è®°è¯ï¼‰ä¸€æ—¦ä¸¢å¤±æˆ–æ³„éœ²ï¼Œèµ„é‡‘å…¨æ— ã€‚å¤šç­¾é’±åŒ…è¦æ±‚å¤šä¸ªåœ°å€ï¼ˆå¦‚ 2/3 æˆ– 2/4ï¼‰å…±åŒç­¾åæ‰èƒ½æ‰§è¡Œäº¤æ˜“ã€‚
    
-   **åˆ›å»ºè¿‡ç¨‹ï¼š** ä»–ä»¬åœ¨ Optimism ä¸Šåˆ›å»ºäº†ä¸€ä¸ª 2-of-4 çš„å¤šç­¾é’±åŒ…ï¼ˆæ„å‘³ç€ 4 ä¸ªæ‹¥æœ‰è€…ä¸­ä»»æ„ 2 ä¸ªäººç­¾åå³å¯è½¬è´¦ï¼‰ã€‚
    
-   **æ“ä½œæ¼”ç¤ºï¼š**
    
    -   å‘å¤šç­¾é’±åŒ…è½¬å…¥èµ„é‡‘ã€‚
        
    -   å‘èµ·ä¸€ç¬”è½¬å‡ºèµ„é‡‘çš„ææ¡ˆï¼ˆProposalï¼‰ã€‚
        
    -   Austin ç­¾åï¼ˆç¬¬ä¸€ç­¾ï¼‰ã€‚
        
    -   Etta æˆ– Carlos ç­¾åï¼ˆç¬¬äºŒç­¾ï¼‰å¹¶æ‰§è¡Œäº¤æ˜“ã€‚
        
-   **WalletConnect é›†æˆï¼š** å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ WalletConnect å°†å¤šç­¾é’±åŒ…è¿æ¥åˆ° Uniswapã€‚è¿™æ„å‘³ç€ä»–ä»¬å¯ä»¥ä½œä¸ºä¸€ä¸ªâ€œç»„ç»‡â€åœ¨ Uniswap ä¸Šè¿›è¡Œäº¤æ˜“ï¼Œäº¤æ˜“è¯·æ±‚ä¼šå‘å› Gnosis Safe ç•Œé¢ç­‰å¾…å¤šæ–¹ç­¾åã€‚
    

### æ€»ç»“çš„æ ¸å¿ƒç†å¿µ

-   **Web3 çš„ç”¨æˆ·ä½“éªŒ (UX) ä»æœ‰å¾…æé«˜ï¼š** è§†é¢‘ä¸­å¤šæ¬¡å‡ºç° MetaMask æŠ¥é”™ã€ENS åœ¨ L2 ä¸Šæ— æ³•è§£æã€äº¤æ˜“å¡é¡¿ç­‰æƒ…å†µã€‚Austin é¼“åŠ±å¼€å‘è€…è¦æœ‰è€å¿ƒï¼Œå¹¶è‡´åŠ›äºè§£å†³è¿™äº›é—®é¢˜ã€‚
    
-   **å®‰å…¨æ€§ï¼š** å¼ºè°ƒäº†åŠ©è®°è¯ç®¡ç†çš„é£é™©ï¼Œæ¨å´‡ä½¿ç”¨å¤šç­¾é’±åŒ…æ¥ç®¡ç†é‡è¦èµ„äº§æˆ–å›¢é˜Ÿèµ„é‡‘ã€‚
    
-   **å®æ“å‡ºçœŸçŸ¥ï¼š** é¼“åŠ±å¼€å‘è€…å»ä¸»ç½‘å’Œ L2 ä¸Šå®é™…æ¶ˆè€—ä¸€ç‚¹ Gasï¼Œå»ä½“éªŒè¢«â€œå¡ä½â€çš„æ„Ÿè§‰ï¼Œè¿™æ ·æ‰èƒ½çœŸæ­£ç†è§£åº•å±‚é€»è¾‘ã€‚
<!-- DAILY_CHECKIN_2026-01-18_END -->

# 2026-01-17
<!-- DAILY_CHECKIN_2026-01-17_START -->






æ„Ÿè§‰å‰ä¸¤å¤©å¹²åˆ«çš„æ´»æœ‰ç‚¹æ‡ˆæ€ äº†

ä»Šå¤©å¼€å§‹ç»§ç»­åŠ æ²¹å§

å…ˆæ•´ç†ä¸€ä¸‹ä¸Šå‘¨æœ‰æ²¡æœ‰ä»€ä¹ˆæ²¡å®Œæˆçš„å†…å®¹

### 1.12-13 å…¥é—¨å¯¼è¯» & åˆæ­¥ç†è§£

1.  å­¦ä¹ å†…å®¹ï¼š
    
    1.  Web3 å®ä¹ æ‰‹å†Œ[ã€Œå…¥é—¨å¯¼è¯»ã€](https://web3intern.xyz/zh/blockchain-basic/)éƒ¨åˆ†âœ…
        
    2.  [021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 1 ç« ](https://github.com/XiaoHai67890/021Ethereum/blob/main/%E3%80%8A021%E5%AD%A6%E4%B9%A0%E4%BB%A5%E5%A4%AA%E5%9D%8A%E3%80%8B%E5%BC%80%E6%BA%90%E6%95%99%E6%9D%90.pdf)âœ…
        
2.  æ‹“å±• & è¾…åŠ©ç†è§£ææ–™
    
    1.  Ethereum å®˜ç½‘ [Overview](https://ethereum.org/learn/) åŸºç¡€å†…å®¹å­¦ä¹ âœ…
        
    2.  [**Day 1: A Developerâ€™s Guide to Building on Ethereum**](https://www.youtube.com/watch?v=zuJ-elbo88E&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=1) - Introâœ…
        
    3.  [**Day 2: Becoming a Power User - Wallets, Mnemonics, Keypairs**](https://www.youtube.com/watch?v=_GjPeRLCREA&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=2)**âœ…**
        
3.  å·¥å…·å®‰è£…
    
    1.  å·¥å…·å®‰è£…æŒ‡å—ï¼š[https://web3intern.xyz/zh/remote-work-guide/âœ…](https://web3intern.xyz/zh/remote-work-guide/%E2%9C%85)
        

### 1.14-15 å®‰å…¨ & åˆè§„

1.  å­¦ä¹ å†…å®¹ï¼š
    
    1.  Web3 å®ä¹ æ‰‹å†Œ[ã€Œå®‰å…¨ä¸åˆè§„ã€](https://web3intern.xyz/zh/security/)éƒ¨åˆ†âœ…
        
    2.  021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 2&3 ç« âœ…
        
2.  æ‹“å±• & è¾…åŠ©ç†è§£ææ–™
    
    1.  [**Day 3: ENS, DEX, Identity, Inventory, Sybil**](https://www.youtube.com/watch?v=wYSMNdIRoII&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=3)**â­•**
        
    2.  [**Day 4: NFTs!!! ERC20 vs ERC721, IPFS, Metadata**](https://www.youtube.com/watch?v=NOdrEpnoCiM&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=4)**â­•**
        
    3.  [**Day 5: Stuck Transactions, Gas Limits, Multisigs, L2s, Lendingâ€¦**](https://www.youtube.com/watch?v=11QTT6BK5j0&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=5)**â­•**
        
3.  å·¥å…·å®‰è£…
    
    1.  MetaMask / [Rabby](https://x.com/Rabby_io) é’±åŒ…å®‰è£… & åˆ›å»ºï¼Œå¹¶ç†Ÿæ‚‰âœ…
        

### 1.16 å®è·µã€å›é¡¾ä¸æˆæœå±•ç¤º

1.  å¤ä¹ å›é¡¾ç›¸å…³ç« èŠ‚ï¼Œå®Œæˆæœªå®Œæˆè¯¾ç¨‹
    
2.  è¡Œä¸šæ¢ç´¢
    
    1.  çŸ¥åå¼€å‘è€… & Builder X å…³æ³¨æ¸…å•
        
3.  å®è·µ & ä¸‹å‘¨å‡†å¤‡
    
    1.  å¼€å‘ç¯å¢ƒå¹¶ç†Ÿæ‚‰ï¼š[Remix IDE](https://remix.ethereum.org/#lang=en&optimize=false&runs=200&evmVersion=null&version=soljson-v0.8.30+commit.73712a01.js)**â­•**
        
        1.  [Remix ä½¿ç”¨æ•™ç¨‹](https://www.notion.so/2bc1a400ef948075ab7ec8b8259c7746?pvs=21)
            
4.  å‚åŠ å‘¨äº”æ™šä¾‹ä¼šï¼Œåˆ†äº«æœ¬å‘¨æ„Ÿæ‚Ÿä¸å­¦ä¹ ç¬”è®°
    

### 1.12-13 å…¥é—¨å¯¼è¯» & åˆæ­¥ç†è§£

1.  å­¦ä¹ å†…å®¹ï¼š
    
    1.  Web3 å®ä¹ æ‰‹å†Œ[ã€Œå…¥é—¨å¯¼è¯»ã€](https://web3intern.xyz/zh/blockchain-basic/)éƒ¨åˆ†âœ…
        
    2.  [021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 1&2 ç« ](https://github.com/XiaoHai67890/021Ethereum/blob/main/%E3%80%8A021%E5%AD%A6%E4%B9%A0%E4%BB%A5%E5%A4%AA%E5%9D%8A%E3%80%8B%E5%BC%80%E6%BA%90%E6%95%99%E6%9D%90.pdf)âœ…
        
2.  æ‹“å±• & è¾…åŠ©ç†è§£ææ–™
    
    1.  [**Day 1: A Developerâ€™s Guide to Building on Ethereum**](https://www.youtube.com/watch?v=zuJ-elbo88E&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=1) - Introâœ…
        
    2.  [**Day 2: Becoming a Power User - Wallets, Mnemonics, Keypairs**](https://www.youtube.com/watch?v=_GjPeRLCREA&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=2)**âœ…**
        
    3.  [Uniswap V2 å­¦ä¹ å®˜æ–¹æ–‡æ¡£](https://docs.uniswap.org/contracts/v2/overview?utm_source=chatgpt.com)âœ…
        

### 1.14-15 å®‰å…¨ & åˆè§„

1.  å­¦ä¹ å†…å®¹ï¼š
    
    1.  Web3 å®ä¹ æ‰‹å†Œ[ã€Œå®‰å…¨ä¸åˆè§„ã€](https://web3intern.xyz/zh/security/)éƒ¨åˆ†âœ…
        
    2.  021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 3&4 ç« âœ…
        
2.  æ‹“å±• & è¾…åŠ©ç†è§£ææ–™
    
    1.  [**Day 3: ENS, DEX, Identity, Inventory, Sybil**](https://www.youtube.com/watch?v=wYSMNdIRoII&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=3)**â­•**
        
    2.  [**Day 4: NFTs!!! ERC20 vs ERC721, IPFS, Metadata**](https://www.youtube.com/watch?v=NOdrEpnoCiM&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=4)**â­•**
        
    3.  [**Day 5: Stuck Transactions, Gas Limits, Multisigs, L2s, Lendingâ€¦**](https://www.youtube.com/watch?v=11QTT6BK5j0&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=5)**â­•**
        

### 1.16 å®è·µã€å›é¡¾ä¸æˆæœå±•ç¤º

1.  å¤ä¹ å›é¡¾ç›¸å…³ç« èŠ‚ï¼Œå®Œæˆæœªå®Œæˆè¯¾ç¨‹
    
2.  è¡Œä¸šæ¢ç´¢
    
    1.  çŸ¥åå¼€å‘è€… & Builder X å…³æ³¨æ¸…å•
        
3.  å®è·µä¸æŒ‘æˆ˜ - Simple NFT
    
    1.  è§†é¢‘æŒ‡å¯¼ï¼šå…¥é—¨çº§ Web2 to Web3 ä¸­çš„ Week 3, Day 1 - simple NFTâœ…
        
        -   **Link:** [**Speed Run Ethereum: Challenge 0 - Simple NFT**](https://www.youtube.com/watch?v=ej_RgaO1Pr0&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=11)**âœ…**
            
    2.  æŒ‘æˆ˜ï¼š[Challenge #0 - Tokenization](https://speedrunethereum.com/challenge/tokenization) **ï¼ˆ**[**ä¸­æ–‡ç‰ˆé“¾æ¥**](https://www.notion.so/Challenge-0-2afbbd63be8780dbbd56cb01490da15e?pvs=21)**ï¼‰â­•**
        
4.  æœ‰ä½™åŠ›ã€å­¦ä¹ è¿›åº¦æ¯”è¾ƒå¿«çš„åŒå­¦å¯å°è¯• Bounty å†…å®¹ï¼š[Challenge #5](https://speedrunethereum.com/challenge/over-collateralized-lending)
    
5.  å‚åŠ å‘¨äº”æ™šä¾‹ä¼šï¼Œåˆ†äº«æœ¬å‘¨æ„Ÿæ‚Ÿä¸å­¦ä¹ ç¬”è®°
    

è¿™å—å‰©ä½™æ²¡å¹²å®Œçš„æ´»æœ‰

-   [**Day 3: ENS, DEX, Identity, Inventory, Sybil**](https://www.youtube.com/watch?v=wYSMNdIRoII&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=3)**â­•**
    
-   [**Day 4: NFTs!!! ERC20 vs ERC721, IPFS, Metadata**](https://www.youtube.com/watch?v=NOdrEpnoCiM&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=4)**â­•**
    
-   [**Day 5: Stuck Transactions, Gas Limits, Multisigs, L2s, Lendingâ€¦**](https://www.youtube.com/watch?v=11QTT6BK5j0&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=5)**â­•**
    
-   å¼€å‘ç¯å¢ƒå¹¶ç†Ÿæ‚‰ï¼š[Remix IDE](https://remix.ethereum.org/#lang=en&optimize=false&runs=200&evmVersion=null&version=soljson-v0.8.30+commit.73712a01.js)**â­•**
    
-   [Challenge #0 - Tokenization](https://speedrunethereum.com/challenge/tokenization) **ï¼ˆ**[**ä¸­æ–‡ç‰ˆé“¾æ¥**](https://www.notion.so/Challenge-0-2afbbd63be8780dbbd56cb01490da15e?pvs=21)**ï¼‰â­•**
    

RuståŸºç¡€çš„è¯­æ³•ç®—æ˜¯å­¦å®Œäº†ï¼Œåé¢è¿™æ®µæ—¶é—´å°±æŒç»­åˆ·é¢˜è¿›è¡Œå·©å›ºå§

ä»Šå¤©å…ˆæŠŠè¿™äº›ä¸œè¥¿è¡¥ä¸Šå§

ä¹‹åå¹²ä»€ä¹ˆï¼Ÿ

1.  ç³»ç»Ÿå­¦ä¸€ä¸‹ solidity ï¼Œåšåˆ°èƒ½è¯»æ‡‚ï¼Œèƒ½ä½¿ç”¨ ai è¾…åŠ©å®Œæˆå˜æˆå³å¯
    
2.  æ¯å¤©è‡³å°‘ä¸€é“ç®—æ³•é¢˜
    
3.  è¯¥æŠŠè®ºæ–‡æƒ³åŠæ³•å¼„å‡ºæ¥äº†
    

* * *

## [**Day 3: ENS, DEX, Identity, Inventory, Sybil**](https://www.youtube.com/watch?v=wYSMNdIRoII&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=3)

### ENS åŸŸåæ³¨å†Œ (Ethereum Name Service)https://ens.domains/

è¿™æ˜¯è§†é¢‘çš„æ ¸å¿ƒæ¼”ç¤ºéƒ¨åˆ†ï¼Œå±•ç¤ºäº†å¦‚ä½•å°†éš¾è®°çš„åå…­è¿›åˆ¶åœ°å€è½¬åŒ–ä¸ºæ˜“è¯»çš„åç§°ï¼ˆå¦‚ `sanfordstout.eth`ï¼‰ã€‚

æœ¬è´¨æ˜¯ NFT

-   **ç±»æ¯” DNS**ï¼šENS ä¹‹äºä»¥å¤ªåŠåœ°å€ï¼Œå°±åƒ DNS ä¹‹äº IP åœ°å€ã€‚
    
-   **æ³¨å†Œæµç¨‹ï¼ˆä¸¤æ­¥äº¤æ˜“ï¼‰**ï¼š
    
    -   **Commitï¼ˆæäº¤ï¼‰**ï¼šä¸ºäº†é˜²æ­¢æŠ¢è·‘ï¼ˆFront-runningï¼‰ï¼Œç”¨æˆ·é¦–å…ˆå‘æ™ºèƒ½åˆçº¦æäº¤ä¸€ä¸ªå“ˆå¸Œï¼ˆCommitmentï¼‰ã€‚è¿™ä¸€æ­¥ä¸åŒ…å«å…·ä½“çš„åŸŸåæ˜æ–‡ï¼Œæ—¨åœ¨é”å®šè¯·æ±‚ã€‚
        
    -   **Waitï¼ˆç­‰å¾…ï¼‰**ï¼šé€šå¸¸ç­‰å¾…ä¸€åˆ†é’Ÿï¼Œç¡®ä¿ Commit äº¤æ˜“è¢«æ‰“åŒ…ã€‚
        
    -   **Revealï¼ˆæ­ç¤ºï¼‰**ï¼šå‘é€ç¬¬äºŒç¬”äº¤æ˜“æ­ç¤ºåŸŸåå¹¶æ­£å¼æ³¨å†Œã€‚Austin è§£é‡Šäº†è¿™æ˜¯ä¸€ç§é€šè¿‡â€œæäº¤-æ­ç¤ºâ€æ–¹æ¡ˆï¼ˆCommit-Reveal Schemeï¼‰æ¥é˜²æ­¢æ¶æ„è§‚å¯Ÿè€…åœ¨çœ‹åˆ°æ³¨å†Œè¯·æ±‚åæé«˜ Gas è´¹æŠ¢æ³¨åŸŸåçš„åšå¼ˆæœºåˆ¶ã€‚
        
    
    > ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ä¸¤æ­¥äº¤æ˜“çš„æ–¹å¼? å¦‚æœä¸é‡‡ç”¨ä¸¤æ­¥æœºåˆ¶ï¼Œä¼šå‘ç”Ÿ **æŠ¢è·‘æ”»å‡»ï¼ˆFront-runningï¼‰**ï¼š
    > 
    > 1.  ä½ å‘é€äº¤æ˜“ï¼šâ€œæˆ‘è¦æ³¨å†Œ `secretproject.eth`â€ã€‚
    >     
    > 2.  æ¶æ„æœºå™¨äººåœ¨å†…å­˜æ± çœ‹åˆ°è¿™ç¬”äº¤æ˜“ï¼Œå‘ç°è¿™ä¸ªåå­—å¾ˆæœ‰ä»·å€¼ã€‚
    >     
    > 3.  æœºå™¨äººç«‹åˆ»å‘é€ä¸€ç¬” Gas è´¹æ›´é«˜çš„äº¤æ˜“ï¼šâ€œæˆ‘è¦æ³¨å†Œ `secretproject.eth`â€ã€‚
    >     
    > 4.  çŸ¿å·¥ä¼˜å…ˆæ‰“åŒ…æœºå™¨äººçš„äº¤æ˜“ï¼Œä½ æ³¨å†Œå¤±è´¥ï¼ŒåŸŸåè¢«æŠ¢æ³¨ã€‚
    >     
    > 
    > æ•´ä¸ªæµç¨‹ç®€å•æ¥è¯´å°±æ˜¯å…ˆæŠŠåŸŸåçš„æ‰¿è¯ºæ”¾åˆ°é“¾ä¸Šï¼Œä¹‹åå†æ­ç¤ºæ‰¿è¯ºçš„ä¿¡æ¯ï¼Œæ³¨å†Œè¿™ä¸ªåŸŸå
    > 
    > é‚£ä¹ˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆé€šè¿‡æ‰¿è¯ºæ¥åˆ¤æ–­ä¸€ä¸ªåŸŸåæ˜¯å¦è¢«æ³¨å†Œè¿‡?è¿˜æ˜¯è¯´åªåœ¨ç¬¬äºŒæ­¥ä¸­éªŒè¯åŸŸåæ˜¯å¦è¢«æ³¨å†Œè¿‡ï¼Ÿ
    > 
    > ç­”æ¡ˆæ˜¯ä¸æ£€æŸ¥ï¼Œè¦æ˜¯è¢«æ³¨å†Œè¿‡äº†å°±ç™½èŠ±ç¬¬ä¸€æ­¥çš„ Gas äº†
    
-   **åå‘è§£æ (Reverse Record)**ï¼šæ¼”ç¤ºäº†ç¬¬ä¸‰ç¬”äº¤æ˜“ï¼Œå°†åœ°å€åå‘æŒ‡å‘åŸŸåã€‚è¿™æ ·å½“ DApp è¯»å–è¯¥åœ°å€æ—¶ï¼Œèƒ½è‡ªåŠ¨æ˜¾ç¤ºä¸º `sanfordstout.eth`ã€‚
    

**ENS æ¶æ„ç®€å›¾**

Â Â ENS ä¸»è¦ç”±ä¸‰ä¸ªæ ¸å¿ƒåˆçº¦ç»„æˆï¼š

1.  **Registry (æ³¨å†Œè¡¨)ï¼š** æ ¸å¿ƒåˆçº¦ï¼Œè®°å½•æ‰€æœ‰åŸŸååŠå…¶æ‹¥æœ‰è€…ï¼Œä»¥åŠè¯¥åŸŸåå¯¹åº”çš„ Resolver åœ°å€ã€‚
    
2.  **Registrar (æ³¨å†Œå™¨)ï¼š** è´Ÿè´£æŒ‰ç…§ç‰¹å®šè§„åˆ™ï¼ˆä¾‹å¦‚æ¯å¹´ä»˜è´¹ã€ç«æ‹ç­‰ï¼‰å‘ç”¨æˆ·åˆ†é…åŸŸåçš„åˆçº¦ã€‚
    
3.  **Resolver (è§£æå™¨)ï¼š** çœŸæ­£å¹²æ´»çš„åˆçº¦ã€‚å½“é’±åŒ…é—®â€œ`sanford.eth` çš„åœ°å€æ˜¯å¤šå°‘ï¼Ÿâ€æ—¶ï¼ŒRegistry ä¼šæŒ‡å¼•å®ƒå»é—® Resolverï¼ŒResolver è¿”å›å…·ä½“çš„åœ°å€ã€‚
    

**ENSæ˜¯ç”±è°è¿è¥ï¼Ÿ**

-   **å¼€å‘å›¢é˜Ÿï¼ˆENS Labsï¼‰ï¼š** `ens.domains` è¿™ä¸ªç½‘ç«™æœ¬èº«ï¼Œä»¥åŠ ENS æ ¸å¿ƒæ™ºèƒ½åˆçº¦çš„å¼€å‘å·¥ä½œï¼Œä¸»è¦ç”± **ENS Labs**ï¼ˆå‰èº«ä¸º True Names Ltdï¼‰è´Ÿè´£ã€‚è¿™æ˜¯ä¸€å®¶ DAO éè¥åˆ©æ€§è´¨çš„ç»„ç»‡ï¼Œè‡´åŠ›äºå¼€å‘å’Œç»´æŠ¤ ENS æ ‡å‡†ã€‚
    

**ENS çš„åŸŸåä¸åœ°å€æ˜ å°„è¡¨å­˜æ”¾åœ¨å“ªé‡Œï¼Ÿæ‰€æœ‰çš„å…¨èŠ‚ç‚¹ä¸Šå—ï¼Ÿ**

-   **æ˜¯çš„ï¼Œå­˜æ”¾åœ¨ä»¥å¤ªåŠåŒºå—é“¾çš„â€œçŠ¶æ€ï¼ˆStateï¼‰â€ä¸­ï¼Œå› æ­¤æ¯ä¸€ä¸ªåŒæ­¥äº†æœ€æ–°çŠ¶æ€çš„ä»¥å¤ªåŠå…¨èŠ‚ç‚¹ï¼ˆFull Nodeï¼‰éƒ½ä¿å­˜ç€è¿™ä»½å®Œæ•´çš„æ˜ å°„è¡¨ã€‚**
    

> åŸŸåä¸‹é¢è¿˜å¯ä»¥æœ‰å­åŸŸåï¼Œæ¯”å¦‚è¯´è¿™æ ·
> 
> **ä¸»åŸŸå (NFT):** `company.eth` -> ç»‘å®šåˆ°å…¬å¸å†·é’±åŒ…/å¤šç­¾é’±åŒ…ã€‚
> 
> **å­åŸŸå 1:** `pay.company.eth` -> ç»‘å®šåˆ°è´¢åŠ¡æ”¶å¸åœ°å€ã€‚
> 
> **å­åŸŸå 2:** `dev.company.eth` -> ç»‘å®šåˆ°å¼€å‘è€…çš„åœ°å€ã€‚
> 
> **å­åŸŸå 3:** `01.company.eth` -> ç»‘å®šåˆ° 1 å·æœºå™¨äººçš„åœ°å€ã€‚

### Web3 èº«ä»½ä¸åº“å­˜ (Identity & Inventory)

-   **èº«ä»½çš„å¯ç§»æ¤æ€§**ï¼šè§†é¢‘å¼ºè°ƒäº† Web3 èº«ä»½çš„ç‰¹ç‚¹â€”â€”ä½ çš„èº«ä»½ï¼ˆIdentityï¼‰å’Œèµ„äº§åº“å­˜ï¼ˆInventoryï¼‰æ˜¯è·Ÿéšé’±åŒ…çš„ï¼Œè€Œä¸æ˜¯å­˜å‚¨åœ¨æŸä¸ªç‰¹å®šåº”ç”¨çš„æœåŠ¡å™¨ä¸Šã€‚
    
-   **å®ä¾‹æ¼”ç¤º**ï¼š
    
    -   ç™»å½• **ENS App** æ—¶ï¼Œåº”ç”¨è¯†åˆ«å‡ºäº†ç”¨æˆ·ã€‚
        
    -   ç™»å½• **Uniswap** æ—¶ï¼Œå³ä¸Šè§’è‡ªåŠ¨æ˜¾ç¤ºäº† `sanfordstout.eth`ã€‚
        
    -   ä½¿ç”¨ **Zapper.fi** æ—¶ï¼Œæ— éœ€è¿æ¥é’±åŒ…ï¼Œä»…è¾“å…¥åŸŸåå³å¯æŸ¥çœ‹è¯¥â€œè§’è‰²â€åœ¨é“¾ä¸Šçš„æ‰€æœ‰èµ„äº§ï¼ˆETH å’Œ DAIï¼‰ã€‚
        

### Uniswap ä¸å»ä¸­å¿ƒåŒ–äº¤æ˜“ (DEX)

-   **DEX vs CEX**ï¼š
    
    -   **CEXï¼ˆä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼‰**ï¼šåŸºäºè®¢å•ç°¿ï¼ˆOrder Bookï¼‰å’Œä¸­å¿ƒåŒ–æ•°æ®åº“ï¼Œç±»ä¼¼ä¼ ç»Ÿé“¶è¡Œæˆ–è‚¡ç¥¨äº¤æ˜“ã€‚
        
    -   **DEXï¼ˆå»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼‰**ï¼šåŸºäºæ™ºèƒ½åˆçº¦å‚¨å¤‡æ± ï¼ˆLiquidity Poolsï¼‰ã€‚Austin å°†å…¶æ¯”ä½œä¸€ä¸ªâ€œè‡ªåŠ¨å”®è´§æœºâ€ï¼Œé‡Œé¢å­˜æœ‰ä¸¤ç§èµ„äº§ï¼ˆå¦‚ ETH å’Œ DAIï¼‰ï¼Œå¹¶é€šè¿‡ç®—æ³•ï¼ˆè‡ªåŠ¨åšå¸‚å•† AMMï¼‰æ ¹æ®ä¾›éœ€è‡ªåŠ¨è°ƒèŠ‚ä»·æ ¼ã€‚
        
-   **å®æ“**ï¼šæ¼”ç¤ºäº†å°†éƒ¨åˆ† ETH å…‘æ¢ä¸ºç¨³å®šå¸ DAIã€‚Austin æåˆ°è¿™ä¸ä»…æ˜¯ä¸€æ¬¡ç®€å•çš„è½¬è´¦ï¼Œè€Œæ˜¯ä¸æŒæœ‰å·¨å¤§èµ„äº§å‚¨å¤‡çš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚
    

### ç¨³å®šå¸ (Stablecoins) ä¸å¥³å·«æŠµæŠ— (Sybil Resistance)

-   **DAI çš„æœºåˆ¶**ï¼šç®€è¦ï¼ˆä¸”é€šä¿—åœ°ï¼‰è§£é‡Šäº† DAI ä½œä¸ºä¸€ä¸ªå»ä¸­å¿ƒåŒ–ç¨³å®šå¸ï¼Œæ˜¯å¦‚ä½•é€šè¿‡è¶…é¢æŠµæŠ¼ï¼ˆOver-collateralized loansï¼‰ã€é“¸é€ /é”€æ¯æœºåˆ¶ä»¥åŠ MakerDAO çš„æ²»ç†ä»£å¸æ¥ç»´æŒä¸ç¾å…ƒæŒ‚é’©çš„ã€‚
    
-   **å¥³å·«æ”»å‡» (Sybil Attack)**ï¼šè§†é¢‘æœ€ååæ€äº†åˆšæ‰çš„æ“ä½œâ€”â€”ä»–ä»¬è½»æ¾åˆ›å»ºäº†ä¸€ä¸ªçœ‹ä¼¼çœŸäººçš„â€œSanford Stoutâ€èº«ä»½ã€‚è¿™å¼•å‡ºäº† Web3 ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒéš¾é¢˜ï¼šå¦‚ä½•åŒºåˆ†é€šè¿‡ç®—æ³•ç”Ÿæˆçš„è™šå‡è´¦æˆ·å’ŒçœŸå®äººç±»ï¼ˆCivil Resistance/Sybil Resistanceï¼‰ã€‚
    

## [**Day 4: NFTs!!! ERC20 vs ERC721, IPFS, Metadata**](https://www.youtube.com/watch?v=NOdrEpnoCiM&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=4)

### å¸‚åœºæµè§ˆä¸å±æ€§ (Marketplace & Properties)

-   **å¹³å°ä½“éªŒ**ï¼šå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ OpenSea æµè§ˆ NFTã€‚
    
-   **å±æ€§ä¸ç¨€ç¼ºæ€§**ï¼šè§£é‡Šäº† NFT çš„å±æ€§ï¼ˆTraits/Propertiesï¼‰ï¼Œä¾‹å¦‚æŸä¸ªå¤´åƒçš„èƒŒæ™¯è‰²æˆ–é…é¥°ã€‚ç¨€ç¼ºæ€§æ˜¯ç”±æ™ºèƒ½åˆçº¦ä¸­è®¾å®šçš„æ€»é‡ï¼ˆTotal Supplyï¼‰å’Œå±æ€§çš„åˆ†å¸ƒå†³å®šçš„ã€‚
    
-   **å®ç”¨æ€§ (Utility)**ï¼šNFT ä¸ä»…ä»…æ˜¯å›¾ç‰‡ï¼Œè¿˜å¯ä»¥ä½œä¸ºé—¨ç¥¨ï¼ˆToken Gatingï¼‰ã€æŠ•ç¥¨æƒæˆ–æ¸¸æˆé“å…·ï¼ˆå¦‚è§†é¢‘ä¸­æåˆ°çš„èµ›é©¬ã€æ–—é¸¡æ¸¸æˆï¼‰ã€‚
    

### é“¸é€  NFT çš„ä¸¤ç§æ–¹å¼ (Minting Methods)

è§†é¢‘æ¼”ç¤ºäº†ä¸¤ç§æˆªç„¶ä¸åŒçš„é“¸é€ ä½“éªŒï¼š

-   **æ–¹å¼ä¸€ï¼šé€šè¿‡é¡¹ç›®å®˜ç½‘é“¸é€  (On-Chain NFT)**
    
    -   ä»–ä»¬è®¿é—®äº†ä¸€ä¸ªåä¸º "MetaAvatar" çš„é¡¹ç›®ç½‘ç«™ã€‚
        
    -   **On-Chainï¼ˆå…¨é“¾ä¸Šï¼‰**ï¼šè¿™ç»„ NFT ç‰¹åˆ«ä¹‹å¤„åœ¨äºå®ƒçš„å›¾åƒï¼ˆSVGä»£ç ï¼‰æ˜¯ç›´æ¥å­˜å‚¨åœ¨ä»¥å¤ªåŠæ™ºèƒ½åˆçº¦é‡Œçš„ï¼Œè€Œä¸æ˜¯å­˜å‚¨åœ¨å¤–éƒ¨æœåŠ¡å™¨ã€‚
        
    -   **äº’æ“ä½œæ€§æµ‹è¯•**ï¼šé“¸é€ å®Œæˆåï¼Œä»–ä»¬å°è¯•åœ¨ OpenSeaã€Zapperã€Rarible ç­‰ä¸åŒå¹³å°æŸ¥çœ‹è¯¥ NFTã€‚Austin æŒ‡å‡ºï¼ŒæŸäº›å¹³å°ï¼ˆå¦‚ Raribleï¼‰æ²¡æœ‰åŠæ—¶æ˜¾ç¤ºæˆ–å®¡æŸ¥äº†æŸäº›å†…å®¹ï¼Œè¿™ä½“ç°äº†**Web2 å¹³å°ï¼ˆå‰ç«¯ï¼‰çš„å®¡æŸ¥æ€§**ä¸**Web3 åè®®ï¼ˆåç«¯ï¼‰çš„æŠ—å®¡æŸ¥æ€§**ä¹‹é—´çš„å·®å¼‚â€”â€”åªè¦é“¾ä¸Šç¡®è®¤äº†ï¼Œä½ å°±æ‹¥æœ‰å®ƒï¼Œæ— è®ºå‰ç«¯æ˜¯å¦æ˜¾ç¤ºã€‚
        
-   **æ–¹å¼äºŒï¼šé€šè¿‡ Etherscan ç›´æ¥äº¤äº’ (Direct Contract Interaction)**
    
    -   Carlos éƒ¨ç½²äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç½‘ï¼ˆRinkebyï¼‰NFT åˆçº¦ã€‚
        
    -   **Power User æ“ä½œ**ï¼šä»–ä»¬æ²¡æœ‰ä½¿ç”¨ä»»ä½•å‰ç«¯ç½‘é¡µï¼Œè€Œæ˜¯ç›´æ¥åœ¨ **Etherscan** çš„ "Write Contract" é¡µé¢ï¼Œè¿æ¥é’±åŒ…å¹¶è°ƒç”¨ `mint` å‡½æ•°ã€‚
        
    -   è¿™å±•ç¤ºäº†åªè¦åˆçº¦å¼€æºä¸”ç»è¿‡éªŒè¯ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥ç»•è¿‡é¡¹ç›®æ–¹çš„å‰ç«¯ä¸æ™ºèƒ½åˆçº¦äº¤äº’ã€‚
        

### NFT çš„å­˜å‚¨å±‚ï¼šIPFS vs. HTTP

è¿™æ˜¯è§†é¢‘ä¸­æœ€ç¡¬æ ¸çš„æŠ€æœ¯éƒ¨åˆ†ï¼ŒAustin è¯¦ç»†æ‹†è§£äº† NFT åˆ°åº•æ˜¯ä»€ä¹ˆã€‚

-   **NFT çš„æœ¬è´¨**ï¼šåœ¨ ERC-721 æ ‡å‡†ä¸‹ï¼Œä½ æ‹¥æœ‰çš„å…¶å®æ˜¯ä¸€ä¸ª `TokenID`ï¼ˆä¾‹å¦‚ #1ï¼‰ã€‚
    
-   **å…ƒæ•°æ® (Metadata)**ï¼šæ™ºèƒ½åˆçº¦ä¸­æœ‰ä¸€ä¸ª `tokenURI` å‡½æ•°ï¼Œå®ƒæŒ‡å‘æè¿°è¿™ä¸ª NFT çš„æ–‡ä»¶ï¼ˆJSONæ ¼å¼ï¼ŒåŒ…å«åç§°ã€æè¿°ã€å›¾ç‰‡é“¾æ¥ï¼‰ã€‚
    
-   **IPFS (æ˜Ÿé™…æ–‡ä»¶ç³»ç»Ÿ)**ï¼š
    
    -   è§†é¢‘æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ Etherscan è¯»å– `tokenURI`ï¼Œè·å–ä¸€ä¸ª IPFS å“ˆå¸Œå€¼ã€‚
        
    -   **å†…å®¹å¯»å€ (Content Addressing)**ï¼šAustin æ¼”ç¤ºäº†å¦‚æœä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼ˆBuffalo -> Bisonï¼‰ï¼Œå“ˆå¸Œå€¼å°±ä¼šå½»åº•æ”¹å˜ã€‚è¿™ä¿è¯äº† **ä¸å¯ç¯¡æ”¹æ€§**ã€‚
        
    -   **ä¸­å¿ƒåŒ–é£é™© (Rug Pull)**ï¼šAustin è­¦å‘Šè¯´ï¼Œå¦‚æœ NFT çš„ `tokenURI` æŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ™®é€šçš„ HTTP é“¾æ¥ï¼ˆå¦‚ `aws.amazon.com/my-nft.png`ï¼‰ï¼Œé¡¹ç›®æ–¹éšæ—¶å¯ä»¥æŠŠå›¾ç‰‡æ¢æˆå…¶ä»–ä¸œè¥¿æˆ–è€…ç›´æ¥åˆ åº“è·‘è·¯ã€‚åªæœ‰å­˜å‚¨åœ¨ IPFS æˆ–å…¨é“¾ä¸Šçš„ NFT æ‰æ˜¯ç›¸å¯¹å®‰å…¨çš„ã€‚
        
    
    > **ä»€ä¹ˆæ˜¯ IPFSï¼Ÿ**
    > 
    > **IPFS (InterPlanetary File Systemï¼Œæ˜Ÿé™…æ–‡ä»¶ç³»ç»Ÿ)** æ˜¯ä¸€ä¸ªç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰çš„åˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨å’Œä¼ è¾“åè®®ã€‚å®ƒçš„ç›®æ ‡æ˜¯å–ä»£ HTTPï¼Œæ„å»ºä¸€ä¸ªæ›´å¿«ã€æ›´å®‰å…¨ã€æ›´å¼€æ”¾çš„ Webã€‚
    > 
    > **æœ€æ ¸å¿ƒçš„åŒºåˆ«ï¼š**
    > 
    > -   **HTTP (Web2):** åŸºäº**ä½ç½®**å¯»å€ (Location-based)ã€‚
    >     
    >     -   _â€œå»é˜¿é‡Œäº‘æ·±åœ³æœºæˆ¿çš„ X æœåŠ¡å™¨æ‰¾_ `photo.jpg`_ã€‚â€_
    >         
    >     -   ç¼ºç‚¹ï¼šå¦‚æœæœåŠ¡å™¨æŒ‚äº†ï¼Œæˆ–è€…æ–‡ä»¶è¢«åˆ äº†ï¼Œä½ å°±æ‰¾ä¸åˆ°äº†ï¼ˆ404ï¼‰ã€‚
    >         
    > -   **IPFS (Web3):** åŸºäº**å†…å®¹**å¯»å€ (Content-based)ã€‚
    >     
    >     -   _â€œæˆ‘è¦æ‰¾å“ˆå¸Œå€¼ä¸º_ `QmAbC...` _çš„é‚£å¼ ç…§ç‰‡ï¼Œæˆ‘ä¸å…³å¿ƒå®ƒåœ¨è°çš„ç”µè„‘é‡Œï¼Œè°æœ‰å°±ç»™æˆ‘ä¼ ä¸€ä»½ã€‚â€_
    >         
    >     
    > 
    > **IPFS çš„åŸç†ï¼ˆç®€å•ç‰ˆï¼‰**
    > 
    > 1.  **å†…å®¹å¯»å€ (Content Addressing) â€”â€” è§†é¢‘ä¸­æåˆ°çš„ "Cid"**
    >     
    > 
    > è¿™æ˜¯ IPFS çš„çµé­‚ã€‚ å½“ä½ æŠŠä¸€å¼ å›¾ç‰‡ä¸Šä¼ åˆ° IPFSï¼Œç³»ç»Ÿä¼šå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼ˆSHA-256ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„æŒ‡çº¹ï¼Œå« **CID (Content ID)**ã€‚
    > 
    > 2.  **é»˜å…‹å°”æœ‰å‘æ— ç¯å›¾ (Merkle DAG)**
    >     
    >     1.  Â Â IPFS ä¸ä¼šæŠŠå¤§æ–‡ä»¶ç›´æ¥å­˜è¿›å»ï¼Œè€Œæ˜¯åƒæ‹¼å›¾ä¸€æ ·ï¼š
    >         
    >     2.  Â Â **åˆ‡ç‰‡ï¼š** æŠŠå¤§æ–‡ä»¶ï¼ˆæ¯”å¦‚ä¸€éƒ¨ç”µå½±ï¼‰åˆ‡æˆæ¯å— 256KB çš„å°ç¢ç‰‡ã€‚
    >         
    >     3.  Â Â **å“ˆå¸Œï¼š** ç»™æ¯ä¸ªç¢ç‰‡ç®—ä¸€ä¸ªå“ˆå¸Œã€‚
    >         
    >     4.  Â Â **æ ‘çŠ¶ç»“æ„ï¼š** ç”¨ä¸€ä¸ªæ ¹å“ˆå¸Œï¼ˆRoot Hashï¼‰æŠŠè¿™äº›ç¢ç‰‡è¿èµ·æ¥ã€‚ è¿™ä½¿å¾— IPFS å¯ä»¥å»é‡ï¼ˆå¤§å®¶éƒ½æœ‰åŒæ ·çš„æ–‡ä»¶å¤´ï¼Œåªå­˜ä¸€ä»½å³å¯ï¼‰å’Œå¹¶è¡Œä¼ è¾“ã€‚
    >         
    > 3.  **åˆ†å¸ƒå¼å“ˆå¸Œè¡¨ (DHT) â€”â€” æ€ä¹ˆæ‰¾åˆ°æ–‡ä»¶ï¼Ÿ**
    >     
    >     1.  Â Â å½“ä½ å‘Šè¯‰ç½‘ç»œâ€œæˆ‘è¦ä¸‹è½½ `QmAbC...`â€æ—¶ï¼š
    >         
    >     2.  ä½ çš„ç”µè„‘ä¼šè¯¢é—®é™„è¿‘çš„èŠ‚ç‚¹ï¼šâ€œä½ çŸ¥é“è°æœ‰ `QmAbC...` å—ï¼Ÿâ€
    >         
    >     3.  ç½‘ç»œé€šè¿‡ DHTï¼ˆç±»ä¼¼ä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„ç”µè¯ç°¿ï¼‰å¿«é€Ÿå®šä½åˆ°æ‹¥æœ‰è¿™ä¸ªæ–‡ä»¶ç¢ç‰‡çš„èŠ‚ç‚¹ï¼ˆå¯èƒ½æ˜¯ä½ çš„é‚»å±…ï¼Œä¹Ÿå¯èƒ½æ˜¯åœ°çƒå¦ä¸€ç«¯çš„äººï¼‰ã€‚
    >         
    >     4.  **ç‚¹å¯¹ç‚¹ä¼ è¾“ï¼š** ä½ çš„ç”µè„‘åŒæ—¶ä»å‡ åä¸ªèŠ‚ç‚¹ä¸‹è½½ä¸åŒçš„ç¢ç‰‡ï¼Œæ‹¼æˆå®Œæ•´æ–‡ä»¶ã€‚
    >         
    > 4.  **inning (å›ºå®š) â€”â€” å…³é”®çš„â€œå‘â€**
    >     
    >     1.  Â Â è§†é¢‘é‡Œæåˆ°äº†ä¸€ç‚¹ï¼š**IPFS ä¸æ˜¯é­”æ³•ç¡¬ç›˜ã€‚** IPFS èŠ‚ç‚¹ï¼ˆæ¯”å¦‚ä½ è‡ªå·±çš„ç”µè„‘ï¼‰æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ã€‚å¦‚æœä½ ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿‡æ®µæ—¶é—´ä¸çœ‹ï¼Œç¼“å­˜ä¼šè¢«è‡ªåŠ¨æ¸…ç†ã€‚
    >         
    >     2.  **é—®é¢˜ï¼š** å¦‚æœä½ æ˜¯æŸä¸ªå†·é—¨ NFT çš„å”¯ä¸€æ‹¥æœ‰è€…ï¼Œä¸”ä½ å…³æœºäº†ï¼Œåˆ«äººå°±æ— æ³•é€šè¿‡ IPFS ä¸‹è½½è¿™ä¸ª NFT çš„å›¾ç‰‡äº†ï¼ˆè™½ç„¶é“¾ä¸Šçš„å“ˆå¸Œè¿˜åœ¨ï¼‰ã€‚
    >         
    >     3.  **è§£å†³ï¼š** ä½ éœ€è¦ **"Pin"**ï¼ˆå¤§å¤´é’ˆé’‰ä½ï¼‰è¿™ä¸ªæ–‡ä»¶ã€‚è¿™é€šå¸¸ç”± Infuraã€Pinata è¿™æ ·çš„æœåŠ¡å•†æ¥åšï¼ˆç±»ä¼¼ Web3 çš„äº‘ç›˜ï¼‰ï¼Œä»–ä»¬æ‰¿è¯ºæ°¸è¿œä¿æŒæœåŠ¡å™¨å¼€æœºå¹¶â€œé’‰ä½â€ä½ çš„æ–‡ä»¶ï¼Œç¡®ä¿å®ƒæ°¸è¿œåœ¨çº¿ã€‚
    >         
    

### ä»£ç å±‚é¢çš„ç†è§£ (Solidity Logic)

Austin å±•ç¤ºäº†æç®€ç‰ˆçš„ Solidity ä»£ç ï¼Œå¯¹æ¯”äº†åŒè´¨åŒ–ä»£å¸ï¼ˆFungibleï¼‰ä¸éåŒè´¨åŒ–ä»£å¸ï¼ˆNon-Fungibleï¼‰çš„åŒºåˆ«ï¼š

-   **Fungible (å¦‚ ERC-20)**ï¼šä½¿ç”¨ `mapping(address => uint256) balance`ã€‚ä¸»è¦è®°å½•â€œ**è°æœ‰å¤šå°‘ä¸ª**â€ã€‚è½¬è´¦åªæ˜¯åœ¨ä¸€ä¸ªå¤§è´¦æœ¬ä¸ŠåŠ å‡æ•°å­—ã€‚
    
-   **Non-Fungible (å¦‚ ERC-721)**ï¼šä½¿ç”¨ `mapping(uint256 => address) owner`ã€‚ä¸»è¦è®°å½•â€œ**è¿™ä¸ª ID å½’è°**â€ã€‚è½¬è´¦æ˜¯å°†ç‰¹å®š ID çš„æ‹¥æœ‰è€…ä¿®æ”¹ä¸ºæ–°åœ°å€ã€‚
    
-   **å…¨é“¾ä¸Š SVG**ï¼šå±•ç¤ºäº†å¦‚ä½•åœ¨ Solidity ä¸­ç”¨ä»£ç æ‹¼æ¥å­—ç¬¦ä¸²æ¥ç”Ÿæˆ SVG å›¾åƒï¼ˆå¦‚ `<circle cx="..." />`ï¼‰ï¼Œä½¿å¾—å›¾åƒæ•°æ®å®Œå…¨å­˜åœ¨åŒºå—é“¾ä¸Šã€‚
    

### æ€»ç»“

-   **è½¬è´¦çš„æœ¬è´¨**ï¼šå¹¶æ²¡æœ‰æ–‡ä»¶åœ¨ç½‘çº¿ä¸­ä¼ è¾“ï¼Œæ‰€æœ‰äººåªæ˜¯åœ¨åŒæ­¥æ›´æ–°åŒä¸€ä¸ªå»ä¸­å¿ƒåŒ–çš„è´¦æœ¬ï¼ˆçŠ¶æ€æœºï¼‰ã€‚
    
-   **ç‰ˆç¨ (Royalties)**ï¼šç®€è¦æåŠå¼€å‘è€…å¯ä»¥åœ¨åˆçº¦ä¸­å†™å…¥ç‰ˆç¨é€»è¾‘ï¼Œè®©åˆ›ä½œè€…åœ¨äºŒçº§å¸‚åœºäº¤æ˜“ä¸­æŒç»­è·åˆ©ã€‚
    
-   **æ ¸å¿ƒè§‚å¿µ**ï¼šä»â€œç”¨æˆ·â€è½¬å˜ä¸ºâ€œå¼€å‘è€…â€ï¼Œå­¦ä¼šæŸ¥çœ‹åˆçº¦æºç ã€ç†è§£å…ƒæ•°æ®å­˜å‚¨ä½ç½®ï¼ˆOn-chain vs IPFS vs Centralized Serverï¼‰æ˜¯åˆ¤æ–­ NFT ä»·å€¼å’Œå®‰å…¨æ€§çš„å…³é”®ã€‚
<!-- DAILY_CHECKIN_2026-01-17_END -->

# 2026-01-16
<!-- DAILY_CHECKIN_2026-01-16_START -->








## Unphishable é’“é±¼æ”»é˜²æŒ‘æˆ˜

ç¬¬ä¸€ç« æµ‹è¯•æ˜¯å®‰è£…å°ç‹ç‹¸

è¿æ¥é’±åŒ…

è¿æ¥æµ‹è¯•ç½‘ç»œ

é¢†å–æµ‹è¯•å¸

ä¹‹å‰å·²ç»åšè¿‡äº†ï¼ŒåŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆé—®é¢˜

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGM0NmUyMDg4Y2IwOTEyYjc2OWVlODRmOTYxMWViMWJfbGljdTFxcWIzQmEzNnBOaVVUcTJaTDVBTE1aMmpkTlBfVG9rZW46SEgyMmJvTHZQbzg1cG54eFo5OGNSeThqbktiXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=MjA2M2I5NmZjNzg5YWU5YzU2N2Y3Y2IyYjY5N2ZjMTFfYU1QUWR0RzNsQXhGeE5yYVBuM0N4WjRwc3pOb2tBR3JfVG9rZW46SUZFZ2JHdms4b1R1UDZ4UXNJdmMxQjRtbk5iXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)

ç„¶åç¬¬äºŒä¸ªå®éªŒæ˜¯é˜²é’“é±¼æµ‹è¯•

é’±åŒ…è¿™ä¸ªä¸œè¥¿ä¸æ˜¯ä¸¢äº†å°±ä¸¢äº†ï¼Œæ€ä¹ˆè¿˜èƒ½æ‰¾å›çš„ï¼‰ ä¹Ÿç®—æ˜¯é¡ºåˆ©é€šè¿‡

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDk5OThkYjUyNTYwMWFmNGJiMmMyZDNjYTgzMGUxYTJfY2NIaElNMHpRZEtCcEI1TFZjd1prUW1paHA0bHh6ZktfVG9rZW46RTF1bWJJSXdmb2VaRlF4UFQ1VmNIM2pRbjRlXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)

ç„¶åç¬¬ä¸‰ä¸ªå®éªŒæ˜¯è¯·æ±‚æ¯”æˆ‘èº«ä»½è¯å·éƒ½é•¿çš„æ”¯å‡ºä¸Šé™

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTY5ZDQzODE5MDJiYzliMTc5ZTgwY2ZjYmQzNDlhZTJfWkVVWmcxSFdQaXJJaHlJdnMzRUJJYWw2V1M4T3FqWjdfVG9rZW46UVdiUmJoSjVnb1ZaOTB4cVVFWWNzdTIxbk1iXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)

å–æ¶ˆåç›´æ¥å®Œæˆäº†

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=NTU4NWVjZjY5ZjUxMDY2MTdjOTA1MGE5YjkxM2E5NGVfcHRTSTJ2UWE1NGhnUmt4VW5qc3RwNGhzeGRVNnJBRHZfVG9rZW46T1RjUGJ1czRwb3JEbXF4bnJkRWM2TjJSbjllXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)

ç„¶åæ˜¯ç¬¬å››ä¸ªæµ‹è¯•ï¼Œæ€ä¹ˆé¢†å–ç©ºæŠ•è¿˜è¦æˆ‘è‡ªå·±èŠ±é’±çš„

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=Zjg2NDQ1YzkyZTRkNDQ0ZWYyMzU5NDg0MjRjNzFjZDJfT3lmNVRidGgzaW1EaDhXT2lkVjh4RkttNUhqUmhEdmpfVG9rZW46V3hMN2JteG92b0RLZFl4WlJkV2NTc2dibk1oXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)

ä¹Ÿæ˜¯é€šè¿‡äº†

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=MTlkNjFlM2IyNjgwMDRkMTQ1MzUyOTFkNTY1MDUzOGJfc0xlYnJLZXZpRXdCamFNcXRnY0ZTc0hFMkNlY0YwR3ZfVG9rZW46R01ETWJlYUs4b0tQbkh4aE9EUWNNRURSbmhmXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)

æ„Ÿè§‰æ€»ä¹‹å°±æ˜¯ä¸è¦èŠ±é’±ï¼‰

ç¬¬äº”ä¸ªä¹Ÿé€šè¿‡äº†

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=YzAxNGE2ZWVmZWRiMDFkMjdmZjFhMzFhNDU3MTA1ZWVfUVNlUmJyZ241eFYybFN3dnpmZU9JZjZQMUxaTDdzRlpfVG9rZW46TTNvMmJFQmIxb2RJVXB4RVg4aWNsNHlabkJlXzE3Njg1NjYwNDA6MTc2ODU2OTY0MF9WNA)

[app.un1swap.org](http://app.un1swap.org)

[app.uniswap.org](http://app.uniswap.org)

æŸ¥äº†ä¸€ä¸‹äº¤æ˜“ä¿¡æ¯çš„æ ¼å¼

```YAML
Transaction Hash:   0x5d2a... (å”¯ä¸€çš„äº¤æ˜“ID)
Status:             Success (æˆåŠŸ)
Block:              18234567
Timestamp:          1 min ago
Transaction Action: Swap 1,000 USDT for 0.5 ETH (æ˜ç¡®çš„æ“ä½œæè¿°)
From:               0xYourWalletAddress (ä½ çš„é’±åŒ…åœ°å€)
Interacted With (To): 0xUniswapRouterAddress (Uniswap å®˜æ–¹è·¯ç”±åˆçº¦ï¼Œä¸”é€šå¸¸æœ‰ç»¿å‹¾è®¤è¯)

ERC-20 Tokens Transferred: 
From 0xYourWallet... To 0xUniswapPool... For 1,000 USDT (Tether USD)
From 0xUniswapPool... To 0xYourWallet... For 0.5 WETH (Wrapped Ether)

Value:              0 ETH (å› ä¸ºä½ è½¬çš„æ˜¯ä»£å¸ï¼Œä¸æ˜¯ ETH æœ¬èº«)
Transaction Fee:    0.002 ETH (Gas è´¹)
```

é’“é±¼ä¿¡æ¯ä¸­

```YAML
Transaction Hash:
0x1b23f927c47a6cb68fb7207a42c600a34726c583082301d2b7626d5447a5e363
Status:
Success 20 Block Confirmations
Block:
3504400
Timestamp:
5 mins ago (Mar-17-2025 02:34:36 AM UTC)
Transaction Action:
Call Function by 0x4276BF06...a1B7D03Ce on 0x4d264c6A...41F757Fe5
From:
0x4276BF06Aebd8A1F3D89a1fd5BF84bFa1B7D03Ce
Interacted With (To):
0x4d264c6Ab8933633cd8B052dE243Fa41F757Fe5
ERC-20 Tokens Transferred:
From 0x4276BF06...a1B7D03Ce To 0xE1a9d5C7...615506D4
For 8,888 ERC-20: app.un1swap.org (UNI)
Value:
0 ETH
Transaction Fee:
0.0000001689464305 ETH
Gas Price:
0.003237514 Gwei (0.000000000003237514 ETH)
```

ERC-20 Tokens Transferred:

From 0x4276BF06...a1B7D03Ce To 0xE1a9d5C7...615506D4

For 8,888 ERC-20: [app.un1swap.org](http://app.un1swap.org) (UNI)

è¿™éƒ¨åˆ†æœ¬åº”è¯¥æ˜¯ä»£å¸åç§°çš„ï¼Œè¢«æ”¹æˆé’“é±¼é“¾æ¥äº†

ç„¶åä¸‹ä¸€ä¸ªæµ‹è¯•ä¹Ÿæ˜¯è¦æ— ä¸Šé™çš„è½¬è´¦
<!-- DAILY_CHECKIN_2026-01-16_END -->

# 2026-01-15
<!-- DAILY_CHECKIN_2026-01-15_START -->









### ä¸€ã€ å®è§‚èƒŒæ™¯ä¸åˆè§„åŸºæœ¬é€»è¾‘

1\. åˆè§„ vs. é£æ§

-   **ä¼ä¸šç«¯**ï¼šä¸»è¦å¼ºè°ƒâ€œåˆè§„â€ï¼ˆComplianceï¼‰ã€‚
    
-   **ä¸ªäººç«¯**ï¼šæœ¬è´¨æ˜¯â€œé£æ§â€ï¼ˆRisk Controlï¼‰ã€‚
    
-   **æ ¸å¿ƒçŸ›ç›¾**ï¼šæ³•å¾‹å…·æœ‰**æ»åæ€§**ï¼Œè€ŒWeb3è¡Œä¸šå…·æœ‰æ¿€è¿›æ€§å’Œåˆ›æ–°æ€§ã€‚åœ¨å¤§é™†è¯­å¢ƒä¸‹ï¼Œç”±äºæ”¿ç­–æ”¶ç´§ï¼Œåˆè§„ç©ºé—´ç‹­çª„ã€‚
    
-   **å¾‹å¸ˆçš„ä½œç”¨**ï¼šå°†æ»åçš„æ³•å¾‹è§„å®šä¸æ–°å…´ä¸šåŠ¡å½¢æ€è¿›è¡Œæ¢³ç†å’ŒåŒ¹é…ï¼Œé€šè¿‡è§„èŒƒä¸šåŠ¡åŠ¨ä½œæ¥è§„é¿æ³•å¾‹çº¢çº¿ã€‚
    

2\. åœ°åŸŸå·®å¼‚ï¼ˆå¤§é™† vs. é¦™æ¸¯ï¼‰

-   **æ³•æ— ç¦æ­¢å³è‡ªç”±**ï¼šåœ¨é¦™æ¸¯ç­‰åœ°ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®æ³•å¾‹ç¦æ­¢ï¼ˆå¦‚æ—©æœŸçš„æ‰¾æ¢åº—ï¼‰ï¼Œä¸šåŠ¡å¯ä»¥å¼€å±•ï¼›ä¸€æ—¦ç«‹æ³•ï¼ˆå¦‚ç¨³å®šå¸æ¡ä¾‹ï¼‰ï¼Œä¸šåŠ¡éœ€æ”¶ç¼©æˆ–æŒç‰Œã€‚
    
-   **å¤§é™†ç¯å¢ƒ**ï¼šå¼ºè°ƒåˆ‘äº‹åˆè§„ï¼Œç›‘ç®¡æ›´ä¸ºä¸¥å‰ï¼Œå¾€å¾€ç¼ºä¹æ˜ç¡®çš„â€œWeb3æ³•å¾‹â€ï¼Œè€Œæ˜¯å¥—ç”¨ç°æœ‰çš„åˆ‘æ³•ç½ªåã€‚
    

* * *

### äºŒã€ å…·ä½“ä¸šåŠ¡åœºæ™¯çš„é£é™©ä¸æ¡ˆä¾‹

1\. å‘å¸ä¸ICOï¼ˆéæ³•é›†èµ„é£é™©ï¼‰

-   **ç°çŠ¶**ï¼šå•çº¯å‘å¸ï¼ˆå¦‚Memeå¸ï¼‰æœ¬èº«ä¸ä¸€å®šæ„æˆçŠ¯ç½ªï¼Œä½†**â€œå…¬å¼€èèµ„â€**æ˜¯çº¢çº¿ã€‚
    
-   **è´Ÿé¢æ¸…å•**ï¼šå¤§é™†ä¸¥å‰æ‰“å‡»åˆ©ç”¨å‘å¸è¿›è¡Œå…¬å¼€èèµ„çš„è¡Œä¸ºï¼ˆICOï¼‰ã€‚
    
-   **æ¡ˆä¾‹**ï¼š
    
    -   **ç•œç‰§ä¸šç±»æ¯”**ï¼šâ€œè®¤å…»ä¸€å¤´ç‰›â€æ¨¡å¼è‹¥æ¶‰åŠä¼ é”€æœºåˆ¶å’Œå…¬å¼€èèµ„ï¼ŒåŒæ ·è¿è§„ã€‚
        
    -   **Mimi Coinæ¡ˆä¾‹**ï¼šæŸé¡¹ç›®ä»¿ç…§Meme Coinç©æ³•ï¼Œç¤¾åŒºå–Šå•åæ’¤å›æµåŠ¨æ€§ï¼Œå³ä¾¿è¯·äº†å›½å†…é¡¶å°–åˆ‘è¾©å¾‹å¸ˆï¼Œæœ€ç»ˆä»è¢«è®¤å®šä¸º**è¯ˆéª—ç½ª**ã€‚
        

2\. äº¤æ˜“æ‰€ä¸æ°¸ç»­åˆçº¦ï¼ˆå¼€è®¾èµŒåœºé£é™©ï¼‰

-   **åŠæ¡ˆé€»è¾‘**ï¼š
    
    -   åŠæ¡ˆäººå‘˜ä¸æ‡‚æŠ€æœ¯ï¼Œé€šå¸¸é—®ï¼šâ€œå¬è¿‡94ã€924å…¬å‘Šå—ï¼Ÿâ€è‹¥å¬è¿‡ä»ä»ä¸šï¼Œè¢«è§†ä¸ºæœ‰ä¸»è§‚çŠ¯ç½ªæ•…æ„ã€‚
        
    -   **å®šæ€§**ï¼šæ°¸ç»­åˆçº¦è¢«è§†ä¸ºâ€œå‹å¤§å°â€çš„èµŒåšï¼Œäº¤æ˜“æ‰€è¢«å®šæ€§ä¸º**å¼€è®¾èµŒåœº**ï¼ŒæŠ€æœ¯äººå‘˜ï¼ˆå³ä½¿ä¸»å¼ æŠ€æœ¯ä¸­ç«‹ï¼‰ä¼šè¢«è§†ä¸ºå…±çŠ¯ï¼ˆæä¾›æŠ€æœ¯æ”¯æŒï¼‰ã€‚
        
-   **è¾©æŠ¤éš¾ç‚¹**ï¼šè™½ç„¶å¾‹å¸ˆä¸»å¼ åˆçº¦æ˜¯é‡‘èæ´»åŠ¨ï¼ˆé£é™©æ§åˆ¶æƒåœ¨ç”¨æˆ·æ‰‹ä¸­ï¼‰è€ŒéèµŒåšï¼ˆä¹°å®šç¦»æ‰‹ï¼‰ï¼Œä½†åœ¨å¤§é™†è¯­å¢ƒä¸‹ï¼Œå¸¸å‡ºç°**â€œé€åˆ©æ€§æ‰§æ³•â€**ï¼ˆé€šè¿‡æ‰“å‡»äº¤æ˜“æ‰€å®ç°åœ°æ–¹è´¢æ”¿åˆ›æ”¶ï¼‰ã€‚
    
-   **åˆè§„å‡ºè·¯**ï¼š
    
    -   **å½¢å¼åˆè§„**ï¼šå®Œå–„æ³•å¾‹æ–‡æœ¬ã€‚
        
    -   **æ·±åº¦åˆè§„**ï¼šè¿™å°±æ¶‰åŠåˆ°â€œä¸­å›½ç‰¹è‰²â€çš„åˆè§„ï¼Œå³ä¸åœ°æ–¹å»ºç«‹è‰¯å¥½å…³ç³»ã€‚
        

3\. æŒ–çŸ¿ä¸šåŠ¡ï¼ˆæ”¿ç­–æ³¢åŠ¨ä¸è½¬å‹ï¼‰

-   **æ¼”å˜**ï¼šä»å…¨é¢ç¦æ­¢åˆ°éƒ¨åˆ†åœ°æ–¹æ”¿åºœé»˜è®¸å›æµã€‚
    
-   **è½¬å‹è·¯å¾„**ï¼šå°†æŒ–çŸ¿åŒ…è£…ä¸º**AIç®—åŠ›è¶…ç®—ä¸­å¿ƒ**ã€‚ä¸æ”¿åºœç­¾åè®®ï¼Œç”šè‡³è·å–æ”¿ç­–ç¦åˆ©ã€‚ç®—åŠ›å¯åˆè§„å¤–è´¸å–ç»™æµ·å¤–ï¼Œè‡³äºæµ·å¤–ä¹°å®¶æ˜¯ç”¨æ¥æŒ–çŸ¿è¿˜æ˜¯è·‘AIï¼Œåˆ™å±äºæœåŠ¡èŒƒç•´ï¼Œé£é™©éš”ç¦»ã€‚
    

4\. å»ä¸­å¿ƒåŒ–ä¸šåŠ¡ï¼ˆPolymarketç±»ï¼‰

-   **å®šæ€§**ï¼šè™½ç„¶ç¾å›½å¯èƒ½å°†å…¶è§†ä¸ºé‡‘èè¡ç”Ÿå“ï¼Œä½†åœ¨å¤§é™†æ³•å¾‹ä½“ç³»ä¸‹ï¼Œå¦‚æœåäººå¼€è®¾æ­¤ç±»é¢„æµ‹å¸‚åœºï¼Œå¿…è¢«å®šæ€§ä¸º**èµŒåš**ã€‚
    
-   **å»ºè®®**ï¼šå½»åº•å‡ºæµ·ï¼Œä¸è¦åœ¨å¤§é™†ç¡¬åˆšå¸æ³•è®¤å®šã€‚
    

* * *

### ä¸‰ã€ èµ„é‡‘ä¸è´¦æˆ·é£é™©ï¼ˆOTCã€å‡ºå…¥é‡‘ã€Uå•†ï¼‰

1\. ä¸ªäººå‡ºå…¥é‡‘ï¼ˆé£é™©æé«˜ï¼‰

-   **æ•°æ®**ï¼šå‡ºé‡‘æ¶‰æ¡ˆæ¯”ä¾‹åœ¨å¾‹æ‰€å’¨è¯¢ä¸­å æ¯”çº¦7%ã€‚
    
-   **ç°çŠ¶**ï¼š
    
    -   **å†»å¡é£é™©**ï¼šæ ¸å¿ƒæ˜¯æ”¶åˆ°èµƒæ¬¾ï¼ˆç”µä¿¡è¯ˆéª—ã€èµŒåšèµ„é‡‘ï¼‰ã€‚
        
    -   **è­¦æ–¹æ€åº¦**ï¼šéƒ¨åˆ†åœ°åŒºï¼ˆå†…è’™ã€æ–°ç–†ï¼‰ä»å€¾å‘è·¨çœæŠ“äººï¼›å…¶ä»–åœ°åŒºè‹¥èƒ½è¯æ˜â€œå–„æ„å–å¾—â€ï¼ˆä¸çŸ¥æ˜¯èµƒæ¬¾ã€ä»·æ ¼åˆç†ã€ç•™å­˜è¯æ®ï¼‰ï¼Œå¯åå•†è§£å†»ã€‚
        
    -   **ç¨åŠ¡é£é™©**ï¼šé€šè¿‡é¦™æ¸¯åˆè§„äº¤æ˜“æ‰€å‡ºé‡‘å›å›½ï¼Œå·²è¢«ç¨åŠ¡å±€ç›¯ä¸Šï¼Œè¦æ±‚**ç”³æŠ¥ç¨åŠ¡**ã€‚
        

2\. æ–°å‹é£é™©ï¼šå…¥é‡‘æ”»å‡»ï¼ˆæ´—é’±æ–°æ‰‹æ®µï¼‰

-   **èƒŒæ™¯**ï¼šæµ·å¤–èµ„é‡‘ç›˜æ´—é’±æˆæœ¬é«˜ã€é€šé“å°‘ã€‚
    
-   **æ‰‹æ³•**ï¼šæ´—é’±å›¢ä¼™æ‰¾æ™®é€šäººï¼ˆå¦‚æ­£è§„èŒä¸šè€…ï¼‰ï¼Œè¦æ±‚æ™®é€šäººä»˜5ä¸‡ç°é‡‘ï¼Œå›¢ä¼™å‘å…¶æŒ‡å®šè´¦æˆ·æ‰“å…¥10ä¸‡èµƒæ¬¾ã€‚
    
-   **åæœ**ï¼šè´¦æˆ·å› æ”¶èµƒæ¬¾è¢«å†»ç»“ç”šè‡³ç«‹æ¡ˆã€‚
    
-   **å»ºè®®**ï¼šè‹¥è´¦æˆ·è«åæ”¶åˆ°å¤§é¢èµ„é‡‘ï¼Œéœ€è­¦æƒ•å¹¶è€ƒè™‘ä¸»åŠ¨æŠ¥æ¡ˆç•™åº•ï¼›äº¤æ˜“å¿…é¡»æ ¸å®å¯¹æ‰‹æ–¹èº«ä»½ï¼ˆKYCï¼‰ã€‚
    

3\. Uå•†ï¼ˆUSDTäº¤æ˜“å•†ï¼‰

-   **ç»“è®º**ï¼šåœ¨å¤§é™†**åšä¸äº†**ï¼Œè¦åšåªèƒ½å»æµ·å¤–ã€‚
    
-   **ç»ˆæå½¢æ€**ï¼šåŠ å¯†æ”¯ä»˜ï¼ˆCrypto Paymentï¼‰ã€‚
    
-   **Bç«¯é£é™©**ï¼šå³ä¾¿åšBç«¯ç”Ÿæ„ï¼Œä¹Ÿéš¾å…è¢«â€œè½¦é˜Ÿâ€ï¼ˆæµ·å¤–æ´—é’±å›¢ä¼™/åœ°ä¸‹é’±åº„ï¼‰ç›¯ä¸Šï¼Œæ··å…¥é»‘é’±å¯¼è‡´è´¦æˆ·è¿åå†»ç»“ã€‚
    

4\. Uå¡ï¼ˆåŠ å¯†ä¿¡ç”¨å¡ï¼‰é£é™©

-   **æŒ‚é å…¬å¸é£é™©**ï¼šå‘å¡æ–¹å°†ç”¨æˆ·æŒ‚é ä¸ºå…¬å¸å‘˜å·¥ï¼Œä¸€æ—¦å…¬å¸è¢«æŸ¥ï¼Œèµ„é‡‘å†»ç»“ã€‚
    
-   **â€œç§æ± â€é£é™©**ï¼šå‘å¡æ–¹æ˜¯ä¸ªäººç»„å±€ï¼Œèµ„é‡‘åœ¨å…¶æ§åˆ¶çš„å¤šç­¾é’±åŒ…æˆ–ä¸ªäººåœ°å€ä¸­ã€‚è‹¥åˆä¼™äººé—¹ç¿»ã€è¢«æŠ“æˆ–è·‘è·¯ï¼Œç”¨æˆ·èµ„é‡‘å½’é›¶ã€‚
    

* * *

### å››ã€ é¡¹ç›®æ–¹ä¸KOLçš„è¡ç”Ÿé£é™©

1\. é¡¹ç›®æ–¹ç»è¥é£é™©

-   **â€œé…å¢å…¬å¸â€/æŠ€æœ¯ä¾¦æŸ¥**ï¼šå¤§é™†å­˜åœ¨ä¸å…¬å®‰åˆä½œçš„æŠ€æœ¯å…¬å¸ï¼Œä¸“é—¨åˆ†æé“¾ä¸Šæ•°æ®ã€å§åº•é¡¹ç›®ç¾¤ã€å›ºå®šè¯æ®ï¼Œä¸¾æŠ¥åä»ç½šæ²¡æ¬¾ä¸­**æ‹¿è¿”ç‚¹**ã€‚
    
-   **å¸¸è§ç½ªå**ï¼š
    
    -   **éæ³•å¸æ”¶å…¬ä¼—å­˜æ¬¾/é›†èµ„è¯ˆéª—**ï¼šé’ˆå¯¹å…¬å¼€å‹Ÿèµ„ã€‚
        
    -   **éæ³•ç»è¥ç½ª**ï¼šå£è¢‹ç½ªï¼Œæ¶‰åŠæ³•å¸ä¸è™šæ‹Ÿå¸å…‘æ¢ï¼ˆå¯¹æ•²ï¼‰ã€‚
        
    -   **ç»„ç»‡ã€é¢†å¯¼ä¼ é”€æ´»åŠ¨ç½ª**ï¼š
        
        -   è¯¯åŒºï¼šè®¤ä¸ºåªæœ‰ä¸¤çº§ã€ä¸ç›´æ¥åˆ†æ¶¦å°±æ²¡äº‹ã€‚
            
        -   ç°å®ï¼šå¸æ³•å®è·µç›´æ¥ç©¿é€ï¼Œå®è´¨é‡äºå½¢å¼ã€‚
            

2\. KOLï¼ˆå…³é”®æ„è§é¢†è¢–ï¼‰é£é™©

-   **æ¡ˆä¾‹**ï¼š
    
    -   æŸèµ„è®¯å¹³å°å› ç»™æµ·å¤–äº¤æ˜“æ‰€ï¼ˆè¢«å®šæ€§ä¸ºèµŒåšç½‘ç«™ï¼‰æ‰“å¹¿å‘Šï¼Œå‘˜å·¥è¢«æŠ“ï¼Œå®šç½ª\*\*â€œéæ³•åˆ©ç”¨ä¿¡æ¯ç½‘ç»œç½ªâ€\*\*ã€‚
        
    -   ä¸ªäººKOLæ¥äº¤æ˜“æ‰€æ¨å¹¿ï¼Œæ‹¿è¿”ä½£ï¼ˆRebateï¼‰ï¼Œè¢«å®šæ€§ä¸º**å¼€è®¾èµŒåœºç½ªçš„å…±çŠ¯**ã€‚
        
-   **æ±‚èŒå»ºè®®**ï¼šå…¥èŒWeb3å…¬å¸è‹¥æ¶‰åŠåˆçº¦ã€æœŸæƒæ¿å—ï¼Œé£é™©è¾ƒé«˜ã€‚
    

* * *

### äº”ã€ æ€»ç»“ä¸å»ºè®®

1.  **å‡ºæµ·æ˜¯æ ¸å¿ƒ**ï¼šåœ¨å¤§é™†åšWeb3åˆè§„æå…¶å›°éš¾ï¼Œå»ºè®®ä¸šåŠ¡å’Œäººå‘˜ä¸»ä½“å‡ºæµ·ã€‚
    
2.  **ä¸è¦æŠ±ä¾¥å¹¸å¿ƒç†**ï¼šå½¢å¼ä¸Šçš„åˆè§„ï¼ˆå¦‚å±‚çº§è®¾è®¡ã€æŠ€æœ¯ä¸­ç«‹è¯´è¾ï¼‰åœ¨å¤§é™†ç©¿é€å¼æ‰§æ³•é¢å‰å¾€å¾€æ— æ•ˆã€‚
    
3.  **æ·±åº¦åˆè§„**ï¼šå¦‚æœå¿…é¡»åœ¨å¤§é™†å±•ä¸šï¼Œé™¤äº†æ³•å¾‹æ–‡æœ¬åˆè§„ï¼Œè¿˜éœ€è¦å»ºç«‹â€œä¸­å›½ç‰¹è‰²â€çš„æ·±åº¦åˆè§„ï¼ˆå¦‚ä¸åœ°æ–¹æ”¿åºœã€ç›‘ç®¡çš„è‰¯å¥½æ²Ÿé€šä¸åˆä½œï¼‰ã€‚
    
4.  **è­¦æƒ•æ–°å‹çŠ¯ç½ª**ï¼šå¦‚å…¥é‡‘æ”»å‡»ã€é…å¢å…¬å¸çš„é’“é±¼æ‰§æ³•ç­‰ã€‚
    

**ç»“æŸè¯­**ï¼šåˆè§„ä¸ä»…æ˜¯é’ˆå¯¹Web3ï¼Œä»»ä½•è¡Œä¸šåœ¨å¤§é™†è¿›è¡Œéæ³•å‹Ÿèµ„æˆ–è¿è§„é‡‘èæ´»åŠ¨éƒ½ä¼šå—åˆ°æ‰“å‡»ã€‚åœ¨å½“å‰ç¯å¢ƒä¸‹ï¼Œä¿æŠ¤å¥½è‡ªå·±ï¼ˆäººèº«å®‰å…¨ä¸èµ„äº§å®‰å…¨ï¼‰æ˜¯ç¬¬ä¸€è¦åŠ¡ã€‚
<!-- DAILY_CHECKIN_2026-01-15_END -->

# 2026-01-14
<!-- DAILY_CHECKIN_2026-01-14_START -->










## w1d3

-   **å…¥é—¨æŠ€æœ¯&æ·±åº¦æŠ€æœ¯ä»»åŠ¡**
    
    -   [**Day 2: Becoming a Power User - Wallets, Mnemonics, Keypairs**](https://www.youtube.com/watch?v=_GjPeRLCREA&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=2)
        
    -   021 ä»¥å¤ªåŠ ç¬¬å››ç« 
        
-   **RuståŸºç¡€**
    
    -   10 [Generic Types, Traits, and Lifetimes](https://rust-book.cs.brown.edu/ch10-00-generics.html#generic-types-traits-and-lifetimes)
        
-   **æ‚é¡¹**
    
    -   æ”¹å·å­
        
    -   æ•´ç†ä¼ä¸šé¡¹ç›®æ–¹æ¡ˆ
        

æœ‰ç‚¹æ…¢äº†ï¼Œæ„Ÿè§‰èµ°è¿œäº†

æ€»ä¹‹åŠ æ²¹å¹²å§è¿˜èƒ½æ€ä¹ˆåŠï¼Œå®åœ¨ä¸è¡Œæ˜å¤©å¼€å§‹äº‰å–èƒ½æŠŠä¸Šåˆçš„æ—¶é—´å˜æˆå­¦ä¹ çš„

çœ‹ç€åé¢å‡ å¤©çš„ä»»åŠ¡å¥½åƒä¸å¤šï¼Œç­‰åˆ°å‘¨äº”å…­æ—¥çŒ›çŒ›è¡¥è¿›åº¦å§

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=OTBlNGEwODFkNTY1N2Q3NDZhMTFiNTJhNzgyNDM4OTFfU2NtN1A5bkF6ZXR2YmY2eFN0VGUybmo3djFXRFhKWDhfVG9rZW46VFBrb2JFcWtsb0dMT3p4VHRpMGNHTG5FbmJhXzE3NjgzNjc4Mjk6MTc2ODM3MTQyOV9WNA)

* * *

-   [https://layer2.myfirst.io/#1.3-layer2](https://layer2.myfirst.io/#1.3-layer2)
    

ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™æ‰“å¼€çš„ç½‘é¡µï¼Œåé¢çœ‹ä¸€ä¸‹

## Rust åŸºç¡€[Generic Types, Traits, and Lifetimes](https://rust-book.cs.brown.edu/ch10-00-generics.html#generic-types-traits-and-lifetimes)

### Generic Types æ³›å‹

åœ¨å‡½æ•°ä½“ä¸­ä½¿ç”¨å‚æ•°æ—¶ï¼Œå¿…é¡»å£°æ˜è¯¥å‚æ•°ã€‚ å‚æ•°ç­¾åä¸­åº”åŒ…å«å‚æ•°åç§°ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨çŸ¥é“è¯¥åç§°çš„å«ä¹‰ã€‚

å®šä¹‰æ³›å‹å‡½æ•°ï¼Œæˆ‘ä»¬å°†ç±»å‹åç§°å£°æ˜æ”¾åœ¨å°–æ‹¬å·å†…ã€‚ åœ¨å‡½æ•°åå’Œå‚æ•°åˆ—è¡¨ä¹‹é—´ `<>` ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```Rust
fn largest<T>(list: &[T]) -> &T {
```

æˆ‘ä»¬æŠŠè¿™ä¸ªå®šä¹‰ç†è§£ä¸ºï¼šå‡½æ•° `largest` åœ¨æŸç§ç±»å‹ä¸Šæ˜¯æ³›å‹çš„ `T` æ­¤å‡½æ•°æœ‰ä¸€ä¸ªåä¸º `list` çš„å‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»å‹ä¸º `T` çš„å€¼çš„åˆ‡ç‰‡ã€‚ `largest` å‡½æ•°å°†è¿”å›å¯¹ç›¸åŒç±»å‹ `T` çš„å€¼çš„å¼•ç”¨ã€‚

**ç”¨æ³›å‹å®šä¹‰ç»“æ„ä½“**

```Rust
struct Point<T> {
    x: T,
    y: T,
}

fn main() {
    let integer = Point { x: 5, y: 10 };
    let float = Point { x: 1.0, y: 4.0 };
}
```

```Rust
struct Point<T, U> {
    x: T,
    y: U,
}

fn main() {
    let both_integer = Point { x: 5, y: 10 };
    let both_float = Point { x: 1.0, y: 4.0 };
    let integer_and_float = Point { x: 5, y: 4.0 };
}
```

ç”¨æ³›å‹å®šä¹‰æšä¸¾

```Rust
enum Option<T> {
    Some(T),
    None,
}
```

```Rust
enum Result<T, E> {
    Ok(T),
    Err(E),
}
```

**å®šä¹‰ç›¸å…³æ–¹æ³•**

```Rust
struct Point<T> {
    x: T,
    y: T,
}

impl<T> Point<T> {
    fn x(&self) -> &T {//å‡½æ•°åä¸å­—æ®µåç›¸åŒï¼Œæ˜¯å› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹å­—æ®µåæ˜¯ç§æœ‰çš„ï¼Œéœ€è¦é€šè¿‡æ–¹æ³•æ¥è®¿é—®
        &self.x
    }
}

fn main() {
    let p = Point { x: 5, y: 10 };

    println!("p.x = {}", p.x());
}
```

ä¸ºç‰¹å®šç±»å‹f32å®ç°æ–¹æ³•

```Rust
impl Point<f32> {
    fn distance_from_origin(&self) -> f32 {
        (self.x.powi(2) + self.y.powi(2)).sqrt()
    }
}
```

ä½ ä¸èƒ½åŒæ—¶å®ç°åŒåçš„ç‰¹å®šæ–¹æ³•_å’Œ_é€šç”¨æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä¸ºæ‰€æœ‰ç±»å‹ `T` å®ç°äº†ä¸€ä¸ªé€šç”¨çš„ `distance_from_origin` æ–¹æ³•ï¼Œåˆä¸º `f32` å®ç°äº†ä¸€ä¸ªç‰¹å®šçš„ `distance_from_origin ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šæ‹’ç»ä½ çš„ç¨‹åºï¼šRust ä¸çŸ¥é“åœ¨è°ƒç”¨` `Point<f32>::distance_from_origin` \` æ—¶åº”è¯¥ä½¿ç”¨å“ªä¸ªå®ç°ã€‚

**å¦‚ä½•åœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œæ··åˆä½¿ç”¨â€œç»“æ„ä½“å®šä¹‰çš„æ³›å‹â€å’Œâ€œæ–¹æ³•è‡ªå¸¦çš„æ³›å‹â€**

```Rust
struct Point<X1, Y1> {
    x: X1,
    y: Y1,
}

impl<X1, Y1> Point<X1, Y1> {
    fn mixup<X2, Y2>(self, other: Point<X2, Y2>) -> Point<X1, Y2> {
        Point {
            x: self.x,
            y: other.y,
        }
    }
}

fn main() {
    let p1 = Point { x: 5, y: 10.4 };
    let p2 = Point { x: "Hello", y: 'c' };

    let p3 = p1.mixup(p2);

    println!("p3.x = {}, p3.y = {}", p3.x, p3.y);
}
```

**Rust çš„æ³›å‹æ²¡æœ‰ä»»ä½•è¿è¡Œæ—¶æ€§èƒ½æŸè€—**

ä¸‹é¢è¿™ä¸ªä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘

```Rust
fn print_slice<T>(v: &[T]) {
  for x in v {
    println!("{x}");
  }
}
fn main() {
  print_slice(&[1, 2, 3]);
}
```

Rust çš„ç¼–è¯‘å™¨éå¸¸ä¸¥è°¨ã€‚è™½ç„¶ä½ è¯´ `T` å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œä½†å¹¶éæ‰€æœ‰ç±»å‹éƒ½èƒ½ç”¨ `{}` æ ¼å¼æ¥æ‰“å°ã€‚

éœ€è¦ç»™ `T` åŠ ä¸€ä¸ªçº¦æŸï¼Œå‘Šè¯‰ç¼–è¯‘å™¨ï¼šâ€œæˆ‘åªæ¥å—é‚£äº›**å®ç°äº†æ‰“å°åŠŸèƒ½**çš„ç±»å‹â€ã€‚

```Rust
use std::fmt::Display; // å¼•å…¥ Display ç‰¹å¾

// å…³é”®ç‚¹ï¼š<T: Display>
// è¿™å¥è¯çš„æ„æ€æ˜¯ï¼šT å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œä½†å‰ææ˜¯å®ƒå¿…é¡»èƒ½è¢«æ‰“å°
fn print_slice<T: Display>(v: &[T]) {
    for x in v {
        println!("{x}");
    }
}

fn main() {
    print_slice(&[1, 2, 3]);
}
```

### Trait

Trait å®šä¹‰äº†ä¸€ç§â€œå…±åŒçš„è¡Œä¸ºâ€æˆ–â€œèƒ½åŠ›â€

ç±»ä¼¼æ¥å£ï¼Œéœ€è¦ç»™å‡ºä¸€äº›éœ€è¦å®ç°çš„åŠŸèƒ½

ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰å¤šä¸ªç»“æ„ä½“ï¼Œåˆ†åˆ«ä¿å­˜å„ç§ç±»å‹å’Œæ•°é‡çš„æ–‡æœ¬ï¼š

-   ä¸€ä¸ª `NewsArticle` ç»“æ„ä½“ï¼Œç”¨äºä¿å­˜ç‰¹å®šä½ç½®çš„æ–°é—»æŠ¥é“ï¼›
    
-   ä¸€ä¸ª `SocialPost` ç»“æ„ä½“ï¼Œæœ€å¤šå¯ä»¥åŒ…å« 280 ä¸ªå­—ç¬¦ï¼Œä»¥åŠæŒ‡ç¤ºå®ƒæ˜¯æ–°å¸–å­ã€è½¬å‘å¸–å­è¿˜æ˜¯å¯¹å¦ä¸€ä¸ªå¸–å­çš„å›å¤çš„å…ƒæ•°æ®ã€‚
    

æˆ‘ä»¬å¸Œæœ›åˆ›å»ºä¸€ä¸ªåä¸º `aggregator` çš„åª’ä½“èšåˆåº“ crateï¼Œå®ƒèƒ½å¤Ÿæ˜¾ç¤ºå¯èƒ½å­˜å‚¨åœ¨ `NewsArticle` æˆ– `SocialPost` å®ä¾‹ä¸­çš„æ•°æ®æ‘˜è¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¯ç§ç±»å‹çš„æ‘˜è¦ï¼Œå¹¶ä¸”å°†é€šè¿‡åœ¨å®ä¾‹ä¸Šè°ƒç”¨ `summarize` æ–¹æ³•æ¥è¯·æ±‚è¯¥æ‘˜è¦ã€‚æ¸…å• 10-12 å±•ç¤ºäº†ä¸€ä¸ªå…¬å¼€çš„ `Summary` ç‰¹æ€§çš„å®šä¹‰ï¼Œè¯¥ç‰¹æ€§è¡¨è¾¾äº†è¿™ç§è¡Œä¸ºã€‚

```Rust
pub trait Summary {
    fn summarize(&self) -> String;
}
```

**åœ¨ç±»å‹ä¸Šå®ç°ç‰¹æ€§**

```Rust
pub struct NewsArticle {
    pub headline: String,
    pub location: String,
    pub author: String,
    pub content: String,
}

impl Summary for NewsArticle {
    fn summarize(&self) -> String {
        format!("{}, by {} ({})", self.headline, self.author, self.location)
    }
}

pub struct SocialPost {
    pub username: String,
    pub content: String,
    pub reply: bool,
    pub repost: bool,
}

impl Summary for SocialPost {
    fn summarize(&self) -> String {
        format!("{}: {}", self.username, self.content)
    }
}
```

åœ¨ä¸€ä¸ªç±»å‹ä¸Šå®ç°ç‰¹æ€§ä¸å®ç°å¸¸è§„æ–¹æ³•ç±»ä¼¼ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œåœ¨ `impl` åé¢ï¼Œæˆ‘ä»¬æ”¾ç½®è¦å®ç°çš„ç‰¹æ€§åç§°ï¼Œç„¶åä½¿ç”¨ `for` å…³é”®å­—ï¼Œæ¥ç€æŒ‡å®šè¦ä¸ºå…¶å®ç°ç‰¹æ€§çš„ç±»å‹åç§°ã€‚

éœ€è¦ trait æˆ–è€… ç±»å‹ åœ¨å½“å‰ crate æ‰å¯ä»¥ä¸ºå…¶å®ç° trait

**é»˜è®¤å®ç°**

```Rust
pub trait Summary {
    fn summarize(&self) -> String {
        String::from("(Read more...)")
    }
}
```

åç»­å¯ä»¥é€‰æ‹©ä¿ç•™ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¦†ç›–

```Rust
pub trait Summary {
    fn summarize_author(&self) -> String;

    fn summarize(&self) -> String {
        format!("(Read more from {}...)", self.summarize_author())
    }
}
```

ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼Œç›´æ¥è°ƒç”¨åˆ«çš„ trait

**å°† Trait ä½œä¸ºå‚æ•°**

```Rust
pub fn notify(item: &impl Summary) {
    println!("Breaking news! {}", item.summarize());
}
```

ä¸Šé¢çš„ä»£ç æ„æ€æ˜¯ item éœ€è¦æ˜¯å®ç°äº† Summary trait çš„ç±»å‹

**Trait Bound çº¦æŸ**

```Rust
pub fn notify<T: Summary>(item: &T) {
    println!("Breaking news! {}", item.summarize());
}
```

è·Ÿåˆšæ‰çš„ä»£ç åŠŸèƒ½ä¸Šä¸€æ ·ï¼Œä¸è¿‡åˆšæ‰çš„ä»£ç ä½¿ç”¨äº†è¯­æ³•ç³–ï¼Œæ›´ç®€å•ä¸€äº›ï¼Œè¿™ä¸ªæ˜¯å±•å¼€çš„å†™æ³•

è¿™ç§å†™æ³•æ¯”è¾ƒé€‚ç”¨äºæ›´å¤æ‚çš„æƒ…å†µï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä¸¤ä¸ªå®ç° `Summary` çš„å‚æ•°ã€‚ä½¿ç”¨ `impl Trait` è¯­æ³•çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```Rust
pub fn notify(item1: &impl Summary, item2: &impl Summary) {
```

å¦‚æœæˆ‘ä»¬å¸Œæœ›å¼ºåˆ¶ä¸¤ä¸ªå‚æ•°å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ç‰¹å¾çº¦æŸï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```Rust
pub fn notify<T: Summary>(item1: &T, item2: &T) {
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šå¤šä¸ªç‰¹è´¨çº¦æŸã€‚

```Rust
pub fn notify(item: &(impl Summary + Display)) {
```

```Rust
pub fn notify<T: Summary + Display>(item: &T) {
```

ä½†æ˜¯å¦‚æœé¢å¯¹æ›´å¤æ‚çš„æƒ…å†µï¼Œä¼šå¯¼è‡´å‡½æ•°ç­¾åè¿‡é•¿ï¼Œå¯ä»¥ä½¿ç”¨ where

```Rust
fn some_function<T: Display + Clone, U: Clone + Debug>(t: &T, u: &U) -> i32 {

fn some_function<T, U>(t: &T, u: &U) -> i32
where
    T: Display + Clone,
    U: Clone + Debug,
{
```

å¯ä»¥åœ¨è¿”å›ä½ç½®ä½¿ç”¨ `impl Trait` è¯­æ³•æ¥è¿”å›ä¸€ä¸ªå®ç°æŸä¸ªç‰¹å¾çš„ç±»å‹çš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```Rust
fn returns_summarizable() -> impl Summary {
```

åªèƒ½åœ¨ä½¿ç”¨å•ä¸ªè¿”å›ç±»å‹æ—¶ä½¿ç”¨ `impl Trait` ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç è¿”å›ä¸€ä¸ª `NewsArticle` æˆ–ä¸€ä¸ª `SocialPost` ï¼Œå¹¶ä¸”å°†è¿”å›ç±»å‹æŒ‡å®šä¸º `impl Summary` ï¼Œè¿™æ ·å°†æ— æ³•å·¥ä½œ

```Rust
fn returns_summarizable(switch: bool) -> impl Summary {
    if switch {
        NewsArticle {}
    } else {
        SocialPost {}
    }
}
```

å³ä½¿ä½ ç”¨äº† `impl Trait` éšè—äº†å…·ä½“ç±»å‹ï¼Œä½†åœ¨ç¼–è¯‘æ—¶ï¼Œ**è¯¥å‡½æ•°çš„æ‰€æœ‰åˆ†æ”¯è¿”å›çš„å…·ä½“ç±»å‹å¿…é¡»å®Œå…¨ä¸€æ ·ã€‚**

**ä½¿ç”¨ trait bound æ¡ä»¶æ€§çš„å®ç°æ–¹æ³•**

```Rust
use std::fmt::Display;

struct Pair<T> {
    x: T,
    y: T,
}

impl<T> Pair<T> {
    fn new(x: T, y: T) -> Self {
        Self { x, y }
    }
}

impl<T: Display + PartialOrd> Pair<T> {//ç»™åªæœ‰å®ç°äº† Display + PartialOrd trait çš„ T å®ç°çš„åŠŸèƒ½
    fn cmp_display(&self) {
        if self.x >= self.y {
            println!("The largest member is x = {}", self.x);
        } else {
            println!("The largest member is y = {}", self.y);
        }
    }
}
```

### ç”Ÿå‘½å‘¨æœŸ

-   ä¸€ç§æ³›å‹
    
-   ç”Ÿå‘½å‘¨æœŸç¡®ä¿å¼•ç”¨åœ¨æˆ‘ä»¬éœ€è¦å®ƒä»¬æœ‰æ•ˆçš„æ—¶é—´å†…å§‹ç»ˆæœ‰æ•ˆ
    

ç”Ÿå‘½å‘¨æœŸçš„ä¸»è¦ç›®çš„æ˜¯é˜²æ­¢æ‚¬å‚å¼•ç”¨

```Rust
fn main() {
    let r;
    {
        let x = 5;
        r = &x;
    }
    println!("r: {}", r);
}
```

ç®€å•æ¥è¯´å°±æ˜¯æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜**åŸæœ¬æ˜¯æœ‰æ•ˆçš„**ï¼Œä½†æ˜¯åæ¥è¢«é‡Šæ”¾ï¼ˆfree/dropï¼‰äº†ï¼Œè€ŒæŒ‡é’ˆè¿˜åœ¨

```Rust
fn longest(x: &str, y: &str) -> &str {
    if x.len() > y.len() { x } else { y }
}
```

ç¼–è¯‘å™¨åœ¨æ£€æŸ¥ `longest` å‡½æ•°æ—¶ï¼Œæ˜¯ä¸€ä¸ª **å±€éƒ¨æ£€æŸ¥ (Local Analysis)**ã€‚å®ƒåªç›¯ç€è¿™ä¸ªå‡½æ•°çœ‹ï¼Œçœ‹ä¸åˆ°å¤–éƒ¨æ˜¯è°åœ¨è°ƒç”¨å®ƒï¼ˆçœ‹ä¸åˆ° `main` å‡½æ•°é‡Œçš„èŠ±æ‹¬å·ï¼‰ã€‚

å¦‚æœå‡½æ•°è¿”å› `x`ï¼Œé‚£ä¹ˆè¿”å›å€¼çš„å¯¿å‘½ = `x` çš„å¯¿å‘½ã€‚

å¦‚æœå‡½æ•°è¿”å› `y`ï¼Œé‚£ä¹ˆè¿”å›å€¼çš„å¯¿å‘½ = `y` çš„å¯¿å‘½ã€‚

ç°åœ¨é—®é¢˜æ¥äº†ï¼šæ—¢ç„¶ä¸çŸ¥é“è¿”å›è°ï¼Œé‚£ç¼–è¯‘å™¨åº”è¯¥è¦æ±‚è¿”å›å€¼çš„å¯¿å‘½å¿…é¡»å¤šé•¿æ‰å®‰å…¨å‘¢ï¼Ÿå®ƒé™·å…¥äº†é€»è¾‘æ­»å¾ªç¯ã€‚

æ—¢ç„¶ç¼–è¯‘å™¨çŒœä¸åˆ°ï¼Œæˆ‘ä»¬å°±æ‰‹åŠ¨å†™ä¸‹â€œç”Ÿæ­»å¥‘çº¦â€ã€‚

**å¥‘çº¦å†…å®¹ (**`'a`**)**ï¼šæˆ‘ä»¬å‘Šè¯‰ç¼–è¯‘å™¨ï¼šâ€œåˆ«ç®¡å…·ä½“æ˜¯ `x` è¿˜æ˜¯ `y`ï¼Œåæ­£**è¿”å›å€¼çš„å¯¿å‘½**è‚¯å®šä¸ä¼šæ¯” **è¾“å…¥å‚æ•°é‡Œå¯¿å‘½æœ€çŸ­çš„é‚£ä¸ª** æ›´é•¿ã€‚â€

**ç”Ÿå‘½å‘¨æœŸæ³¨è§£è¯­æ³•**

Â Â ç”Ÿå‘½å‘¨æœŸæ³¨è§£ä¸ä¼šæ”¹å˜ä»»ä½•å¼•ç”¨çš„å­˜æ´»æ—¶é—´

Â Â ç”Ÿå‘½å‘¨æœŸæ³¨è§£çš„è¯­æ³•ç•¥æœ‰ä¸åŒï¼šç”Ÿå‘½å‘¨æœŸå‚æ•°çš„åç§°å¿…é¡»ä»¥æ’‡å·ï¼ˆ `'` ï¼‰å¼€å¤´ï¼Œé€šå¸¸å…¨éƒ¨å°å†™ä¸”éå¸¸ç®€çŸ­ï¼Œç±»ä¼¼äºæ³›å‹ç±»å‹ã€‚å¤§å¤šæ•°äººä½¿ç”¨ `'a` ä½œä¸ºç¬¬ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ³¨è§£çš„åç§°ã€‚æˆ‘ä»¬å°†ç”Ÿå‘½å‘¨æœŸå‚æ•°æ³¨è§£æ”¾åœ¨å¼•ç”¨çš„ `&` ä¹‹åï¼Œç”¨ç©ºæ ¼å°†æ³¨è§£ä¸å¼•ç”¨çš„ç±»å‹åˆ†å¼€

Â Â ä»…æœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ ‡æ³¨æœ¬èº«å¹¶æ²¡æœ‰å¤ªå¤šæ„ä¹‰ï¼Œå› ä¸ºè¿™äº›æ ‡æ³¨çš„ç›®çš„æ˜¯å‘Šè¯‰ Rust å¤šä¸ªå¼•ç”¨çš„æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°ä¹‹é—´æ˜¯å¦‚ä½•ç›¸äº’å…³è”çš„

**å‡½æ•°ç­¾åä¸­çš„ç”Ÿå‘½å‘¨æœŸæ³¨è§£**

```Rust
fn longest<'a>(x: &'a str, y: &'a str) -> &'a str {
    if x.len() > y.len() { x } else { y }
}
```

æ„Ÿè§‰è¿™éƒ¨åˆ†æ²¡çœ‹å¤ªæ˜å¤©ï¼Œä½†æ˜¯åŸºæœ¬ä¸ŠçŸ¥é“æ€ä¹ˆç”¨äº†

ä¸ºä»€ä¹ˆæ²¡çœ‹æ˜ç™½ï¼Ÿ

æ²¡ææ‡‚è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Œä¼¼ä¹åªèƒ½ç»™ç¼–è¯‘å™¨æä¾›ä¿¡æ¯

å¥½åƒè¯¥æŠ¥é”™çš„åœ°æ–¹è¿˜ä¼šæŠ¥é”™

**ç»“æ„ä½“å®šä¹‰ä¸­çš„ç”Ÿå‘½å‘¨æœŸæ³¨è§£**

```Rust
struct ImportantExcerpt<'a> {
    part: &'a str,
}

fn main() {
    let novel = String::from("Call me Ishmael. Some years ago...");
    let first_sentence = novel.split('.').next().unwrap();
    let i = ImportantExcerpt {
        part: first_sentence,
    };
}
```

æˆ‘ä»¬åœ¨ç»“æ„ä½“åç§°åé¢çš„å°–æ‹¬å·ä¸­å£°æ˜æ³›å‹ç”Ÿå‘½å‘¨æœŸå‚æ•°çš„åç§°ï¼Œä»¥ä¾¿åœ¨ç»“æ„ä½“å®šä¹‰çš„ä¸»ä½“ä¸­ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‚æ•°ã€‚è¿™ä¸ªæ³¨è§£æ„å‘³ç€ `ImportantExcerpt` çš„å®ä¾‹ä¸èƒ½æ¯”å®ƒåœ¨å…¶ `part` å­—æ®µä¸­æŒæœ‰çš„å¼•ç”¨å­˜æ´»å¾—æ›´ä¹…

**ç”Ÿå‘½å‘¨æœŸæ¨æ–­**

```Rust
fn first_word(s: &str) -> &str {
    let bytes = s.as_bytes();

    for (i, &item) in bytes.iter().enumerate() {
        if item == b' ' {
            return &s[0..i];
        }
    }

    &s[..]
}
```

åœ¨ Rust çš„æ—©æœŸç‰ˆæœ¬ï¼ˆ1.0 ä¹‹å‰ï¼‰ï¼Œè¿™æ®µä»£ç æ˜¯æ— æ³•ç¼–è¯‘çš„ï¼Œå› ä¸ºæ¯ä¸ªå¼•ç”¨éƒ½éœ€è¦æ˜¾å¼çš„ç”Ÿå‘½å‘¨æœŸ

åœ¨ç¼–å†™äº†å¤§é‡ Rust ä»£ç åï¼ŒRust å›¢é˜Ÿå‘ç° Rust ç¨‹åºå‘˜åœ¨ç‰¹å®šæƒ…å†µä¸‹ä¼šåå¤è¾“å…¥ç›¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ³¨è§£ã€‚è¿™äº›æƒ…å†µæ˜¯å¯é¢„æµ‹çš„ï¼Œå¹¶éµå¾ªå‡ ç§ç¡®å®šæ€§çš„æ¨¡å¼ã€‚å¼€å‘äººå‘˜å°†è¿™äº›æ¨¡å¼ç¼–ç¨‹åˆ°ç¼–è¯‘å™¨çš„ä»£ç ä¸­ï¼Œä»¥ä¾¿å€Ÿç”¨æ£€æŸ¥å™¨å¯ä»¥åœ¨è¿™äº›æƒ…å†µä¸‹æ¨æ–­ç”Ÿå‘½å‘¨æœŸï¼Œè€Œæ— éœ€æ˜¾å¼æ³¨è§£ã€‚

å½“ç»“æ„ä½“æœ¬èº«å¸¦æœ‰ç”Ÿå‘½å‘¨æœŸå‚æ•°æ—¶ï¼Œå¦‚ä½•ä¸ºå®ƒå®ç°æ–¹æ³•

```Rust
struct ImportantExcerpt<'a> {
    part: &'a str,
}

impl<'a> ImportantExcerpt<'a> {
    fn level(&self) -> i32 {
        3
    }
}
```

ç‰¹æ®Šç”Ÿå‘½å‘¨æœŸ `'static`

è¡¨ç¤ºå—å½±å“çš„å¼•ç”¨å¯ä»¥æŒç»­æ•´ä¸ªç¨‹åºçš„è¿è¡Œæ—¶é—´

* * *

å·å­æ”¹ä¸å®Œäº†ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­
<!-- DAILY_CHECKIN_2026-01-14_END -->

# 2026-01-13
<!-- DAILY_CHECKIN_2026-01-13_START -->












## w1d2

ä»Šå¤©å…ˆä¿åº•æŠŠæ˜¨å¤©æ²¡å¹²å®Œçš„äº‹æƒ…å¹²å®Œå§

-   **å…¥é—¨æŠ€æœ¯&æ·±åº¦æŠ€æœ¯ä»»åŠ¡**
    
    -   021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 3 ç« 
        
    -   [**Day 2: Becoming a Power User - Wallets, Mnemonics, Keypairs**](https://www.youtube.com/watch?v=_GjPeRLCREA&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=2)
        
    -   [Uniswap V2 å­¦ä¹ å®˜æ–¹æ–‡æ¡£](https://docs.uniswap.org/contracts/v2/overview?utm_source=chatgpt.com)
        
-   **RuståŸºç¡€**
    
    -   ç¬¬å…«ç«  common collection
        
    -   ç¬¬ä¹ç«  error handling
        
-   **æ‚é¡¹**
    
    -   æŠŠå°ç™»è¯•å·erå›¾é‚£é¢˜æ”¹å®Œå§
        

å…ˆè¿™æ ·å§ï¼Œè‡³å°‘ä»Šå¤©è¦æŠŠè¿™äº›äº‹ç»™å¹²å®Œ

* * *

## **RuståŸºç¡€**

### **String**

**strå’Œ Stringçš„åŒºåˆ«**

-   str æ˜¯å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œæ˜¯ä¸€ä¸²é•¿åº¦å¯å˜çš„å­—èŠ‚åºåˆ—ï¼Œæ˜¯è¦è®¿é—®çš„ä¸€å—æ•°æ®æœ¬èº«
    
-   &str èƒ–æŒ‡é’ˆï¼Œèµ·å§‹ä½ç½®+é•¿åº¦
    
-   String æ˜¯ å›´ç»• Vec<u8> å°è£…çš„ç»“æ„ä½“ï¼Œå°è£…äº†ä¸€äº›åˆ—
    

**æ„é€ **

```Rust
println!("Hello, world!");

let mut s = String::new();
let data = "initial contents";
let s = data.to_string();
// The method also works on a literal directly:
//å®ç°äº†display traitçš„ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨to_stringæ–¹æ³•
let s = "initial contents".to_string();
let s = String::from("initial contents");
```

**è¿æ¥å­—ç¬¦ä¸²**

```Rust
let mut s = String::from("foo");
s.push_str("bar");//ä½¿ç”¨push_stræ–¹æ³•è¿½åŠ å­—ç¬¦ä¸²

let mut s1 = String::from("foo");
let s2 = "bar";
s1.push_str(s2);//ä½¿ç”¨push_stræ–¹æ³•è¿½åŠ å­—ç¬¦ä¸²ï¼Œæœ¬è´¨ä¸Šs2æ²¡æœ‰è¢«ç§»åŠ¨ï¼Œå¯¹s2çš„æ•°æ®è¿›è¡Œäº†ä¸€æ¬¡â€œå­—èŠ‚æ‹·è´â€
println!("s2 is {s2}");//s2ä»ç„¶æœ‰æ•ˆ

let mut s = String::from("lo");
s.push('l');//ä½¿ç”¨pushæ–¹æ³•è¿½åŠ å•ä¸ªå­—ç¬¦

let s1 = String::from("Hello, ");
let s2 = String::from("world!");
let s3 = s1 + &s2; // s1è¢«ç§»åŠ¨ï¼Œæ— æ³•å†ä½¿ç”¨
//s2ä»ç„¶æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ˜¯é€šè¿‡å¼•ç”¨ä¼ é€’çš„

let s1 = String::from("tic");
let s2 = String::from("tac");
let s3 = String::from("toe");
let s = format!("{s1}-{s2}-{s3}");
//ä½¿ç”¨format!å®æ¥è¿æ¥å­—ç¬¦ä¸²ï¼Œformat!å®ä¸ä¼šè·å–ä»»ä½•å‚æ•°çš„æ‰€æœ‰æƒ
```

**è¿­ä»£å­—ç¬¦ä¸²çš„æ–¹æ³•**

å­—ç¬¦ä¸²ä¸æ”¯æŒç´¢å¼•è®¿é—®ï¼Œå› ä¸ºå­—ç¬¦ä¸²æ˜¯UTF-8ç¼–ç çš„ï¼ŒæŸäº›å­—ç¬¦å¯èƒ½å ç”¨å¤šä¸ªå­—èŠ‚

ä¸æ”¯æŒä¸‹é¢çš„æ“ä½œ

```Rust
let s1 = String::from("hi");
let h = s1[0];
```

è·å–ç¬¬Nä¸ªå­—èŠ‚

```Rust
let s1 = String::from("hello");
// 1. å…ˆè½¬æˆå­—èŠ‚åˆ‡ç‰‡ï¼Œå†ç´¢å¼•
let h_byte = s1.as_bytes()[0]; 
println!("{}", h_byte); // è¾“å‡º 104 (è¿™æ˜¯ 'h' çš„ ASCII ç )
println!("{}", h_byte as char); // å¼ºè½¬å› charï¼Œè¾“å‡º 'h'
```

è·å–ç¬¬Nä¸ªUnicodeå­—ç¬¦

```Rust
let s1 = String::from("ä½ å¥½World");
// 1. è·å–è¿­ä»£å™¨ -> å–ç¬¬0ä¸ª -> è§£åŒ…(å› ä¸ºå¯èƒ½è¶Šç•Œè¿”å›None)
let c = s1.chars().nth(0).unwrap(); 
println!("{}", c); // è¾“å‡º "ä½ "
```

ç›´æ¥è¿­ä»£

```Rust
for c in "Ğ—Ğ´".chars() {
    println!("{c}");
}
```

é€å­—èŠ‚

```Rust
for b in "Ğ—Ğ´".bytes() {
    println!("{b}");
}
```

### Hash Map

> ç”¨å¤ªä¹…dictè¯´å“ˆå¸Œè¡¨æƒ³ä¸èµ·æ¥æ˜¯ä»€ä¹ˆï¼Œå…¶å®å°±æ˜¯å­—å…¸

åŸºç¡€æ“ä½œ

```Rust
    use std::collections::HashMap;//å¯¼å…¥HashMapç±»å‹

    let mut scores = HashMap::new();//åˆ›å»ºä¸€ä¸ªç©ºçš„HashMap

    scores.insert(String::from("Blue"), 10);
    scores.insert(String::from("Yellow"), 50);//å‘HashMapä¸­æ’å…¥é”®å€¼å¯¹

    let team_name = String::from("Blue");
    let score = scores.get(&team_name).copied().unwrap_or(0);//é€šè¿‡é”®è·å–å€¼

    for (key, value) in &scores {//éå†HashMapä¸­çš„é”®å€¼å¯¹
        println!("{key}: {value}");
    }
```

åœ¨é€šè¿‡è°ƒç”¨ `insert` å°†å˜é‡ç§»å…¥å“ˆå¸Œæ˜ å°„åï¼Œæˆ‘ä»¬æ— æ³•å†ä½¿ç”¨è¿™äº›å˜é‡ï¼Œæ‰€æœ‰æƒè½¬ç§»åˆ°å“ˆå¸Œè¡¨

è§£å†³æ–¹æ³•å¯ä»¥ç›´æ¥ä½¿ç”¨cloneæˆ–è€…å¼•ç”¨ï¼Œä½†æ˜¯ç”¨å¼•ç”¨çš„è¯éœ€è¦è€ƒè™‘ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜

æ›´æ–°

ç›´æ¥ insert ï¼Œç›¸åŒçš„é”®ä¼šè¢«è¦†ç›–

ä½¿ç”¨ entry å¯ä»¥åªåœ¨æ²¡æœ‰é”®å€¼çš„æ—¶å€™æ’å…¥

```Rust
    scores.entry(String::from("Yellow")).or_insert(50);
    scores.entry(String::from("Blue")).or_insert(50);
```

`Entry` ä¸Šçš„ `or_insert` æ–¹æ³•è¢«å®šä¹‰ä¸ºï¼šå¦‚æœè¯¥é”®å­˜åœ¨ï¼Œåˆ™è¿”å›å¯¹åº” `Entry` é”®çš„å€¼çš„å¯å˜å¼•ç”¨ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å°†å‚æ•°ä½œä¸ºæ­¤é”®çš„æ–°å€¼æ’å…¥ï¼Œå¹¶è¿”å›å¯¹æ–°å€¼çš„å¯å˜å¼•ç”¨ã€‚

åŸºäºæ—§å€¼æ›´æ–°

```Rust
    let text = "hello world wonderful world";

    let mut map = HashMap::new();

    for word in text.split_whitespace() {
        let count = map.entry(word).or_insert(0);
        *count += 1;
    }
```

hashmapçš„æ‰€æœ‰æƒæœ€å°ç²’åº¦æ˜¯hashmapï¼Œä¸æ˜¯é”®å€¼å¯¹

```Rust
fn reverse(v: &mut Vec<String>) {
    let n = v.len();
    for i in 0 .. n / 2 {
        let p1 = &mut v[i] as *mut String;
        let p2 = &mut v[n - i - 1] as *mut String;
        unsafe { std::ptr::swap_nonoverlapping(p1, p2, 1); }
    }
}
```

### é”™è¯¯å¤„ç†

Rust è®¤ä¸ºé”™è¯¯ä¸å¯é¿å…ï¼Œå› æ­¤å¼ºåˆ¶è¦æ±‚å¼€å‘è€…åœ¨**ç¼–è¯‘é˜¶æ®µ**å°±æ˜¾å¼å¤„ç†æ½œåœ¨çš„é”™è¯¯ï¼Œä»¥ç¡®ä¿ç¨‹åºçš„å¥å£®

Rust å°†é”™è¯¯æ˜ç¡®åˆ†ä¸ºä¸¤ç±»ï¼š

-   **å¯æ¢å¤é”™è¯¯**ï¼ˆRecoverableï¼‰ï¼šä¾‹å¦‚æ–‡ä»¶æœªæ‰¾åˆ°ï¼Œé€šå¸¸åªéœ€æŠ¥å‘Šé—®é¢˜æˆ–é‡è¯•ã€‚
    
-   **ä¸å¯æ¢å¤é”™è¯¯**ï¼ˆUnrecoverableï¼‰ï¼šé€šå¸¸æ˜¯ Bugï¼ˆå¦‚æ•°ç»„è¶Šç•Œï¼‰ï¼Œéœ€è¦ç«‹å³ç»ˆæ­¢ç¨‹åºã€‚
    

ä¸å¤§å¤šæ•°è¯­è¨€ä½¿ç”¨â€œå¼‚å¸¸â€ï¼ˆExceptionsï¼‰ä¸åŒï¼ŒRust ä½¿ç”¨ç‰¹å®šçš„å·¥å…·æ¥å¤„ç†è¿™ä¸¤ç±»é”™è¯¯ï¼š

-   ç”¨ `panic!` **å®** å¤„ç†ä¸å¯æ¢å¤é”™è¯¯ã€‚
    
-   ç”¨ `Result<T, E>` **ç±»å‹** å¤„ç†å¯æ¢å¤é”™è¯¯ã€‚
    

ç”¨ Result çš„ä¸€ä¸ªä¾‹å­

```Rust
use std::fs::File;

fn main() {
    let greeting_file_result = File::open("hello.txt");

    let greeting_file = match greeting_file_result {
        Ok(file) => file,
        Err(error) => panic!("Problem opening the file: {error:?}"),
    };
}
```

è¿˜èƒ½è¿›ä¸€æ­¥ç»†åˆ†å¤„ç†

```Rust
use std::fs::File;
use std::io::ErrorKind;

fn main() {
    let greeting_file_result = File::open("hello.txt");

    let greeting_file = match greeting_file_result {
        Ok(file) => file,
        Err(error) => match error.kind() {
            ErrorKind::NotFound => match File::create("hello.txt") {
                Ok(fc) => fc,
                Err(e) => panic!("Problem creating the file: {e:?}"),
            },
            _ => {
                panic!("Problem opening the file: {error:?}");
            }
        },
    };
}
```

æ›´è¿›ä¸€æ­¥ï¼Œä¸ä½¿ç”¨ match çš„å†™æ³•

```Rust
    let greeting_file = File::open("hello.txt").unwrap_or_else(|error| {
        if error.kind() == ErrorKind::NotFound {
            File::create("hello.txt").unwrap_or_else(|error| {
                panic!("Problem creating the file: {error:?}");
            })
        } else {
            panic!("Problem opening the file: {error:?}");
        }
    });
```

ä½¿ç”¨ unwrap çš„ä¾‹å­

```Rust
let greeting_file = File::open("hello.txt").unwrap();
```

`unwrap()` çš„æœ¬è´¨å°±æ˜¯ï¼šâ€œå¦‚æœä¸æˆåŠŸï¼Œå°± panicâ€ã€‚

å°±ç›¸å½“äºä¸å¤„ç†å¤±è´¥çš„ result

**Expect**

```Rust
let greeting_file = File::open("hello.txt").expect("hello.txt should be included in this project");
```

expectç›¸å½“äºåŠ äº†ä¸ªé”™è¯¯ä¿¡æ¯çš„ unwrap ï¼Œå¤±è´¥æ—¶ panic å¹¶ä¸”è¾“å‡ºé”™è¯¯ä¿¡æ¯

Propagating Errors é”™è¯¯ä¼ é€’

å½“ä¸€ä¸ªå‡½æ•°çš„å®ç°è°ƒç”¨äº†ä¸€ä¸ªå¯èƒ½å¤±è´¥çš„å‡½æ•°æ—¶ï¼Œä¸å…¶åœ¨å‡½æ•°å†…éƒ¨å¤„ç†é”™è¯¯ï¼Œä¸å¦‚å°†é”™è¯¯è¿”å›ç»™è°ƒç”¨ä»£ç ï¼Œç”±å®ƒæ¥å†³å®šå¦‚ä½•å¤„ç†

```Rust
fn read_username_from_file() -> Result<String, io::Error> {
    let username_file_result = File::open("hello.txt");
    let mut username_file = match username_file_result {
        Ok(file) => file,
        Err(e) => return Err(e),
    };

    let mut username = String::new();
    match username_file.read_to_string(&mut username) {
        Ok(_) => Ok(username),
        Err(e) => Err(e),
    }
}
```

ä¸‹é¢æ˜¯æ›´ç®€å•çš„å†™æ³•

```Rust
fn read_username_from_file() -> Result<String, io::Error> {
    let mut username_file = File::open("hello.txt")?;
    let mut username = String::new();
    username_file.read_to_string(&mut username)?;
    Ok(username)
}
```

å†ç¼©

```Rust
fn read_username_from_file() -> Result<String, io::Error> {
    let mut username = String::new();
    File::open("hello.txt")?.read_to_string(&mut username)?;
    Ok(username)
}
```

å†ç¼©

```Rust
fn read_username_from_file() -> Result<String, io::Error> {
    fs::read_to_string("hello.txt")
}
```

æˆ‘ä»¬åªèƒ½åœ¨è¿”å› Resultã€Option æˆ–å®ç° FromResidual çš„å…¶ä»–ç±»å‹çš„å‡½æ•°ä¸­ä½¿ç”¨ ? æ“ä½œç¬¦ã€‚

`?` æ˜¯ Rust ä¸­ç”¨äºâ€œé”™è¯¯ä¼ æ’­â€ (Error Propagation) çš„è¯­æ³•ç³–ï¼šå¦‚æœè¿™ä¸ªæ“ä½œæˆåŠŸäº†ï¼Œå°±æŠŠé‡Œé¢çš„å€¼ç»™æˆ‘ï¼›å¦‚æœå‡ºé”™äº†ï¼Œç«‹é©¬æŠŠé”™è¯¯æ‰”ç»™è°ƒç”¨æˆ‘çš„å‡½æ•°ï¼Œæˆ‘ä¹Ÿä¸å¹²äº†

`File::open("hello.txt")?.read_to_string(&mut username)?`

åœ¨ open è¿”å› err çš„æ—¶å€™å°±ä¸ä¼šæ‰§è¡Œ read\_to\_string äº†

```Rust
fn read_username_from_file() -> Option<String> {
  let mut username_file = File::open("hello.txt")?;
  let mut username = String::new();
  username_file.read_to_string(&mut username)?;
  Some(username)
}
```

è¿™ä¸ªä»£ç ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸º ï¼Ÿ ä¼šç›´æ¥è¿”å›ä¸€ä¸ª result ç±»å‹ï¼Œä½†æ˜¯å‡½æ•°çš„è¾“å‡ºæ˜¯ option

ä¿®æ”¹çš„è¯å¯ä»¥å°† option æ¢ä¸º result

To panic! or Not to panic!

-   åœ¨åŸå‹è®¾è®¡é˜¶æ®µï¼Œå½“ä½ è¿˜æ²¡å‡†å¤‡å¥½å¤„ç†é”™è¯¯æ—¶ï¼Œ\` `unwrap` å’Œ `expect` æ–¹æ³•éå¸¸æœ‰ç”¨
    
-   å½“æ‚¨æœ‰ä¸€äº›é€»è¾‘ç¡®ä¿ `Result` å€¼ä¸º `Ok` æ—¶ï¼Œè°ƒç”¨ `expect` ä¹Ÿæ˜¯åˆé€‚çš„ï¼Œä½†è¿™äº›é€»è¾‘ç¼–è¯‘å™¨æ— æ³•ç†è§£ã€‚
    

* * *

## 021å­¦ä¹ ä»¥å¤ªåŠ ç¬¬ä¸‰ç« 

### åˆ›å»ºåˆçº¦çš„ä¸¤ä¸ªæ“ä½œç 

Â Â **CREATE**

Â Â åˆçº¦åœ°å€ = keccak256( RLP(\[s ender, nonce\]) ) çš„å 20 å­—èŠ‚

Â Â **CREATE2**

Â Â åˆçº¦åœ°å€ = keccak256(0xff + deployer + salt + keccak256(init\_code)) çš„å 20 å­—èŠ‚

CREATE2 çš„æœ€å¤§ä»·å€¼æ˜¯å¯é¢„æµ‹åœ°å€ï¼Œç›¸åŒè¾“å…¥åœ¨ä»»æ„ EVM é“¾ä¸Šä¼šç”Ÿæˆç›¸åŒåœ° å€

### ä¸€ã€EOA çš„å®šä¹‰ä¸æ§åˆ¶æ–¹å¼

ä»¥å¤ªåŠæœ‰ä¸¤ç§è´¦æˆ·

-   EOAï¼šç”±å…¬ç§é’¥å¯¹æ§åˆ¶ï¼Œå¯ä»¥å‘èµ·äº¤æ˜“ï¼Œç®€å•æ¥è¯´å°±æ˜¯å‘èµ·äº¤æ˜“æˆ–è€…è°ƒç”¨åˆçº¦çš„äºº
    
    -   æœ‰ç§é’¥ï¼Œä¸å¯å­˜ä»£ç ï¼Œåªèƒ½ç­¾åï¼Œåªèƒ½äº¤æ˜“
        
-   åˆçº¦è´¦æˆ·ï¼šç”¨äºå­˜å‚¨è¢«è°ƒç”¨çš„åˆçº¦ï¼Œå¯ä»¥é€šè¿‡è®¿é—®åˆçº¦è´¦æˆ·çš„åœ°å€æ‰§è¡Œå­˜å‚¨çš„åˆçº¦
    
    -   æ²¡æœ‰ç§é’¥ï¼Œæœ‰åœ°å€ï¼Œæœ‰ä½™é¢ï¼Œå¯æŒæœ‰NFT
        

ä¸€ä¸ªè´¦æˆ·æœ‰ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µ | EOA (ä½ çš„é’±åŒ…) | åˆçº¦è´¦æˆ· (å¦‚ Uniswap) |
| nonce | äº¤æ˜“æ¬¡æ•° | åˆ›å»ºè¿‡çš„å­åˆçº¦æ•° |
| balance | ä½ çš„ ETH ä½™é¢ | åˆçº¦æŒæœ‰çš„ ETH ä½™é¢ |
| storageRoot | ç©º | æŒ‡å‘åˆçº¦çš„æ•°æ®å­˜å‚¨æ ‘ |
| codeHash | ç©ºå“ˆå¸Œ | æŒ‡å‘åˆçº¦çš„ä»£ç é€»è¾‘ |

**åŠ©è®°è¯**

-   BIP-39 å®šä¹‰äº†åŠ©è®°è¯ï¼Œä¾¿äºè®°å¿†
    
-   ç”±åŠ©è®°è¯å¯ä»¥ç”Ÿæˆ**æ— æ•°ä¸ª**ç§é’¥ã€‚
    
-   ä¸€ç»„åŠ©è®°è¯èƒ½ç”Ÿæˆæ— æ•°ä¸ªç§é’¥ï¼Œé‚£å…·ä½“ç”Ÿæˆå“ªä¸€ä¸ªå‘¢ï¼Ÿè¿™å°±è¦é **æ´¾ç”Ÿè·¯å¾„**æ¥æŒ‡å®šã€‚
    

$$\\text{åŠ©è®°è¯} \\xrightarrow{\\text{åŠ ç›(å¯é€‰)}} \\mathbf{\\text{ç§å­ (Seed)}} \\xrightarrow{\\text{æ´¾ç”Ÿè·¯å¾„}} \\mathbf{\\text{ç‰¹å®šçš„ç§é’¥}}$$

### äºŒã€åˆçº¦è´¦æˆ·çš„æ¦‚å¿µä¸åˆ›å»ºæµç¨‹

**åˆçº¦è´¦æˆ·**

-   æœ‰åœ°å€ï¼Œæœ‰ä½™é¢
    
-   æœ‰ codeï¼ˆåˆçº¦é€»è¾‘ï¼‰å’Œ storageï¼ˆçŠ¶æ€å­˜å‚¨ï¼‰ï¼Œå¯ä»¥è¯»å†™çŠ¶æ€ã€è½¬è´¦ã€ è°ƒç”¨å…¶ä»–åˆçº¦
    
-   ä¸èƒ½ä¸»åŠ¨å‘èµ·äº¤æ˜“
    

**åˆ›å»ºåˆçº¦è´¦æˆ·æµç¨‹**

1.  ç¼–å†™æ™ºèƒ½åˆçº¦
    
2.  ç¼–è¯‘æˆ EVM å­—èŠ‚ç 
    
    1.  åˆå§‹åŒ–éƒ¨ç½²åœ¨é“¾ä¸Š
        
    2.  è¢«è°ƒç”¨
        

**å¦‚ä½•åœ¨ Solidity åˆçº¦ä»£ç ä¸­ï¼Œå»è°ƒç”¨å¦ä¸€ä¸ªåˆçº¦æˆ–ç»™åˆ«äººè½¬è´¦**

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä½çº§æ¥å£** `.call`

```Solidity
(bool success, bytes memory data) = _targetAddress.call{value: _amount, gas: _gas}(_payload);
```

Â Â å‚æ•°

Â Â Â Â **ç›®æ ‡åœ°å€ (**`_targetAddress`**)**:

-   ä½ è¦è½¬è´¦ç»™è°ï¼Ÿæˆ–è€…ä½ è¦è°ƒç”¨å“ªä¸ªåˆçº¦ï¼Ÿ
    
-   ç±»å‹ï¼š`address` æˆ– `address payable`ã€‚
    

Â Â Â Â **é™„å¸¦é‡‘é¢ (**`value`**)** _(å¯é€‰)_:

-   ä½ è¦è½¬å¤šå°‘ ETH è¿‡å»ï¼Ÿ
    
-   å‚æ•°å†™æ³•ï¼š`{value: 1 ether}` æˆ– `{value: msg.value}`ã€‚
    
-   æ³¨æ„ï¼šå•ä½æ˜¯ Weiã€‚å¦‚æœä¸å†™ï¼Œé»˜è®¤ä¸º 0ã€‚
    

Â Â Â Â **Gas é™åˆ¶ (**`gas`**)** _(å¯é€‰)_:

-   ä½ é™åˆ¶è¿™æ­¥æ“ä½œæœ€å¤šæ¶ˆè€—å¤šå°‘ Gasï¼Ÿ
    
-   å‚æ•°å†™æ³•ï¼š`{gas: 5000}`ã€‚
    
-   å»ºè®®ï¼šé€šå¸¸**ä¸å»ºè®®**æ‰‹åŠ¨æŒ‡å®šï¼Œé™¤éæœ‰ç‰¹æ®Šå®‰å…¨éœ€æ±‚ã€‚é»˜è®¤ä¼šæŠŠå‰©ä½™æ‰€æœ‰ Gas ä¼ è¿‡å»ã€‚
    

Â Â Â Â **è°ƒç”¨æ•°æ® (**`_payload`**)**:

-   **å¦‚æœæ˜¯çº¯è½¬è´¦**ï¼šä¼ ç©ºå­—ç¬¦ `""`ã€‚
    
-   **å¦‚æœè¦è°ƒç”¨å‡½æ•°**ï¼šéœ€è¦ä½¿ç”¨ `abi.encodeWithSignature(...)` å¯¹å‡½æ•°åå’Œå‚æ•°è¿›è¡Œç¼–ç ã€‚
    

```Solidity
function sendMoney(address payable _to) public payable {
    // æ¥å£ï¼šcall
    // å‚æ•°ï¼švalue (é‡‘é¢), data (ç©º)
    (bool success, ) = _to.call{value: msg.value}("");
    
    require(success, "Transfer failed."); // å¿…é¡»æ£€æŸ¥è¿”å›å€¼
}
```

**æ–¹æ³•äºŒï¼šä½¿ç”¨æ¥å£ Interface**

```Solidity
interface IERC20 {
    function transfer(address recipient, uint256 amount) external returns (bool);
}
```

```Solidity
function callByInterface(address _tokenAddress, address _to, uint256 _amount) public {
    // 1. å®ä¾‹åŒ–æ¥å£
    IERC20 token = IERC20(_tokenAddress);
    
    // 2. ç›´æ¥è°ƒç”¨ (ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†å‚æ•°ç¼–ç å’Œ call æ¥å£)
    bool success = token.transfer(_to, _amount);
    
    require(success, "Token transfer failed");
}
```

ç®—äº†ï¼Œå…ˆä¸çœ‹ solidity äº†ï¼Œç­‰ä¹‹åç³»ç»Ÿçš„å­¦ä¸€ä¸‹å§

åˆçº¦è´¦æˆ·çš„èƒ½åŠ›ä¸é™åˆ¶

**æ ¸å¿ƒèƒ½åŠ›**

-   **ç®¡é’±ç®¡æ•°æ®**ï¼šæ—¢èƒ½æŒæœ‰ ETH/Tokenï¼Œåˆèƒ½å­˜å‚¨å¤æ‚æ•°æ®ï¼ˆStorageï¼‰ã€‚
    
-   **æ‰§è¡Œé€»è¾‘**ï¼šæ˜¯ DEXã€NFTã€DAO çš„è½½ä½“ï¼Œä»£ç å®šä¹‰è§„åˆ™ã€‚
    
-   **é“¾ä¸Šäº¤äº’**ï¼šåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è½¬è´¦ã€è°ƒç”¨åˆ«çš„åˆçº¦ï¼Œç”šè‡³ç”Ÿå‡ºæ–°åˆçº¦ï¼ˆCREATE/CREATE2ï¼‰ã€‚
    

**æ ¸å¿ƒé™åˆ¶**

-   **è¢«åŠ¨æ‰§è¡Œ**ï¼š**æ— ç§é’¥**ã€‚å®ƒä¸èƒ½ä¸»åŠ¨â€œåŠ¨â€èµ·æ¥ï¼Œå¿…é¡»ç”±å¤–éƒ¨ï¼ˆEOAï¼‰æˆ–å…¶ä»–åˆçº¦â€œæ¨ä¸€æŠŠâ€æ‰èƒ½è¿è¡Œã€‚
    
-   **ä»£ç å›ºåŒ–**ï¼šéƒ¨ç½²å**ä»£ç ä¸å¯æ”¹**ï¼ˆCode Immutableï¼‰ï¼Œåªèƒ½ä¿®æ”¹å†…éƒ¨æ•°æ®ï¼ˆé™¤éç”¨ä»£ç†æ¨¡å¼ï¼‰ã€‚
    
-   **éƒ¨ç½²æ˜‚è´µ**ï¼šå› ä¸ºå ç”¨äº†é“¾ä¸Šçš„æ°¸ä¹…å­˜å‚¨ç©ºé—´ï¼Œåˆ›å»ºåˆçº¦çš„ Gas è´¹å¾ˆé«˜ã€‚
    

### ä¸‰ã€ä»¥å¤ªåŠåœ°å€â€œ0xâ€å¼€å¤´çš„ç”±æ¥

ä»¥å¤ªåŠåœ°å€æœ¬è´¨æ˜¯ä¸€ä¸² 20 å­—èŠ‚ï¼ˆ160 bitï¼‰çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå†™æˆå­—ç¬¦ä¸²æ—¶é€š å¸¸ç”¨åå…­è¿›åˆ¶å±•ç¤ºï¼Œäºæ˜¯æŒ‰ç…§ç¼–ç¨‹ç•Œä¼ ç»ŸåŠ äº†ä¸ªå‰ç¼€ 0x

### å››ã€EOA ä¸åˆçº¦è´¦æˆ·çš„æ§åˆ¶æ–¹å¼å¯¹æ¯”

| ç»´åº¦ | EOA (å¤–éƒ¨è´¦æˆ·) | CA (åˆçº¦è´¦æˆ·) |
| æ§åˆ¶æ ¸å¿ƒ | ç§é’¥ (Private Key) | ä»£ç  (Code Logic) |
| èƒ½å¦ä¸»åŠ¨ | èƒ½ (ä¸€åˆ‡äº¤æ˜“çš„èµ·ç‚¹) | ä¸èƒ½ (åªèƒ½è¢«åŠ¨å“åº”è°ƒç”¨) |
| åˆ›å»ºæˆæœ¬ | å…è´¹ (æœ¬åœ°ç”Ÿæˆå¯†é’¥å¯¹) | æ˜‚è´µ (éœ€æ”¯ä»˜ Gas å­˜è´®ä»£ç ä¸Šé“¾) |
| æƒé™ç®¡ç† | åªæœ‰â€œæ‹¥æœ‰/æœªæ‹¥æœ‰â€ç§é’¥ä¸¤ç§çŠ¶æ€ | é«˜åº¦çµæ´» (å¤šç­¾ã€è§’è‰²ã€ç™½åå•) |
| ä¸»è¦é£é™© | ç§é’¥ä¸¢å¤±/æ³„éœ² | ä»£ç æ¼æ´ (Bug) / é€»è¾‘é”™è¯¯ |
| å¯å˜æ€§ | è¡Œä¸ºå›ºå®š (åªèƒ½ç­¾åå‘äº¤æ˜“) | ä»£ç ä¸å¯å˜ (ä½†å¯ç»ç”±ä»£ç†å‡çº§) |
| è¯†åˆ«æ–¹å¼ | eth_getCode è¿”å›ç©º | eth_getCode è¿”å›å­—èŠ‚ç  |

ç”±äº EOA å­˜åœ¨â€œå•ç‚¹æ•…éšœâ€ï¼ˆç§é’¥ä¸¢äº†å°±å…¨å®Œäº†ï¼‰ï¼Œè€Œåˆçº¦è´¦æˆ·å¯ä»¥ç¼–ç¨‹ï¼Œå› æ­¤è¡ç”Ÿå‡ºäº†ä¸¤ç§å¢å¼ºå®‰å…¨æ€§çš„æœºåˆ¶ï¼š

**A. å¤šç­¾é’±åŒ… (Multisig Wallet)**

-   **æœ¬è´¨**ï¼šç”¨æ™ºèƒ½åˆçº¦æ¨¡æ‹Ÿâ€œå¤šæŠŠé’¥åŒ™å¼€ä¸€æŠŠé”â€ã€‚
    
-   **æœºåˆ¶**ï¼š**M-of-N**ã€‚ä¾‹å¦‚ 3 äººç®¡ç†ï¼Œè‡³å°‘ 2 äººç­¾ååŒæ„æ‰èƒ½è½¬è´¦ã€‚
    
-   **ä¼˜åŠ¿**ï¼š
    
    -   **é˜²å•ç‚¹æ•…éšœ**ï¼šä¸¢äº†ä¸€ä¸ªç§é’¥ï¼Œé’±è¿˜åœ¨ã€‚
        
    -   **é€‚åˆå›¢é˜Ÿ**ï¼šDAO å›½åº“ã€å…¬å¸èµ„äº§ç®¡ç† (å¦‚ Gnosis Safe)ã€‚
        

**B. æ—¶é—´é” (Timelock)**

-   **æœ¬è´¨**ï¼šç»™æ“ä½œåŠ ä¸€ä¸ªâ€œå†·é™æœŸâ€æˆ–â€œå…¬ç¤ºæœŸâ€ã€‚
    
-   **æœºåˆ¶**ï¼š**ææ¡ˆ -> ç­‰å¾…å»¶è¿Ÿ(Delay) -> æ‰§è¡Œ**ã€‚
    
    -   ä¾‹å¦‚ï¼šç®¡ç†å‘˜æƒ³ä¿®æ”¹åˆçº¦å‚æ•°ï¼Œæäº¤åå¿…é¡»ç­‰ 48 å°æ—¶æ‰èƒ½ç”Ÿæ•ˆã€‚
        
-   **ä¼˜åŠ¿**ï¼š
    
    -   **é˜²è·‘è·¯/æ¶æ„ç¯¡æ”¹**ï¼šç¤¾åŒºå‘ç°ç®¡ç†å‘˜ä½œæ¶ï¼Œå¯ä»¥åœ¨ 48 å°æ—¶å†…å–å¸é€€å‡ºã€‚
        
    -   **å¢åŠ é€æ˜åº¦**ï¼šæ‰€æœ‰é‡å¤§å˜æ›´ä¸ä»…å…¬å¼€ï¼Œè€Œä¸”æœ‰é¢„å‘Šã€‚
        
-   **ä»£ä»·**ï¼šç‰ºç‰²äº†ç´§æ€¥å“åº”é€Ÿåº¦ï¼ˆä¿® Bug ä¹Ÿè¦ç­‰ï¼‰ã€‚
    

### å…­ã€åˆçº¦è´¦æˆ·çš„ä½™é¢ä¸çŠ¶æ€å­˜å‚¨

æ— è®ºå“ªç§è´¦æˆ·ï¼Œåœ¨çŠ¶æ€æ ‘ä¸­éƒ½å­˜å‚¨ä¸ºï¼š

$$Account = (nonce, balance, storageRoot, codeHash)$$

### ä¸ƒã€EOA ä¸åˆçº¦è´¦æˆ·çš„äº’ç›¸è°ƒç”¨æœºåˆ¶

### ä¹ã€ERC20 / ERC721 ä»£å¸ä¸åˆçº¦è´¦æˆ·çš„å…³ç³»

è½¬ä»£å¸â€ æœ¬è´¨ä¸Šæ˜¯ â€œè°ƒç”¨ä»£å¸åˆçº¦çš„ä¸€æ®µä»£ç  + æ”¹ä¸€è¡Œå­˜å‚¨

> æ„Ÿè§‰è¿™ä¸€ç« ç»“æ„å¥½åƒæœ‰ç‚¹ä¹±ï¼Œå¾ˆå¤šé‡å¤çš„ä¸œè¥¿åœ¨æ¥å›è®²

* * *

## Uniswap V2 å­¦ä¹ å®˜æ–¹æ–‡æ¡£

åˆ†ä¸ºæ ¸å¿ƒå±‚å’Œå¤–å›´å±‚

-   æ ¸å¿ƒå±‚ [https://github.com/Uniswap/v2-core](https://github.com/Uniswap/v2-core)
    
-   å¤–å›´å±‚ [https://github.com/Uniswap/v2-periphery](https://github.com/Uniswap/v2-periphery)
    

### Ecosystem Participants

**ä¸»è¦å‚ä¸è§’è‰²**

-   **æµåŠ¨æ€§æä¾›è€… (LPs)**ï¼šæä¾›èµ„é‡‘ï¼ˆå–æ–¹/åšå¸‚å•†ï¼‰ã€‚
    
-   **äº¤æ˜“è€… (Traders)**ï¼šè¿›è¡Œå…‘æ¢ï¼ˆä¹°æ–¹ï¼‰ã€‚
    
-   **å¼€å‘è€… (Developers)**ï¼šæ„å»ºå·¥å…·å’Œå…¥å£ï¼ˆåŸºç¡€è®¾æ–½ï¼‰ã€‚
    

**æ ¸å¿ƒæœºåˆ¶**ï¼š

-   LPs æŠŠä»£å¸å­˜å…¥æ± å­ -> äº¤æ˜“è€…æ¥å…‘æ¢å¹¶æ”¯ä»˜ **0.30%** çš„æ‰‹ç»­è´¹ -> è¿™äº›æ‰‹ç»­è´¹å…¨éƒ¨åˆ†ç»™ LPs ä½œä¸ºå¥–åŠ±ã€‚
    
-   è¿™ä¸ªæœºåˆ¶æ¿€åŠ±äº†æ›´å¤šäººæä¾›æµåŠ¨æ€§ï¼ŒæµåŠ¨æ€§è¶Šå¥½ï¼Œäº¤æ˜“æ»‘ç‚¹è¶Šä½ï¼Œå¸å¼•æ›´å¤šäº¤æ˜“è€…ï¼Œäº§ç”Ÿæ›´å¤šæ‰‹ç»­è´¹ï¼Œä»è€Œå¸å¼•æ›´å¤š LPsâ€¦â€¦
    

**A. æµåŠ¨æ€§æä¾›è€… (Liquidity Providers / LPs)**

1.  **è¢«åŠ¨å‹ LPs (Passive LPs)**ï¼šæ™®é€šæŒå¸è€…ï¼Œå­˜æ± å­é‡Œåƒåˆ©æ¯
    
2.  **ä¸“ä¸šå‹ LPs (Professional LPs)**ï¼šä¸“ä¸šçš„åšå¸‚å•†å›¢é˜Ÿã€‚ä»–ä»¬ä½¿ç”¨å¤æ‚çš„ç­–ç•¥å’Œè‡ªå®šä¹‰å·¥å…·æ¥ç›‘æ§å„ä¸ª DeFi åè®®çš„æ”¶ç›Šç‡ï¼Œå¹¶åœ¨ä¸åŒé¡¹ç›®é—´æ¬ç –ã€‚
    
3.  **ä»£å¸é¡¹ç›®æ–¹ (Token Projects)**ï¼šæ–°å‘å¸çš„é¡¹ç›®æ–¹ï¼ˆæ¯”å¦‚å‘äº†ä¸€ä¸ªæ–° Token "ABC"ï¼‰ï¼Œä¸ºäº†è®©å¤§å®¶èƒ½ä¹°å– "ABC"ï¼Œé¡¹ç›®æ–¹è‡ªå·±ä¼šå……å½“ LPï¼Œåˆ›å»ºä¸€ä¸ª "ABC/ETH" çš„äº¤æ˜“å¯¹ã€‚è¿™æ ·ä¸€æ¥ï¼ŒUniswap å°±æˆäº†è¿™ä¸ªä»£å¸çš„â€œäº¤æ˜“æ‰€â€ã€‚
    
4.  **DeFi å…ˆé©± (DeFi Pioneers)**ï¼šæ¢ç´¢é«˜é˜¶ç©æ³•çš„äººã€‚æ¯”å¦‚æŠŠ LP Tokenï¼ˆä½ åœ¨ Uniswap å­˜é’±åæ‹¿åˆ°çš„å‡­è¯ï¼‰å†æ‹¿å»æŠµæŠ¼å€Ÿè´·ï¼Œå®ç°â€œæµåŠ¨æ€§æŒ–çŸ¿â€æˆ–â€œä¹é«˜ç»„åˆâ€ã€‚
    

**B. äº¤æ˜“è€… (Traders)**

1.  **æŠ•æœºè€… (Speculators)**ï¼šæ™®é€šçš„ä¹°å–äº¤æ˜“è€…ã€‚æ¯”å¦‚çœ‹æ¶¨ ETHï¼Œå°±ç”¨ USDT æ¢ ETHã€‚
    
2.  **å¥—åˆ©æœºå™¨äºº (Arbitrage Bots)**ï¼šä½ä¹°é«˜å–çš„è‡ªåŠ¨è„šæœ¬ï¼Œè™½ç„¶å®ƒä»¬æ˜¯ä¸ºäº†èµšé’±ï¼Œä½†åœ¨å®¢è§‚ä¸Šå¸®åŠ© Uniswap çš„ä»·æ ¼**å›å½’å¸‚åœºå…¬å…ä»·æ ¼**ï¼Œä¿æŒäº†å¸‚åœºçš„æœ‰æ•ˆæ€§ã€‚
    
3.  **DAPP ç”¨æˆ·**ï¼šä¸ºäº†ä½¿ç”¨æŸä¸ªåº”ç”¨è€Œä¹°å¸ã€‚
    
4.  **æ™ºèƒ½åˆçº¦ (Smart Contracts)**ï¼šæ¯”å¦‚â€œDEX èšåˆå™¨â€ï¼ˆå¦‚ 1inchï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªåˆçº¦ï¼Œå®ƒä¼šè‡ªåŠ¨è®¡ç®—å‘ç° Uniswap çš„ä»·æ ¼æœ€å¥½ï¼Œäºæ˜¯å®ƒçš„åˆçº¦ä»£ç ä¼šè‡ªåŠ¨è°ƒç”¨ Uniswap çš„åˆçº¦è¿›è¡Œäº¤æ˜“ã€‚
    

**C. å¼€å‘è€… (Developers)**

å°±æ˜¯å„ç§å„æ ·å›´ç»• Uniswap åšå¼€å‘çš„äºº

### Smart contracts

æ¶æ„é‡‡ç”¨ æ ¸å¿ƒ + å¤–å›´ çš„æ¶‰åŠ

Coreï¼ˆæ ¸å¿ƒå±‚ï¼‰**â€œæç®€ä¸»ä¹‰ (Brutalist)â€**ã€‚

-   ä»£ç æå°‘ï¼Œé€»è¾‘æç®€ã€‚å®¹æ˜“å®¡è®¡ï¼Œå®‰å…¨æ€§è¶Šé«˜ã€‚è¿™æ˜¯å› ä¸º Core æŒç®¡ç€æ‰€æœ‰èµ„é‡‘ï¼Œç»å¯¹ä¸èƒ½å‡ºé”™ã€‚
    
-   å› ä¸ºå¤ªç®€å•ï¼Œæ‰€ä»¥å¯¹äººç±»å¾ˆä¸å‹å¥½ï¼ˆUser-unfriendlyï¼‰ï¼Œç›´æ¥è°ƒç”¨å®ƒä¼šå¾ˆéº»çƒ¦ä¸”å®¹æ˜“å‡ºé”™ã€‚
    
-   **åŒ…å«ç»„ä»¶**ï¼š
    
    -   **Singleton Factory (å•ä¾‹å·¥å‚)**ï¼šåªæœ‰ä¸€ä¸ªã€‚å®ƒçš„ä»»åŠ¡åªæœ‰ä¸¤ä¸ªï¼š
        
        -   åˆ›å»ºå¹¶ç´¢å¼•æ‰€æœ‰çš„ Pair åˆçº¦ï¼ˆæ¯ä¸ªäº¤æ˜“å¯¹ä¸€ä¸ªï¼‰
            
            1.  æ¯ä¸€ä¸ª Pair åˆçº¦å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„â€œèµ„é‡‘æ± â€
                
        -   æ§åˆ¶æ˜¯å¦å¼€å¯åè®®æ”¶è´¹ã€‚
            
    -   **Pairs (äº¤æ˜“å¯¹)**ï¼š
        
        -   **åšå¸‚å•† (AMM)**ï¼šå®é™…æ‰§è¡Œ `x * y = k` é€»è¾‘çš„åœ°æ–¹ã€‚
            
        -   **å­˜é’±ç½**ï¼šè®°å½•æ± å­é‡Œæœ‰å¤šå°‘å¸ã€‚
            
        -   **ä»·æ ¼é¢„è¨€æœº**ï¼šæä¾›å†å²ä»·æ ¼æ•°æ®ã€‚
            

Peripheryï¼ˆå¤–å›´å±‚ï¼‰â€œç”¨æˆ·å‹å¥½â€

-   å®ƒæ˜¯ Core çš„â€œç®¡å®¶â€æˆ–â€œç•Œé¢â€ã€‚å®ƒæ²¡æœ‰ç‰¹æƒï¼ˆPermissionlessï¼‰ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿å¤§å®¶ä½¿ç”¨è€Œå†™çš„ä¸€å¥—å·¥å…·åˆçº¦ã€‚
    
-   Periphery å“ªæ€•æœ‰ Bugï¼Œé€šå¸¸ä¹Ÿä¸ä¼šå¯¼è‡´ Core é‡Œçš„èµ„é‡‘ç›´æ¥è¢«ç›—ï¼ˆå› ä¸ºèµ„é‡‘åœ¨ Pair é‡Œï¼Œä¸åœ¨ Router é‡Œï¼‰ï¼Œæœ€å¤šæ˜¯ç”¨æˆ·åœ¨ä½¿ç”¨ Router è¿‡ç¨‹ä¸­å‡ºé—®é¢˜ã€‚
    
-   **åŒ…å«ç»„ä»¶**ï¼š
    
    -   **Library (åº“)**ï¼šæä¾›å„ç§è®¡ç®—å…¬å¼ï¼ˆæ¯”å¦‚ç®—ä»·æ ¼ã€ç®—åœ°å€ï¼‰ï¼Œä¸»è¦æ˜¯ä¸ºäº†å¤ç”¨ä»£ç ã€‚
        
    -   **Router (è·¯ç”±)**ï¼šè¿™æ˜¯å‰ç«¯ï¼ˆWeb UIï¼‰å’Œé’±åŒ…ç›´æ¥æ‰“äº¤é“çš„å¯¹è±¡ã€‚
        
        -   **è·¯å¾„è·¯ç”±**ï¼šæ”¯æŒ `ETH -> A -> B -> C` è¿™ç§å¤šè·³äº¤æ˜“ã€‚
            
        -   **ETH æ”¯æŒ**ï¼šæŠŠ ETH å¤„ç†æˆ WETHï¼ˆåé¢ä¼šç»†è®²ï¼‰ã€‚
            
        -   **è¾…åŠ©åŠŸèƒ½**ï¼šæ¯”å¦‚æ”¯æŒç”¨ç­¾åæ¥ç§»é™¤æµåŠ¨æ€§ï¼ˆMeta-transactionsï¼‰ã€‚
            

ä¸‰å¤§å…³é”®è®¾è®¡å†³ç­– (Design Decisions)

Sending Tokens (ä»£å¸å‘é€æœºåˆ¶)

-   **ä¼ ç»Ÿåšæ³•**ï¼šé€šå¸¸æˆ‘ä»¬è°ƒç”¨åˆçº¦æ˜¯ `approve` -> `transferFrom`ã€‚å³ï¼šæˆ‘æˆæƒç»™ä½ ï¼Œä½ æŠŠé’±ä»æˆ‘è¿™æ‹‰èµ°ã€‚
    
-   **Uniswap V2 çš„åšæ³•**ï¼š**â€œå…ˆè½¬é’±ï¼Œå†è°ƒç”¨â€**ã€‚
    
    -   **æµç¨‹**ï¼š
        
        -   ç”¨æˆ·å…ˆæŠŠä»£å¸è½¬è´¦ï¼ˆTransferï¼‰ç»™ Pair åˆçº¦ã€‚
            
        -   ç”¨æˆ·è°ƒç”¨ Pair çš„ `swap` æˆ– `mint` å‡½æ•°ã€‚
            
        -   Pair æ£€æŸ¥ï¼š`å½“å‰ä½™é¢ - è®°å½•çš„ä½™é¢ = ç”¨æˆ·æ‰“è¿›æ¥çš„é’±`ã€‚
            
    -   **ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿ** æ–‡æ¡£æåˆ°è¿™éƒ¨åˆ†åŸå› åœ¨ç™½çš®ä¹¦é‡Œï¼Œç®€å•è¯´æ˜¯ä¸ºäº†**è§£è€¦**å’Œ**å®‰å…¨æ€§**ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒäº† **Flash Swapï¼ˆé—ªç”µè´·ï¼‰**ï¼ˆè¿™æ˜¯å”¯ä¸€ä¾‹å¤–ï¼Œå¯ä»¥å…ˆå€Ÿé’±å†è¿˜ï¼‰ã€‚
        

WETH (åŒ…è£… ETH)

-   **V1 vs V2**ï¼š
    
    -   V1 çš„æ± å­å¿…é¡»æ˜¯ ETH â†” ERC20ã€‚
        
    -   V2 çš„æ± å­æ˜¯ ERC20 â†” ERC20ã€‚
        
-   **é—®é¢˜**ï¼šETH æ˜¯åŸç”Ÿè´§å¸ï¼Œä¸ç¬¦åˆ ERC-20 æ ‡å‡†ï¼ˆå®ƒæ²¡æœ‰ `approve`, `transferFrom` æ¥å£ï¼‰ã€‚
    
-   **è§£å†³**ï¼šV2 Core å®Œå…¨ä¸æ”¯æŒ ETHã€‚
    
    -   å¦‚æœæƒ³åˆ›å»º ETH äº¤æ˜“å¯¹ï¼Œå¿…é¡»å…ˆæŠŠ ETH åŒ…è£…æˆ **WETH (Wrapped ETH)**ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ ERC-20 ä»£å¸ã€‚
        
    -   è¿™æ · Core çš„ä»£ç å°±ä¸ç”¨å†™ä¸¤å¥—é€»è¾‘ï¼ˆä¸€å¥—å¤„ç† ETHï¼Œä¸€å¥—å¤„ç† ERC20ï¼‰ï¼Œä»£ç æ›´å¹²å‡€ã€‚
        
    -   **ç”¨æˆ·æ„ŸçŸ¥**ï¼šç”¨æˆ·åœ¨å‰ç«¯ä¾ç„¶æ˜¯ç”¨ ETHï¼Œæ˜¯å› ä¸º **Router (Periphery)** å¸®ç”¨æˆ·åšäº†â€œETH è½¬ WETHâ€çš„åŠ¨ä½œã€‚
        

Minimum Liquidity (æœ€å°æµåŠ¨æ€§é”€æ¯)

-   **æœºåˆ¶**ï¼šå½“ç¬¬ä¸€ä¸ªäººç»™ä¸€ä¸ªæ–°æ± å­æ·»åŠ æµåŠ¨æ€§æ—¶ï¼Œä¼šæœ‰ **1000 wei** (æå¾®å°çš„é‡‘é¢) çš„ LP Token è¢«æ°¸ä¹…**é”€æ¯ï¼ˆBurnï¼‰**ã€‚
    
-   **ç›®çš„**ï¼š**é˜²æ•°å­¦æ”»å‡»**ã€‚
    
    -   å¦‚æœä¸é”€æ¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“æ§åˆå§‹æµåŠ¨æ€§ï¼Œæ„é€ å‡ºæå…¶æç«¯çš„ä»·æ ¼æˆ–æ•°é‡ï¼ˆæ¯”å¦‚æŠŠ totalSupply å¼„å¾—éå¸¸å°ï¼‰ï¼Œä»è€Œåˆ©ç”¨èˆå…¥è¯¯å·®ï¼ˆRounding Errorsï¼‰çªƒå–åç»­ç”¨æˆ·çš„èµ„é‡‘ã€‚
        
    
    > åœ¨ Solidityï¼ˆä»¥å¤ªåŠç¼–ç¨‹è¯­è¨€ï¼‰ä¸­ï¼Œ**é™¤æ³•æ˜¯å‘ä¸‹å–æ•´çš„**ã€‚
    > 
    > -   `3 / 2 = 1.5` -> åœ¨ Solidity ä¸­ç»“æœæ˜¯ **1**ã€‚
    >     
    > -   `1 / 2 = 0.5` -> åœ¨ Solidity ä¸­ç»“æœæ˜¯ **0**ã€‚
    >     
    > 
    > å¦‚æœç®—å‡ºæ¥çš„ç»“æœä¸åˆ° 1ï¼Œå°±ä¼šå˜æˆ 0ã€‚å¦‚æœä½ å­˜äº†é’±ï¼Œä½†ç³»ç»Ÿè®¡ç®—ä½ åº”è¯¥å¾—åˆ° `0.99` ä¸ªå‡­è¯ï¼Œç³»ç»Ÿå°±ä¼šç»™ä½  **0** ä¸ªå‡­è¯ã€‚ä½ çš„é’±è¿›å»äº†ï¼Œå‡­è¯æ²¡æ‹¿åˆ°ï¼Œé’±å°±å½’æ± å­é‡Œå…¶ä»–äººäº†ã€‚
    > 
    > æ”»å‡»è€…åˆ©ç”¨ `TotalSupply = 1`ï¼Œé€šè¿‡æèµ æ“æ§åˆ†æ¯ï¼Œè®©åç»­ç”¨æˆ·çš„ `(å­˜æ¬¾ * 1) / å‚¨å¤‡é‡` è®¡ç®—ç»“æœå°äº 1ï¼Œåˆ©ç”¨ Solidity çš„èˆå…¥ä¸º 0 ç‰¹æ€§ï¼Œè®©ç”¨æˆ·â€œå­˜äº†é’±å´æ‹¿ä¸åˆ°å‡­è¯â€ã€‚
    > 
    > å¼ºè¡ŒæŠŠ `TotalSupply` æ‹‰å¤§ 1000 å€ã€‚æ”»å‡»è€…æƒ³æ“æ§æ¯”ä¾‹ï¼Œæˆæœ¬ä¹Ÿéšä¹‹æ‰©å¤§ 1000 å€ç”šè‡³æ›´å¤šï¼Œå¯¼è‡´æ”»å‡»åœ¨ç»æµä¸Šä¸åˆ’ç®—ã€‚
    
    -   é”€æ¯è¿™ 1000 wei ç›¸å½“äºæé«˜äº†æ”»å‡»é—¨æ§›ï¼ˆæˆæœ¬ï¼‰ï¼Œè®©è¿™ç§æ•°å­¦æ”»å‡»å˜å¾—æå…¶æ˜‚è´µä¸”ä¸å¯è¡Œã€‚
        
    -   å¯¹äºæ­£å¸¸ç”¨æˆ·ï¼Œè¿™ 1000 wei çš„ä»·å€¼å‡ ä¹ä¸ºé›¶ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚
        

### Glossary

-   **utomated market maker(è‡ªåŠ¨åšå¸‚å•†)**ï¼šè‡ªåŠ¨åšå¸‚å•†æ˜¯ä»¥å¤ªåŠä¸Šçš„ä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼Œå®ƒæŒæœ‰é“¾ä¸ŠæµåŠ¨æ€§å‚¨å¤‡ã€‚ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªåŠ¨åšå¸‚å•†å…¬å¼è®¾å®šçš„ä»·æ ¼ï¼Œä¸è¿™äº›å‚¨å¤‡è¿›è¡Œäº¤æ˜“ã€‚
    
-   **Constant product formula(æ’å®šä¹˜ç§¯å…¬å¼)**ï¼šUniswap ä½¿ç”¨çš„è‡ªåŠ¨åšå¸‚ç®—æ³•ã€‚å‚è§ x\*y=kã€‚
    
-   **ERC20(ERC20)**ï¼šERC20 ä»£å¸æ˜¯ä»¥å¤ªåŠä¸Šçš„åŒè´¨åŒ–ä»£å¸ã€‚Uniswap æ”¯æŒæ‰€æœ‰æ ‡å‡†çš„ ERC20 å®ç°ã€‚
    
-   **Factory(å·¥å‚åˆçº¦)**ï¼šä¸€ä¸ªæ™ºèƒ½åˆçº¦ï¼Œç”¨äºä¸ºä»»æ„ ERC20/ERC20 äº¤æ˜“å¯¹éƒ¨ç½²ä¸€ä¸ªå”¯ä¸€çš„æ™ºèƒ½åˆçº¦ã€‚
    
-   **Pair(äº¤æ˜“å¯¹åˆçº¦)**ï¼šç”± Uniswap V2 å·¥å‚åˆçº¦éƒ¨ç½²çš„æ™ºèƒ½åˆçº¦ï¼Œç”¨äºå®ç°ä¸¤ç§ ERC20 ä»£å¸ä¹‹é—´çš„äº¤æ˜“ã€‚
    
-   **Pool(èµ„é‡‘æ± )**ï¼šäº¤æ˜“å¯¹å†…çš„æµåŠ¨æ€§æ˜¯æ±‡é›†äº†æ‰€æœ‰æµåŠ¨æ€§æä¾›è€…èµ„é‡‘çš„é›†åˆã€‚
    
-   **Liquidity provider / LP(æµåŠ¨æ€§æä¾›è€… / LP)**ï¼šæµåŠ¨æ€§æä¾›è€…æ˜¯æŒ‡å°†ç­‰å€¼çš„ä¸¤ç§ ERC20 ä»£å¸å­˜å…¥äº¤æ˜“å¯¹æµåŠ¨æ€§æ± ä¸­çš„äººã€‚æµåŠ¨æ€§æä¾›è€…æ‰¿æ‹…ä»·æ ¼é£é™©ï¼Œå¹¶è·å¾—è´¹ç”¨ä½œä¸ºè¡¥å¿ã€‚
    
-   **Mid price(ä¸­é—´ä»·)**ï¼šåœ¨ç‰¹å®šæ—¶åˆ»ç”¨æˆ·ä¹°å…¥å’Œå–å‡ºä»£å¸ä»·æ ¼çš„ä¸­é—´å€¼ã€‚åœ¨ Uniswap ä¸­ï¼Œè¿™æ˜¯ä¸¤ç§ ERC20 ä»£å¸å‚¨å¤‡é‡çš„æ¯”ç‡ã€‚
    
-   **Price impact(ä»·æ ¼å½±å“)**ï¼šä¸­é—´ä»·ä¸ä¸€ç¬”äº¤æ˜“å®é™…æˆäº¤ä»·æ ¼ä¹‹é—´çš„å·®é¢ï¼ˆé€šå¸¸ç”±äº¤æ˜“è§„æ¨¡å¼•èµ·ï¼‰ã€‚
    
-   **Slippage(æ»‘ç‚¹)**ï¼šäº¤æ˜“å¯¹çš„ä»·æ ¼åœ¨äº¤æ˜“â€œæäº¤æ—¶â€ä¸â€œå®é™…æ‰§è¡Œæ—¶â€ä¹‹é—´çš„å˜åŠ¨é‡ï¼ˆé€šå¸¸ç”±å¸‚åœºæ³¢åŠ¨æˆ–æŠ¢è·‘å¼•èµ·ï¼‰ã€‚
    
-   **Core(æ ¸å¿ƒåˆçº¦)**ï¼šUniswap èµ–ä»¥ç”Ÿå­˜çš„åŸºç¡€æ™ºèƒ½åˆçº¦ã€‚å‡çº§æ ¸å¿ƒåˆçº¦çš„æ–°ç‰ˆæœ¬éœ€è¦è¿›è¡ŒæµåŠ¨æ€§è¿ç§»ã€‚
    
-   **Periphery(å¤–å›´åˆçº¦)**ï¼šæœ‰ç”¨ä½†é Uniswap å­˜åœ¨æ‰€å¿…éœ€çš„å¤–éƒ¨æ™ºèƒ½åˆçº¦ã€‚éƒ¨ç½²æ–°çš„å¤–å›´åˆçº¦æ— éœ€è¿ç§»æµåŠ¨æ€§ã€‚
    
-   **Flash swap(é—ªç”µå…‘æ¢)**ï¼šä¸€ç§å…è®¸åœ¨æ”¯ä»˜ä»£å¸è´¹ç”¨ä¹‹å‰å°±å¯ä»¥å…ˆä½¿ç”¨æ‰€è´­ä¹°ä»£å¸çš„äº¤æ˜“æ¨¡å¼ã€‚
    
-   **x _y = k(x_ y = k)**ï¼šæ’å®šä¹˜ç§¯å…¬å¼ã€‚
    
-   **Invariant(ä¸å˜é‡/æ’å®šå€¼)**ï¼šæ’å®šä¹˜ç§¯å…¬å¼ä¸­çš„ "k" å€¼ã€‚
    

### Swaps

å½“æå–ï¼ˆè´­ä¹°ï¼‰ä»»ä¸€ä»£å¸æ—¶ï¼Œå¿…é¡»å­˜å…¥ï¼ˆå–å‡ºï¼‰ä¸€å®šæ¯”ä¾‹çš„å¦ä¸€ç§ä»£å¸ï¼Œä»¥ç»´æŒå¸¸æ•°ä¸å˜ã€‚

åœ¨æœ€åŸºç¡€çš„å±‚é¢ä¸Šï¼ŒUniswap V2 ä¸­çš„æ‰€æœ‰å…‘æ¢éƒ½å‘ç”Ÿåœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°è¢«æ°å½“åœ°å‘½åä¸º `swap`ï¼š

```Solidity
function swap(uint amount0Out, uint amount1Out, address to, bytes calldata data);
```

**Uniswap V2 æ¨¡å¼ (Transfer + Swap)**

1.  **ç”¨æˆ·**ï¼šç›´æ¥æŠŠ 100 USDT **æ¨ï¼ˆPush / Transferï¼‰** åˆ° Pair åˆçº¦åœ°å€ã€‚
    
2.  **ç”¨æˆ·**ï¼šè°ƒç”¨ Pair åˆçº¦çš„ `swap` å‡½æ•°ã€‚
    
3.  **Pair**ï¼šçœ‹ä¸€çœ¼è‡ªå·±å…œé‡Œç°åœ¨çš„é’±ï¼Œå†æŸ¥ä¸€ä¸‹è´¦æœ¬ä¸ŠåŸæ¥çš„é’±ï¼Œç®—å‡ºå·®é¢ï¼š
    
4.  `å½“å‰ä½™é¢ (Balance)` - `è´¦æœ¬å‚¨å¤‡ (Reserve)` = `ç”¨æˆ·åˆšæ‰æ‰“è¿›æ¥çš„é’± (Input)`ã€‚
    
5.  **Pair**ï¼šæ ¹æ®è¿™ä¸ªå·®é¢ï¼Œç®—å‡ºè¯¥ç»™ä½ å¤šå°‘ç›®æ ‡ä»£å¸ï¼Œç„¶åå‘ç»™ä½ ã€‚
    

å¦‚æœåœ¨éåŸå­æ“ä½œä¸­ï¼Œå…ˆè½¬å¸ç»™äº¤æ˜“å¯¹å†è°ƒç”¨ swap æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå‘é€çš„ä»£å¸å®¹æ˜“è¢«å¥—åˆ©è€…æˆªè·

### Pools èµ„é‡‘æ± 

-   **å†·å¯åŠ¨**ï¼šæ± å­åˆšåˆ›å»ºæ—¶æ˜¯ç©ºçš„ï¼ˆä½™é¢ä¸º 0ï¼‰ã€‚
    
-   **å®šä»·æƒ**ï¼š**ç¬¬ä¸€ä¸ª**å­˜å…¥æµåŠ¨æ€§çš„äººï¼ˆInitial LPï¼‰ï¼Œä»–å­˜å…¥çš„ Token A å’Œ Token B çš„**æ¯”ä¾‹**ï¼Œç›´æ¥å†³å®šäº†æ± å­çš„**åˆå§‹ä»·æ ¼**ã€‚
    
-   **é£é™©çº¦æŸ**ï¼šå¦‚æœç¬¬ä¸€ä¸ªäººä¹±å®šä»·ï¼ˆæ¯”å¦‚å­˜å…¥æ¯”ä¾‹åç¦»å¸‚åœºä»·ï¼‰ï¼Œå¥—åˆ©è€…ï¼ˆArbitrageursï¼‰ä¼šç«‹åˆ»è¿›åœºæ¬ç –ï¼ŒæŠŠä¾¿å®œçš„å¸ä¹°èµ°ï¼Œå¯¼è‡´ç¬¬ä¸€ä¸ªäººäºæŸã€‚
    
    -   _ç»“è®ºï¼šå¸‚åœºåšå¼ˆè¿«ä½¿ LP å¿…é¡»æŒ‰å…¬å…ä»·æ ¼å­˜å¸ã€‚_
        

**Pool tokens (èµ„é‡‘æ± ä»£å¸ / æµåŠ¨æ€§ä»£å¸)**

Â Â **LP Token = å­˜æ¬¾æ”¶æ®**ï¼šå½“ä½ å­˜å…¥æµåŠ¨æ€§ï¼Œä½ ä¼šæ”¶åˆ° `Liquidity Tokens`ã€‚

-   **é¦–æ¬¡é“¸é€ å…¬å¼**ï¼šæ•°é‡ = sqrt(x \* y)ã€‚
    
-   **åç»­å­˜å…¥**ï¼šå¿…é¡»æŒ‰å½“å‰æ± å­çš„ä»·æ ¼æ¯”ä¾‹å­˜å…¥ã€‚
    

Â Â **æ”¶ç›Šæ¥æº**ï¼šæ¯ç¬”äº¤æ˜“æ”¶å–çš„ **0.3% æ‰‹ç»­è´¹**ï¼Œä¼šæŒ‰æ¯”ä¾‹åˆ†ç»™æ‰€æœ‰ LPã€‚

-   æ³¨æ„ï¼šæ‰‹ç»­è´¹ä¸ä¼šç›´æ¥æ‰“åˆ°ä½ é’±åŒ…ï¼Œè€Œæ˜¯åŠ åˆ°æ± å­é‡Œï¼Œè®©ä½ çš„ LP Token å˜å¾—æ›´å€¼é’±ã€‚
    

Â Â **é€€å‡ºæœºåˆ¶**ï¼šæŠŠ LP Token å‘å›ç»™åˆçº¦ï¼ˆ**Burn/é”€æ¯**ï¼‰ï¼Œåˆçº¦æŠŠå¯¹åº”çš„æœ¬é‡‘ + èµšåˆ°çš„æ‰‹ç»­è´¹é€€ç»™ä½ ã€‚

### Flash Swaps

-   **ä»€ä¹ˆæ˜¯ Flash Swapï¼Ÿ** å®ƒå…è®¸ä½ ä» Uniswap çš„æ± å­é‡Œ**é¢„å…ˆæå–**ä»»æ„æ•°é‡çš„ä»£å¸ï¼ˆç”šè‡³æŠŠæ± å­å€Ÿç©ºï¼‰ï¼Œæ‹¿å»å¹²ä»»ä½•ä½ æƒ³å¹²çš„äº‹ï¼ˆæ¯”å¦‚å»åˆ«çš„å¹³å°å–æ‰ï¼‰ã€‚
    
-   **å”¯ä¸€çš„æ¡ä»¶**ï¼š è¿™ä¸€åˆ‡å¿…é¡»åœ¨åŒä¸€ä¸ªäº¤æ˜“ï¼ˆåŒä¸€åŒºå—ï¼‰å†…å®Œæˆã€‚åœ¨äº¤æ˜“ç»“æŸçš„é‚£ä¸€åˆ¹é‚£ï¼Œä½ å¿…é¡»ï¼š
    
    -   **æ–¹æ¡ˆ A**ï¼šç”¨å¦ä¸€ç§ä»£å¸æ”¯ä»˜åˆšæ‰å€Ÿèµ°çš„ä»£å¸ï¼ˆç›¸å½“äºä¹°ï¼‰ã€‚
        
    -   **æ–¹æ¡ˆ B**ï¼šæŠŠå€Ÿèµ°çš„ä»£å¸åŸæœ¬å¥‰è¿˜ï¼Œå¹¶æ”¯ä»˜å°‘é‡æ‰‹ç»­è´¹ï¼ˆç›¸å½“äºå€Ÿï¼‰ã€‚
        
-   **å¦‚æœä¸è¿˜é’±ï¼Ÿ** æ•´ä¸ªäº¤æ˜“ä¼šç›´æ¥ **Revertï¼ˆå›æ»šï¼‰**ï¼Œå°±åƒè¿™ä¸€åˆ‡ä»æœªå‘ç”Ÿè¿‡ä¸€æ ·ã€‚
    

**åœºæ™¯ Aï¼šæ— æœ¬é‡‘å¥—åˆ© (Capital Free Arbitrage)**

-   **ç—›ç‚¹**ï¼šä»¥å‰å‘ç°å·®ä»·ï¼ˆUniswap ä¾¿å®œï¼ŒOasis è´µï¼‰ï¼Œä½ å¾—è‡ªå·±å…ˆæœ‰æœ¬é‡‘ä¹°ä¸‹ä¾¿å®œçš„ï¼Œå†å»å–ã€‚æ²¡é’±å°±åªèƒ½çœ‹ç€æœºä¼šæºœèµ°ã€‚
    
-   **Flash Swap è§£æ³•**ï¼š
    
    -   **å€Ÿ**ï¼šä» Uniswap å€Ÿå‡º 1 ETHï¼ˆæ­¤æ—¶è¿˜æ²¡ä»˜é’±ï¼‰ã€‚
        
    -   **å–**ï¼šå» Oasis æŠŠè¿™ 1 ETH å–æˆ 220 DAIã€‚
        
    -   **è¿˜**ï¼šå›åˆ° Uniswapï¼ŒæŒ‰ç…§å½“æ—¶çš„ä»·æ ¼ï¼ˆæ¯”å¦‚ 200 DAIï¼‰è¿˜å€ºã€‚
        
    -   **èµš**ï¼šå‰©ä¸‹çš„ 20 DAI å°±æ˜¯ä½ çš„åˆ©æ¶¦ï¼Œä½ å®é™…ä¸Šæ˜¯**ç©ºæ‰‹å¥—ç™½ç‹¼**ï¼ˆé™¤äº† Gas è´¹ï¼‰ã€‚
        
-   **æ„ä¹‰**ï¼šå®ç°äº†**å¥—åˆ©çš„æ°‘ä¸»åŒ–**ï¼Œä»»ä½•äººåªè¦æœ‰æŠ€æœ¯ï¼ˆä»£ç ï¼‰ï¼Œä¸éœ€è¦æœ‰èµ„æœ¬ï¼Œå°±èƒ½æŠ¹å¹³å¸‚åœºå·®ä»·ã€‚
    

**åœºæ™¯ Bï¼šç¬æ—¶æ æ† (Instant Leverage)**

-   **ç—›ç‚¹**ï¼šä»¥å‰æƒ³åœ¨ MakerDAO åš 2 å€æ æ†ï¼Œéœ€è¦â€œæŠµæŠ¼ -> å€Ÿè´· -> ä¹°å¸ -> å†æŠµæŠ¼ -> å†å€Ÿè´·...â€å¾ªç¯å¤šæ¬¡ï¼Œæ“ä½œç¹çä¸” Gas è´¹æé«˜ã€‚
    
-   **Flash Swap è§£æ³•**ï¼š
    
    -   **å€Ÿ**ï¼šç›´æ¥ä» Uniswap å€Ÿå‡ºä½ æœ€ç»ˆæƒ³è¦çš„æ€» ETH æ•°é¢ã€‚
        
    -   **å­˜**ï¼šæŠŠè¿™äº› ETH ä¸€æ¬¡æ€§å­˜å…¥ MakerDAOã€‚
        
    -   **é“¸**ï¼šç”Ÿæˆ DAIã€‚
        
    -   **è¿˜**ï¼šç”¨ç”Ÿæˆçš„ DAI å¿è¿˜ Uniswap çš„é—ªç”µè´·ã€‚
        
-   **æ„ä¹‰**ï¼šæŠŠå¤æ‚çš„å¤šæ­¥æ“ä½œå‹ç¼©è¿›ä¸€ä¸ªåŸå­äº¤æ˜“ä¸­ï¼Œçœé’±ã€çœå¿ƒã€‚
    

* * *

æ­‡é€¼äº†ï¼Œä»Šå¤©å°±å…ˆå­¦åˆ°è¿™äº†

-   **å…¥é—¨æŠ€æœ¯&æ·±åº¦æŠ€æœ¯ä»»åŠ¡**
    
    -   021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 3 ç« âœ…
        
    -   [**Day 2: Becoming a Power User - Wallets, Mnemonics, Keypairs**](https://www.youtube.com/watch?v=_GjPeRLCREA&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=2)**â­•**
        
    -   [Uniswap V2 å­¦ä¹ å®˜æ–¹æ–‡æ¡£](https://docs.uniswap.org/contracts/v2/overview?utm_source=chatgpt.com)âœ…
        
-   **RuståŸºç¡€**
    
    -   ç¬¬å…«ç«  common collectionâœ…
        
    -   ç¬¬ä¹ç«  error handling âœ…
        
-   **æ‚é¡¹**
    
    -   æŠŠå°ç™»è¯•å·erå›¾é‚£é¢˜æ”¹å®Œå§â­•
        

è¦å­¦ä¼šè·Ÿè‡ªå·±å’Œè§£

æ˜æ˜ä»Šå¤©å¥½åƒä¸€ç›´éƒ½åœ¨å­¦ï¼Œä½†æ˜¯æ€ä¹ˆæ„Ÿè§‰è¿›åº¦é‚£ä¹ˆæ…¢ï¼Ÿ

å—·ï¼Œå¥½åƒæ˜¯ä¸‹åˆæ‰“ç‰Œå»äº†

å”‰ï¼Œå”‰å”‰

æ˜å¤©å†åŠ æŠŠåŠ²å§

è¯•å·å†ä¸æ”¹è€ç™»ä¼°è®¡è¦å‚¬äº†

æƒ³ä¸€ä¸‹

æ˜å¤©å‘¨ä¸‰ï¼Œåå¤©å‘¨å››

æ˜å¤©è¦æŠŠä¼ä¸šé¡¹ç›®çš„æ–¹æ¡ˆæ•´ç†ä¸€ä¸‹ï¼Œç»„ä¼šç»™è€ç™»çœ‹

ç„¶åè¿˜æœ‰è®ºæ–‡çš„ä»£ç å®éªŒï¼Œæ‹–åˆ°å‘¨äº”å…­æ—¥å¹²å§

æ˜å¤©æ”¹å·å­ï¼Œæ˜å¤©å¿…é¡»è¦æ”¹å·å­äº†

ä»Šå¤©å°±å…ˆè¿™æ ·å§ï¼Œæ˜å¤©å†åŠªåŠ›

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=NjM5MWQwOGExNmRkYzE5ZTAxNzVlZWRmM2ZmYTllM2JfSGJxaHM0U0lRVXlha0NjSUVXbkNwSEkyQllyZEcxdmNfVG9rZW46UkVCTWJDUk91bzNxNzR4MHhENGNXelpwbkpoXzE3NjgzMTgxMDg6MTc2ODMyMTcwOF9WNA)
<!-- DAILY_CHECKIN_2026-01-13_END -->

# 2026-01-12
<!-- DAILY_CHECKIN_2026-01-12_START -->














ï¼ˆå½é‡Œå’•å™œå†™äº†åŠå¤©ä¸å°å¿ƒç‚¹åˆ°ç™½æ¡†å¤–é¢çš„å†…å®¹ä¹‹åå…¨éƒ¨å†…å®¹æ²¡æœ‰äº†ï¼Œåç»­å¹²è„†ç›´æ¥æŠŠé£ä¹¦æ–‡æ¡£ä¸Šçš„å­¦ä¹ è®°å½•å¤åˆ¶ç²˜è´´è¿‡æ¥å§ï¼‰

æ€»ä¹‹ï¼Œå…ˆç»™æ¥ä¸‹æ¥çš„ä¸€æ®µæ—¶é—´è®¾å®šä¸€ä¸ªæ€»ä½“çš„ç›®æ ‡å§ï¼Œå¹³å¸¸ä¹Ÿæœ‰è®°å½•å­¦ä¹ ç¬”è®°çš„ä¹ æƒ¯ï¼Œå¹²è„†ä¸€èµ·è®°å½•å§ï¼Œåæ­£å·®ä¸å¤šä¹Ÿéƒ½ç®—æ˜¯æ²¾ç‚¹è¾¹çš„ä¸œè¥¿

## å››å‘¨ç›®æ ‡

1.  å®Œæˆå…¥é—¨æŠ€æœ¯å­¦ä¹ ä»»åŠ¡
    
2.  å®Œæˆæ·±åº¦æŠ€æœ¯å­¦ä¹ ä»»åŠ¡
    
3.  å®Œæˆè®ºæ–‡å®éªŒï¼ˆéšç¼˜å§ï¼Œå›å®¶å‰åšå®Œå°±è¡Œï¼‰
    
4.  å®ŒæˆruståŸºç¡€è¯­æ³•å­¦ä¹ ï¼ˆäº‰å–ç¬¬ä¸‰å‘¨ä¹‹å‰å®Œæˆï¼‰
    
5.  å°½é‡åšä¸€ä¸ªrethäºŒå¼€çš„é¡¹ç›®ï¼ˆæˆ–è€…è¯´è‡³å°‘å¼€å§‹åšï¼‰
    

## w1d1

### todo

-   **å…¥é—¨æŠ€æœ¯&æ·±åº¦æŠ€æœ¯ä»»åŠ¡**
    
    -   Web3 å®ä¹ æ‰‹å†Œ[ã€Œå…¥é—¨å¯¼è¯»ã€](https://web3intern.xyz/zh/blockchain-basic/)éƒ¨åˆ†
        
    -   Web3 å®ä¹ æ‰‹å†Œ[ã€Œå®‰å…¨ä¸åˆè§„ã€](https://web3intern.xyz/zh/security/)éƒ¨åˆ†
        
    -   021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 1-3 ç« 
        
    -   Ethereum å®˜ç½‘ [Overview](https://ethereum.org/learn/) åŸºç¡€å†…å®¹å­¦ä¹ 
        
    -   [**Day 1: A Developerâ€™s Guide to Building on Ethereum**](https://www.youtube.com/watch?v=zuJ-elbo88E&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=1) - Intro
        
    -   [**Day 2: Becoming a Power User - Wallets, Mnemonics, Keypairs**](https://www.youtube.com/watch?v=_GjPeRLCREA&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=2)
        
    -   å·¥å…·å®‰è£…æŒ‡å—ï¼š[https://web3intern.xyz/zh/remote-work-guide/](https://web3intern.xyz/zh/remote-work-guide/)
        
    
    > æ˜¨å¤©è£…å®Œäº†ï¼Œè¿™ä¸ªä¸ç®¡äº†
    
    -   [Uniswap V2 å­¦ä¹ å®˜æ–¹æ–‡æ¡£](https://docs.uniswap.org/contracts/v2/overview?utm_source=chatgpt.com)
        
-   **RuståŸºç¡€**
    
    -   ç¬¬å…«ç«  common collection
        
    -   ç¬¬ä¹ç«  error handling
        
-   **æ‚é¡¹**
    
    -   æŠŠå°ç™»è¯•å·erå›¾é‚£é¢˜æ”¹å®Œå§
        

* * *

### Web3 å®ä¹ æ‰‹å†Œ[ã€Œå…¥é—¨å¯¼è¯»ã€](https://web3intern.xyz/zh/blockchain-basic/)éƒ¨åˆ†

å¤§éƒ¨åˆ†å¥½åƒæ˜¯ä¹‹å‰å·²ç»äº†è§£åˆ°çš„å†…å®¹

web3.0å¥½åƒæ²¡æ€ä¹ˆå¬è¯´è¿‡ï¼Œå¥½åƒæ˜¯ç»™æ•°æ®é›†æ‰“æ ‡ç­¾ä¸€æ ·

æœ€åçœ‹åˆ°ä½œè€…å¥½åƒè¿˜æ˜¯ç†Ÿäºº

**å°è¯•â€œã€Šæˆ‘çš„ç¬¬ä¸€ä¸ª NFTã€‹ï¼š**[**https://nft.myfirst.io/â€**](https://nft.myfirst.io/â€)

-   æ¯é¥¬äº†åŠå¤©ä¸€ç›´æç¤º401ï¼Œçœ‹åç»­çš„æ•™ç¨‹è¯´éœ€è¦**Gas Feeï¼Œ**ä»¥ä¸ºæ˜¯å› ä¸ºé’±åŒ…é‡Œé¢æ²¡é’±å¯¼è‡´è®¤è¯ä¸äº†ç­‰ç­‰
    

> ä¹‹åçœ‹åˆ°ç¾¤é‡Œæ‰çŸ¥é“ä¸æ˜¯æˆ‘è¿™è¾¹çš„é—®é¢˜

-   ç„¶ååœ¨å¸å®‰ä¹°äº† 0.0003 ä¸ª eth ï¼Œæœ¬æ¥æƒ³æŠŠå¸å®‰çš„åœ°å€ç›´æ¥å¯¼å…¥åˆ° metamask ï¼Œä½†æ˜¯æ‰¾åŠå¤©æ²¡æœ‰æ‰¾åˆ°
    
-   ä¹‹åæƒ³ç€ç›´æ¥æŠŠ 0.0003 è½¬åˆ° metamask çš„é’±åŒ…ï¼Œè¢«å‘ŠçŸ¥â€œä¸è¶³0.003æ— æ³•è½¬è´¦â€
    
-   ç´¢æ€§åˆä¹°äº†ç‚¹ï¼Œç„¶åè½¬è´¦åˆ° metamask é’±åŒ…
    
-   ç½‘ç«™ä¿®å¤åå‘ç°éœ€è¦çš„æ˜¯ SepoliaETH ï¼Œç³–ä¸¸äº†
    
-   ç„¶ååˆæ‰’æ‹‰äº†ä¼šä»»åŠ¡æ–‡æ¡£æ‰¾åˆ°æ°´é¾™å¤´æµäº†ä¼šï¼Œæ‹¿åˆ°æµ‹è¯•å¸æˆåŠŸé“¸é€ äº†
    
-   ç„¶åé¡ºä¾¿åœ¨ç¾¤é‡Œæ‰¾åˆ°åˆ«äººçš„åœ°å€è½¬è´¦å®Œæˆäº†å¦å¤–ä¸€ä¸ªä»»åŠ¡
    

**ä»¥å¤ªåŠç»“æ„**

Layer 1

-   ä»¥å¤ªåŠä¸»ç½‘ï¼šæ ¸å¿ƒåŒºå—é“¾ï¼Œè´Ÿè´£æœ€ç»ˆå®‰å…¨æ€§ä¸å…±è¯†ã€‚
    
-   EVMï¼šä»¥å¤ªåŠè™šæ‹Ÿæœºï¼Œæ‰§è¡Œæ™ºèƒ½åˆçº¦ä»£ç ã€‚
    
-   è´¦æˆ·ç³»ç»Ÿï¼šå¤–éƒ¨è´¦æˆ·ï¼ˆEOAï¼‰ä¸åˆçº¦è´¦æˆ·ï¼ˆCAï¼‰å…±åŒæ„æˆç½‘ç»œåŸºç¡€ã€‚
    

Layer 2

-   Rollupï¼šé€šè¿‡å°†äº¤æ˜“æ‰¹é‡å¤„ç†åæäº¤è‡³ L1ï¼Œé™ä½ Gas è´¹ã€‚
    
    -   Optimistic Rollupï¼šå‡è®¾äº¤æ˜“åˆæ³•ï¼Œä»…åœ¨äº‰è®®æ—¶éªŒè¯ã€‚
        
    -   ZK Rollupï¼šé€šè¿‡é›¶çŸ¥è¯†è¯æ˜éªŒè¯äº¤æ˜“ï¼Œæ— éœ€é“¾ä¸Šäº‰è®®ã€‚
        

> **L1 æ˜¯è´Ÿè´£â€œæä¾›â€å…±è¯†æœºåˆ¶å’Œå®‰å…¨æ€§çš„å±‚ï¼ˆä¸åšæ”¹å˜ï¼‰ã€‚L2 æ˜¯è´Ÿè´£â€œå‰¥ç¦»â€è®¡ç®—å·¥ä½œï¼Œåˆ©ç”¨ L1 çš„å…±è¯†è¿›è¡Œæœ€ç»ˆç¡®è®¤çš„å±‚ã€‚**
> 
> L2 å¹¶ä¸æ˜¯è®© L1 çš„å…±è¯†æœºåˆ¶æœ¬èº«å˜å¿«äº†ï¼ˆL1 è¯¥æ…¢è¿˜æ˜¯æ…¢ï¼‰ï¼Œè€Œæ˜¯**é€šè¿‡å‡å°‘ L1 éœ€è¦å¤„ç†çš„å·¥ä½œé‡**ï¼Œå˜ç›¸å®ç°äº†æ•ˆç‡çš„æå‡ã€‚
> 
> è¿™å—ä¹‹å‰ä¸€ç›´æ²¡å¼„çš„ç‰¹åˆ«ç»†ï¼Œè™½ç„¶çŸ¥é“ L2 æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œä½†æ˜¯ä¸¤ä¸ªå±‚çš„åŒºåˆ«ä¸€ç›´æ¨¡æ¨¡ç³Šç³Š

### 021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 1-3 ç« 

æˆ‘å¤©ï¼Œè¿™ä¸ªé‡å¥½å¤§

ä¸è¿‡å¤§éƒ¨åˆ†å¥½åƒéƒ½æ˜¯å·²ç»äº†è§£çš„å†…å®¹ï¼Œè·³ç€çœ‹å§

Â Â ç¬¬ä¸€ç« ï¼šè®¤è¯†ä»¥å¤ªåŠ

-   æ™ºèƒ½åˆçº¦
    
-   dApp
    
-   Tokens
    
-   PoS
    
-   Gas
    
-   Proto-Dankshardingï¼ˆEIP-4844ï¼‰ä¸ Dencun å‡çº§
    
    -   Â Â Â Â ä¸»è¦å¼•å…¥äº† blob
        
    -   Â Â Â Â ä»€ä¹ˆæ˜¯ blobï¼Ÿä¸´æ—¶æ•°æ®ç»“æ„ï¼Œå­˜å‚¨åœ¨æ‰§è¡Œå±‚
        
    -   Â Â Â Â ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸€äº›ç”¨å®Œäº†ä¹‹åï¼Œå…±è¯†èŠ‚ç‚¹å¯ä»¥ç›´æ¥åˆ é™¤çš„ä¸€äº›æ•°æ®
        
-   åˆ†ç‰‡ä¸ Danksharding
    

Â Â åˆ†ç‰‡æœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œæ—§çš„åˆ†ç‰‡æ–¹æ¡ˆæ˜¯å°†ä»¥å¤ªåŠåˆ†ä¸º64ä¸ªé“¾

Â Â æ–°çš„åˆ†ç‰‡æ–¹æ¡ˆæ˜¯åœ¨ä¸»é“¾ä¸ŠæŒ‚è½½ä¸€ä¸ª**è¶…çº§å·¨å¤§çš„æ•°æ®ï¼Œ**å­˜å‚¨æ›´å¤šçš„blob

Â Â ä½†æ˜¯è¿™æ ·è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå…±è¯†èŠ‚ç‚¹éœ€è¦å­˜æ”¾æ›´å¤šï¼ŒDanksharding å­˜åœ¨æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜

-   å”å—ï¼ˆUncle / Ommer Blockï¼‰
    

**gasè´¹è®¡ç®—**

å®é™…æ”¯ä»˜è´¹ç”¨ â‰ˆ (Base Fee + Priority Fee) Ã— Gas Used

-   Base Feeï¼šåè®®æ ¹æ®åŒºå—æ‹¥å µæƒ…å†µè‡ªåŠ¨è°ƒæ•´ï¼Œå¹¶åœ¨æ‰§è¡Œåè¢«é”€æ¯ï¼›
    
-   Priority Feeï¼šç”¨æˆ·è‡ªæ„¿æ”¯ä»˜çš„å°è´¹ï¼Œç”¨äºæ¿€åŠ±éªŒè¯è€…ä¼˜å…ˆæ‰“åŒ…ï¼›
    
-   é’±åŒ…é‡Œçœ‹åˆ°çš„ maxFeePerGas / maxPriorityFeePerGas æ˜¯ä½ æ„¿æ„æ”¯ ä»˜çš„ä¸Šé™ï¼Œå®é™…æ‰£è´¹ä¸ä¼šè¶…è¿‡è¿™ä¸¤ä¸ªä¸Šé™ç»„åˆå¯¹åº”çš„å€¼ã€‚
    

ç¬¬äºŒç«  ç½‘ç»œç»“æ„ä¸èŠ‚ç‚¹ç±»å‹

**ä»¥å¤ªåŠä¸­èŠ‚ç‚¹é€šä¿¡**

1.  èŠ‚ç‚¹**é€šè¿‡ UDP è¿è¡Œ Kademlia DHT åè®®**æ¥å‘ç°é‚»å±…
    
2.  å»ºç«‹ tcp é“¾æ¥
    
3.  æ–°äº¤æ˜“é€šè¿‡ Gossip åè®®æ‰©æ•£
    

**Kademlia**

-   æ¯ä¸ªåˆ†æ‹¨ä¸­å¿ƒæœ‰ä¸€ä¸ªâ€œç¼–å·â€ï¼ˆèŠ‚ç‚¹ IDï¼‰ï¼›
    
-   æ¯ä¸ªä¸­å¿ƒéƒ½è®°ç€â€œåœ¨ä¸åŒè·ç¦»åŒºé—´å†…ï¼Œç¦»æˆ‘æœ€è¿‘çš„å‡ ä¸ªä¸­å¿ƒâ€ï¼›
    
-   å½“è¦æŠŠå¿«é€’å¯„å¾€ä¸€ä¸ªç›®æ ‡ç¼–å·æ—¶ï¼Œä¼šä¸€æ­¥æ­¥è½¬å‘ç»™â€œç¦»ç›®æ ‡æ›´è¿‘â€çš„ä¸­ å¿ƒï¼Œè¶Šè½¬è¶Šæ¥è¿‘æ”¶ä»¶äººï¼›
    
-   æœ€ç»ˆå¿«é€’å°±è¢«ç²¾å‡†é€åˆ°ç›®çš„åœ°ã€‚
    

> æ„Ÿè§‰è·Ÿè·¯ç”±çš„é‚£ä¸ªç®—æ³•å·®ä¸å¤š

**Gossip**

1.  å½“èŠ‚ç‚¹æ”¶åˆ°ä¸€ç¬”æ–°äº¤æ˜“ï¼ŒéªŒè¯é€šè¿‡åï¼Œéšæœºé€‰æ‹©ä¸€éƒ¨åˆ†é‚»å±…å‘é€äº¤æ˜“å“ˆå¸Œã€‚
    
2.  é‚»å±…å¦‚æœæ²¡æœ‰è¿™ç¬”äº¤æ˜“ï¼Œå°±ä¼šè¯·æ±‚ä¸‹è½½å®Œæ•´äº¤æ˜“æ•°æ®ï¼Œç„¶åå†è½¬å‘ç»™å®ƒçš„é‚»å±…ã€‚
    

**å½’æ¡£èŠ‚ç‚¹**

å°±æ˜¯è¶…çº§å…¨èŠ‚ç‚¹ï¼Œå…¨èŠ‚ç‚¹ä¼šå®šæ—¶æ¸…é™¤å¤ªæ—©çš„åŒºå—ä¿¡æ¯ï¼Œå½’æ¡£èŠ‚ç‚¹ä¸ä¼š

**å¼€å‘è€…æˆ–æœºæ„è¿è¡Œå…¨èŠ‚ç‚¹çš„å¿…è¦æ€§**

-   é¿å…å°†ç”¨æˆ· IP å’Œé’±åŒ…åœ°å€æš´éœ²ç»™ç¬¬ä¸‰æ–¹ RPC æœåŠ¡å•†
    
-   æ‘†è„±å…¬å…±èŠ‚ç‚¹çš„é™æµã€å°é”æˆ–å®•æœºé£é™©ï¼Œç¡®ä¿ä¸šåŠ¡åœ¨ä»»ä½•æ—¶å€™éƒ½èƒ½è‡ªä¸»å¹¿æ’­äº¤æ˜“ã€‚
    
-   æœ¬åœ°ç‹¬ç«‹æ ¡éªŒæ¯ä¸€ç¬”åŒºå—å’Œäº¤æ˜“çš„çœŸå®æ€§
    
-   å¢å¼ºç½‘ç»œå¥å£®æ€§ï¼Œå¢åŠ ç‹¬ç«‹èŠ‚ç‚¹å’Œå¤šæ ·åŒ–å®¢æˆ·ç«¯ï¼Œé˜²æ­¢å•ç‚¹æ•…éšœ
    
-   è·å¾—æ¯«ç§’çº§çš„æœ¬åœ°è¯»å†™å»¶è¿Ÿå’Œè‡ªå®šä¹‰ RPC æ¥å£
    
-   æ”¯æŒæ­å»ºå½’æ¡£èŠ‚ç‚¹æŸ¥è¯¢å…¨é‡å†å²çŠ¶æ€ï¼Œæ»¡è¶³åˆè§„å®¡è®¡ã€é‡åŒ–å›æµ‹åŠå¤æ‚æ•°æ®åˆ†æéœ€æ±‚ã€‚
    
-   åœ¨ç½‘ç»œå‡çº§æˆ–å‘ç”Ÿç¡¬åˆ†å‰æ—¶æ‹¥æœ‰è‡ªä¸»é€‰æ‹©æƒï¼ˆç”¨è„šæŠ•ç¥¨ï¼‰ï¼Œè€Œä¸å¿…è¢«åŠ¨è·ŸéšæœåŠ¡å•†çš„è·¯çº¿ã€‚
    
-   å¯å®Œå…¨æ ¹æ®ä¸šåŠ¡å’Œåˆè§„è¦æ±‚ï¼Œè‡ªç”±å®šåˆ¶å®¢æˆ·ç«¯ç±»å‹ã€åŒæ­¥ç­–ç•¥ã€æ—¥å¿—ç•™å­˜åŠè®¿é—®æ§åˆ¶æƒé™ã€‚
    

**æ‰§è¡Œå®¢æˆ·ç«¯**

-   å¤„ç†&æ£€éªŒäº¤æ˜“ï¼Œæ‰§è¡Œevmæ“ä½œ
    
-   ç»´æŠ¤ä¸–ç•ŒçŠ¶æ€
    
-   æä¾› RPC æ¥å£
    
-   ä¸å…¶ä»–èŠ‚ç‚¹äº¤æ¢æ•°æ®
    

**å…±è¯†å®¢æˆ·ç«¯**

-   å…±è¯†ï¼Œå‡ºå—
    
-   è¿½è¸ªé“¾å¤´ä¸æœ€ç»ˆæ€§ï¼Œå°±æ˜¯å¤„ç†åˆ†å‰çš„æƒ…å†µ
    
-   ç®¡ç†éªŒè¯è€…é›†ä¸å¥–åŠ± / æƒ©ç½š
    
-   ç»´æŠ¤ p2p ç½‘ç»œ
    
-   Beacon API / å…±è¯† RPC
    

**â€œå‡ºå— / åŒæ­¥â€æµç¨‹**

1.  èŠ‚ç‚¹è¢«é€‰æ‹©ä¸º proposerï¼Œæ‰§è¡Œå®¢æˆ·ç«¯ç”Ÿæˆ execution payload
    
2.  æ‰§è¡Œå®¢æˆ·ç«¯æ‰§è¡Œäº¤æ˜“ï¼Œè¿”å›å®Œæ•´ payload
    
3.  å…±è¯†å®¢æˆ·ç«¯å°† execution payload æ‰“åŒ…æ”¾å…¥ block ï¼Œä½œä¸ºæè®®çš„åŒºå—ï¼Œç„¶åå¹¿æ’­
    
4.  å…¶ä»–èŠ‚ç‚¹çš„å…¬å¼å®¢æˆ·ç«¯æ¥æ”¶å¹¶éªŒè¯åŒºå—ï¼ŒåŒ…æ‹¬
    
    1.  éªŒè¯ PoS ç­¾åã€slot/epochã€å†å²é“¾ç­‰å…±è¯†è§„åˆ™ï¼›
        
    2.  æ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡Œå®¢æˆ·ç«¯å†æ¬¡æ‰§è¡Œäº¤æ˜“ï¼ŒéªŒè¯åˆæ³•æ€§
        
    3.  æ‰€æœ‰é€šè¿‡åˆ™è¯¥å—è¢«æ­£å¼å‘å¸ƒï¼Œå¼€å§‹ä¸‹ä¸€è½®å¾ªç¯
        

è°ƒç”¨ eth\_\* / éƒ¨ç½²åˆçº¦ / æŸ¥çŠ¶æ€ï¼Ÿ

â†’ æ‰¾çš„æ˜¯ æ‰§è¡Œå®¢æˆ·ç«¯ï¼ˆEVM + JSON-RPCï¼‰ã€‚

è´¨æŠ¼ 32 ETH åšéªŒè¯è€… / å…³å¿ƒ attestationã€finalityã€slashingï¼Ÿ

â†’ è¿™æ˜¯ å…±è¯†å®¢æˆ·ç«¯ + éªŒè¯è€…å®¢æˆ·ç«¯ çš„å·¥ä½œã€‚

> å°±å…ˆæŠŠå‰ä¸¤ç« çœ‹å®Œå§ï¼Œå‰©ä¸‹çš„æ˜å¤©å†çœ‹ï¼Œæ„Ÿè§‰å¥½å¤šä¸œè¥¿éƒ½å¿˜è®°äº†ï¼Œæ‰“ç®—å†æƒ³åŠæ³•è¡¥ä¸€ä¸‹ä¹‹å‰çœ‹çš„åŒºå—é“¾è¯¾ç¨‹çš„è§†é¢‘

### Rust

vector

åŸºç¡€ç”¨æ³•

```Rust
fn main() {
    let v1: Vec<i32> = Vec::new();  // åˆ›å»ºä¸€ä¸ªç©ºçš„åŠ¨æ€æ•°ç»„,Vecå¿…é¡»æŒ‡å®šç±»å‹
    let v2: Vec<i32> = vec![1, 2, 3, 4, 5];
    let mut v3 = Vec::new(); // å¯å˜åŠ¨æ€æ•°ç»„,ç±»å‹ç”±ç¼–è¯‘å™¨æ¨æ–­,åç»­æ·»åŠ å…ƒç´ æ—¶ç¡®å®šç±»å‹
    v3.push(10); // æ·»åŠ å…ƒç´ 

    let third: &i32 = &v2[2]; // ä½¿ç”¨ç´¢å¼•è®¿é—®å…ƒç´ ,è¿”å›å¼•ç”¨,å¦‚æœç´¢å¼•è¶Šç•Œä¼španic
    let third_opt: Option<&i32> = v2.get(2); // ä½¿ç”¨getæ–¹æ³•è®¿é—®å…ƒç´ ,è¿”å›Optionç±»å‹,è¶Šç•Œè¿”å›Noneã€‚ç”¨ get æ–¹æ³•é»˜è®¤æ˜¯ä¸å¯å˜å¼•ç”¨
    
}
```

```Rust
    let mut v = vec![100, 32, 57];
    for i in &mut v {
        *i += 50;
    }
```

ä¸‹é¢è¿™ä¸ªä»£ç æ˜¯é”™çš„

```Rust
fn main() {
  let v = vec![String::from("Hello ")];
  let mut s = v[0];
  s.push_str("world");
  println!("{s}");
}
```

å…¶ä¸­`let mut s = v[0];` é”™è¯¯

ä¸èƒ½é€šè¿‡ç´¢å¼•ï¼ˆIndexingï¼‰æŠŠå€¼ä»é›†åˆä¸­â€œæ¬èµ°â€ï¼ˆMove outï¼‰ã€‚

ä½†æ˜¯ i32 å¯ä»¥è¿™æ ·å†™ï¼Œå› ä¸º i32 æ˜¯ç›´æ¥æ‹·è´

ä½¿ç”¨è¿­ä»£å™¨éå†vec

```Rust
    let mut v: Vec<i32> = vec![1, 2];
    let mut iter: Iter<'_, i32> = v.iter();
    let n1: &i32 = iter.next().unwrap();
    let n2: &i32 = iter.next().unwrap();
    let end: Option<&i32> = iter.next();
```

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=MmI1MTY5NmU4ZjU3ZWQxMzNjNGRjNTRhOTA3YzQ5ZTJfam94MjdRakhGZ2swcjVYSTFrS0dsbmJ0YWJqN0JYZUVfVG9rZW46S05FSWJ4bmZ5b1AxQlB4ZUFpY2NFV2dNbkdjXzE3NjgyMzEyMDg6MTc2ODIzNDgwOF9WNA)

next() æ–¹æ³•çš„é€»è¾‘æ˜¯ï¼šå…ˆè¿”å›å½“å‰å…ƒç´ çš„å¼•ç”¨ï¼Œç„¶åå°†è¿­ä»£å™¨å†…éƒ¨çš„æŒ‡é’ˆå‘åç§»åŠ¨ä¸€ä½

ç±»ä¼¼cppä¸­çš„i++

ä½¿ç”¨ç´¢å¼•éå†åŠ¨æ€æ•°ç»„

```Rust
use std::ops::Range; 
let mut v: Vec<i32>        = vec![1, 2];
let mut iter: Range<usize> = 0 .. v.len();
let i1: usize              = iter.next().unwrap();
let n1: &i32               = &v[i1];
```

åœ¨ vec é‡Œé¢é•¶ä¸€ä¸ª enum å¯ä»¥è®© vec ä¸­å­˜ä¸åŒç±»å‹çš„å…ƒç´ 

```Rust
    enum SpreadsheetCell {
        Int(i32),
        Float(f64),
        Text(String),
    }

    let row = vec![
        SpreadsheetCell::Int(3),
        SpreadsheetCell::Text(String::from("blue")),
        SpreadsheetCell::Float(10.12),
    ];
```

```Rust
fn main() {
  let mut v: Vec<i32> = vec![1, 2, 3];
  let mut v2: Vec<&mut i32> = Vec::new();
  for i in &mut v {
    v2.push(i);
  }
  *v2[0] = 5;
  let a = *v2[0];
  let b = v[0];
  println!("{a} {b}");
}
```

v2 å­˜æ”¾ v æ¯ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œè¯»å†™æƒåœ¨ v2

`*v2[0] = 5;` ä¿®æ”¹ v\[0\]

`let a = *v2[0]; let b = v[0];`ä¸¤å¥å› ä¸ºæ˜¯ i32 æ•°æ®ç±»å‹ï¼Œç›´æ¥å¤åˆ¶ï¼Œæ¢åˆ«çš„æ•°æ®ç±»å‹ä¼š move å¯¼è‡´æŠ¥é”™ï¼Œç„¶åv2åœ¨åç»­æ²¡æœ‰ä½¿ç”¨ï¼Œv é‡æ–°è·å¾—è¯»å†™æƒ

## æ‚é¡¹

rustæ˜¯å¯¹çš„ï¼Œå†²ï¼

web3æ‹›è˜å¹³å°

-   SmartDeer
    
-   Web3.carrer
    
-   Remote3
    
-   CryptoJobsList
    

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=YTRhNmU4YTZlZGRlMWE3Zjk1OGUyM2JlYmVkNDIyZDlfT1RyM3E4aWRqMm1rTVNRSThhNWw5OU5jdUp6Rnk5M2hfVG9rZW46WHhsRGJnbG95bzBOTHp4OVdtamM4OGhyblhnXzE3NjgyMzEyMDg6MTc2ODIzNDgwOF9WNA)

å¦‚ä½•è¿›å…¥web3

-   ä»web2è¿ç§»
    
    -   è‹±æ–‡ï¼
        
    -   ç‹¬ç«‹äº¤ä»˜é¡¹ç›®æˆæœ
        
-   ä»ç”Ÿæ€ä¾§æ¥å…¥
    
    -   DAO ä¸­æ¥ä»»åŠ¡
        
    -   å¼€æºç¤¾åŒºè´¡çŒ®ä»£ç 
        

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=MWY2ZjJiN2Q0MzIwZDZlYWE5OWI2YjBkMzhjMDY3ZGZfczZtMmY2U0pLbkJLZTNBVWl2VWxzY1BZQks5anBzYzFfVG9rZW46TXY0emJZZ21mbzdMQWN4bXlscWNIYURlbkZnXzE3NjgyMzEyMDg6MTc2ODIzNDgwOF9WNA)

Rustæ˜¯å¯¹çš„ï¼ï¼ï¼ï¼ï¼ï¼

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=MDgwZjRiODZlMDA4OGY4OTg2MjY5ZGU2YWQ2NWI4MjBfWHVHVUpMMGpWdEtvYXJ5UTlFSU1EUzNSM25TcEpuTHVfVG9rZW46THI4c2J0Vkdqb2Z1QWx4QW9SMWN1U3lXbnRkXzE3NjgyMzEyMDg6MTc2ODIzNDgwOF9WNA)

## ä»Šæ—¥æ€»ç»“

-   **å…¥é—¨æŠ€æœ¯&æ·±åº¦æŠ€æœ¯ä»»åŠ¡**
    
    -   Web3 å®ä¹ æ‰‹å†Œ[ã€Œå…¥é—¨å¯¼è¯»ã€](https://web3intern.xyz/zh/blockchain-basic/)éƒ¨åˆ†âœ…
        
    -   Web3 å®ä¹ æ‰‹å†Œ[ã€Œå®‰å…¨ä¸åˆè§„ã€](https://web3intern.xyz/zh/security/)éƒ¨åˆ†âœ…
        
    -   021 å­¦ä¹ ä»¥å¤ªåŠç¬¬ 1-3 ç« â­•
        
    
    > å¤ªå¤šäº†ï¼Œæœ‰ç‚¹é«˜ä¼°è‡ªå·±äº†ï¼Œåªçœ‹å®Œå‰ä¸¤ç« ï¼Œæ˜å¤©å†åŠªåŠ›å§
    
    -   Ethereum å®˜ç½‘ [Overview](https://ethereum.org/learn/) åŸºç¡€å†…å®¹å­¦ä¹ âœ…
        
    -   [**Day 1: A Developer's Guide to Building on Ethereum**](https://www.youtube.com/watch?v=zuJ-elbo88E&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=1) - Introâœ…
        
    -   [**Day 2: Becoming a Power User - Wallets, Mnemonics, Keypairs**](https://www.youtube.com/watch?v=_GjPeRLCREA&list=PLJz1HruEnenAf80uOfDwBPqaliJkjKg69&index=2)**â­•**
        
    
    > å­¦ä¸å®Œäº†
    
    -   å·¥å…·å®‰è£…æŒ‡å—ï¼š[https://web3intern.xyz/zh/remote-work-guide/âœ…](https://web3intern.xyz/zh/remote-work-guide/âœ…)
        
    
    > æ˜¨å¤©è£…å®Œäº†ï¼Œè¿™ä¸ªä¸ç®¡äº†
    
    -   [Uniswap V2 å­¦ä¹ å®˜æ–¹æ–‡æ¡£](https://docs.uniswap.org/contracts/v2/overview?utm_source=chatgpt.com)â­•
        
    
    > ç›¸ä¿¡æ˜å¤©çš„è‡ªå·±å§è¿˜æ˜¯
    
-   **RuståŸºç¡€**
    
    -   ç¬¬å…«ç«  common collectionâ­•
        
    -   ç¬¬ä¹ç«  error handling â­•
        
    
    > ğŸ˜­ğŸ˜­ğŸ˜­rustï¼Œæˆ‘çš„rust
    
-   **æ‚é¡¹**
    
    -   æŠŠå°ç™»è¯•å·erå›¾é‚£é¢˜æ”¹å®Œå§
        
    
    > æ˜å¤©å†å¹²
    

æ„Ÿè§‰ä»Šå¤©å¤§æ¦‚æ˜¯å¼€ä¼šå çš„æ—¶é—´æœ‰ç‚¹å¤ªå¤šäº†ï¼‰

å”‰ï¼Œæ˜å¤©å†åŠ æ²¹å§

![](https://my.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDJlMDQ5NDgxYTE3ZTA2MjYxOGEwMzY0MDU4OWQzZjNfZWp5OVZmV2NRMWtJODQ5R3lGWVAwenlvTUFSb3pxOElfVG9rZW46WWhKRmI4QlU1b0xaelV4aFlMWmNMNDhYbnBoXzE3NjgyMzEyMDg6MTc2ODIzNDgwOF9WNA)
<!-- DAILY_CHECKIN_2026-01-12_END -->
<!-- Content_END -->
