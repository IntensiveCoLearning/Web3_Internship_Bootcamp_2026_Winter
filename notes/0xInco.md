---
timezone: UTC+8
---

# Inco

**GitHub ID:** 0xInco

**Telegram:** @IAm0xInco

## Self-introduction

X: @0xInco

## Notes

<!-- Content_START -->
# 2026-01-29
<!-- DAILY_CHECKIN_2026-01-29_START -->
昨天忘记了...
<!-- DAILY_CHECKIN_2026-01-29_END -->

# 2026-01-27
<!-- DAILY_CHECKIN_2026-01-27_START -->

听了 Marcus 讲了关于公共物品资金分配的问题，也提到了一些有趣的治理问题

具有成熟VC投资以及商业化价值过高的项目，还可以分配公共物品资金吗？

我们面临2选1决策的时候，是均分还是投硬币？

我们如何能有效的防止治理攻击（从机制上，而不是对话判断）？
<!-- DAILY_CHECKIN_2026-01-27_END -->

# 2026-01-26
<!-- DAILY_CHECKIN_2026-01-26_START -->


系统梳理了一遍 vibe coding 和投研框架，还是有些收获的，争取尽量挤时间搞作业吧
<!-- DAILY_CHECKIN_2026-01-26_END -->

# 2026-01-25
<!-- DAILY_CHECKIN_2026-01-25_START -->



这是一份基于视频“Uniswap 工作原理解析”的详细学习笔记。主要内容涵了 Uniswap V2 的基础机制、核心 DeFi 概念、Uniswap V3 的集中流动性创新以及相关的开发者资源。

### 一、 Uniswap V2：基础 AMM 模型

**1\. 核心公式与定价**

-   **恒定乘积公式：** 核心机制是 $x \\times y = k$。其中 $x$ 和 $y$ 是两种资产的数量，$k$ 是恒定值。
    
-   **价格发现：** 价格 $P = y / x$。在曲线上，所有点的 $x \\times y$ 都等于 $k$，但每个点的 $y/x$（价格）不同。
    
-   **交易机制：**
    
    -   当用户买入资产时，池子中的一种资产增加 ($\\Delta x$)，另一种减少 ($\\Delta y$)，交易后仍需满足 $k$ 值不变（或因手续费略微增加）。
        
    -   **手续费：** V2 手续费通常固定为 0.3%。在计算输入输出时，需扣除手续费（如输入 $x$ 的 0.3% 作为费用，剩余 99.7% 用于交换）,。
        

**2\. 套利机制 (Arbitrage)**

-   **原理：** 当 Uniswap 价格与外部市场（如 Binance）不同时，套利者会介入。
    
-   **案例：** 假设 Uniswap 中 ETH 价格为 3000，Binance 为 3200。套利者会在 Uniswap 以 3000 买入 ETH，推高 Uniswap 价格，并在 Binance 卖出，赚取差价，最终抹平价差,。
    

**3\. 闪电贷 (Flash Swaps)**

-   **流程：** 允许用户先借出代币，执行任意逻辑（如套利、清算），最后在同一笔交易中归还代币并支付费用。
    
-   **优势：** 相比传统交易（先付款后发货），Flash Swap 允许“先拿货”，极大地提高了资金利用率，且原子化执行（若不还钱则交易回滚），无违约风险,。
    

**4\. 链上价格预言机 (TWAP)**

-   **时间加权平均价格：** 为了防止价格被瞬间操纵，Uniswap V2 记录累积价格（价格 $\\times$ 时间）。
    
-   **计算：** 通过读取 $T\_1$ 和 $T\_0$ 两个时间点的累积价格差值，除以时间间隔，得出该段时间的平均价格,。
    

* * *

### 二、 核心 DeFi 概念解析

**1\. 价格影响 vs. 滑点 (Price Impact vs. Slippage)**

-   **价格影响 (Price Impact)：** 是**确定性**的。由池子深度（$k$ 值大小）决定。池子越深，大额交易对价格的推动越小；池子越浅，价格偏离越大,。
    
-   **滑点 (Slippage)：** 是**非预期**的。指预期成交价与实际成交价的差异。通常由抢跑（Front-running）或市场剧烈波动导致。
    
    -   _防御措施：_ 设置最大滑点（Max Slippage）。设置过低保护性好但容易失败，设置过高容易被“三明治攻击”,。
        

**2\. MEV (最大可提取价值)**

-   **现象：** 攻击者（如 Searcher）通过提高 Gas 费抢先交易，把价格推高让用户在高位成交，然后再卖出获利。
    
-   **防护：** 使用 Flashbots 等隐私 RPC，让交易对公开内存池（Mempool）不可见，直到上链。
    

**3\. 无常损失 (Impermanent Loss)**

-   **定义：** 相比于直接持有代币（HODL），作为 LP（流动性提供者）在价格波动时产生的相对损失。
    
-   **成因：** 当代币价格比例发生变化，LP 被动地卖出上涨资产、买入下跌资产（逆向选择）。
    
-   **特性：** 只要价格没有回到初始比例，损失就存在；如果价格回归，损失消失。目前被认为是 AMM 机制中无法避免的成本，需靠手续费补偿,。
    

* * *

### 三、 Uniswap V3：集中流动性 (Concentrated Liquidity)

**1\. 核心理念**

-   **资金效率：** 在 V2 中，流动性分布在 $(0, \\infty)$ 的整个区间，大部分资金未被利用。V3 允许 LP 仅在特定价格区间（如 ETH 2500-3500）提供流动性,。
    
-   **效果：** 在特定区间内，V3 可以用更少的资金达到 V2 同样的深度（更高的虚拟 $k$ 值），赚取更多手续费。
    

**2\. 核心算法与数据结构**

-   **Tick (刻度)：** 价格空间被分割成离散的点（Ticks），公式为 $1.001^i$。流动性只能在这些 Tick 之间添加。
    
-   **Tick Bitmap：** 为了节省 Gas，V3 使用位图（Bitmap）来记录哪些 Tick 上有流动性变化，便于交易时快速查找下一个活跃 Tick。
    
-   **计算公式：** 使用 $L$（流动性）和 $\\sqrt{P}$（价格平方根）进行计算。
    
    -   公式推导：$\\Delta x = \\Delta \\frac{1}{\\sqrt{P}} \\cdot L$，$\\Delta y = \\Delta \\sqrt{P} \\cdot L$。
        

**3\. 费率机制**

-   **多费率层级：** 根据资产波动性不同，提供 0.01%（稳定币）、0.05%、0.3%、1% 等不同费率池。
    
-   **Fee Growth Outside：** 手续费不再像 V2 那样自动复投，而是单独记录。
    
    -   _算法：_ 使用 "Fee Growth Global"（全局累计）和 "Fee Growth Outside"（区间外累计）来计算特定区间内的应得手续费,。
        

* * *

### 四、 生态资源与开发者支持

**1\. 资助与孵化**

-   **Uniswap Foundation Grants：** 提供资金支持，从几千刀到大额资助均有。
    
    -   _Open Code:_ 任何有趣的想法都可以申请。
        
    -   _Events:_ 赞助各类黑客松（如 ETH Global, HackMoney）。
        
-   **Hooking Incubator：** 官方孵化器，提供为期 6 周的课程和 2 周的黑客松，针对 V4 开发。
    

**2\. 审计与安全**

-   **审计补贴：** 基金会提供审计费用补贴（最高可全免）。开发者通过运营市场发布需求，由顶级审计公司（如 Trail of Bits, OpenZeppelin 等）报价。
    

**3\. V4 前瞻**

-   **Hooks：** V4 引入了 Hooks（钩子），允许在交易或添加流动性的各个阶段调用外部逻辑，实现高度定制化。
    

这是一份基于“Web3 实习计划（冬季）：Dapp Workshop”视频内容的详细学习笔记。内容涵盖了从 Web3 基础理念、全栈开发实战技巧、DeFi 协议架构演进（以 Aave 为例）到具体开发工具的使用指南。

### 一、 Web3 核心理念与 DApp 基础

**1\. 核心革命：所有权 (Ownership)**

-   **Web2 vs Web3：**
    
    -   **Web2 (租客模式)：** 用户是租客，数据锁在中心化服务器（如腾讯）里，资产只是数据库里的一行代码。如果平台关门或封号，用户将一无所有,。
        
    -   **Web3 (房东模式)：** 用户拥有私钥（万能钥匙），数据跟随钱包。即使前端平台倒闭（如 Mirror），文章等内容仍存在于区块链上，无法被篡改,。
        
-   **DApp 的本质：**
    
    -   传统 App 像私人店铺，要看老板脸色；DApp 像广场上的自动贩卖机，没有老板，只要支付 Gas（投币）就能执行代码逻辑，无人能拔电源。
        
-   **DApp 三驾马车：**
    
    -   **智能合约：** 铁面无私的裁判，负责执行逻辑。
        
    -   **区块链：** 不可篡改的账本，记录所有权。
        
    -   **代币：** 驱动机器运转的燃料。
        

**2\. 核心特性与挑战**

-   **去信任 (Trustless)：** 不需要信任人品，只需要信任代码。代码即中间人。
    
-   **透明性：** 链上一切可查，但需区分 Gas（门票费）和 Governance（治理权）。
    
-   **现状：** 现在的 Web3 像 1995 年的互联网，又慢又贵且难用。操作不可撤销，且面临黑客攻击和代码漏洞的风险，**安全意识永远是第一位的**。
    

* * *

### 二、 DApp 全栈开发实战 (Hybrid Stack)

**1\. 混合架构工具链：Foundry + Hardhat**

-   **演进：** Truffle 和 Web3.js 已逐渐淡出，现代标准是 Foundry 和 Hardhat。
    
-   **混合优势 (Hybrid Stack)：**
    
    -   **Foundry (基于 Rust)：** 编译速度极快（快20倍），擅长计算密集型任务（如跑 1000 个测试单元）、核心逻辑编写和模糊测试 (Fuzzing)。
        
    -   **Hardhat (基于 TS/JS)：** 插件生态丰富，适合交互密集型任务，如部署管理、前端集成测试、编写脚本,。
        
-   **协同工作：** 通过插件配置，让两者指向同一个物理路径，Foundry 找合约，Hardhat 做外围脚本。
    

**2\. 智能合约开发最佳实践**

-   **Gas 优化：** 使用 **Custom Errors**（自定义错误）代替 `require` 字符串。字符串存储昂贵，而 Custom Error 只是 4 字节哈希，能大幅节省 Gas。
    
-   **索引 (Indexed Events)：** 前端查询链上数据依赖监听事件。必须加 `indexed` 关键字，否则前端需要遍历所有日志，效率极低。
    
-   **安全黄金法则 (Checks-Effects-Interactions)：** 防止重入攻击。必须先检查权限 -> 修改状态变量 -> 最后进行转账或外部调用。
    
-   **模糊测试 (Fuzzing)：** 仅仅做单元测试是不够的。黑客不按套路出牌。Foundry 的模糊测试会自动生成成千上万个随机、边缘、甚至异常的输入来轰炸合约，发现人脑想不到的 Bug,。
    

**3\. 前端开发与交互 (Next.js + Wagmi)**

-   **技术选型：** Next.js (SSR/SEO友好) + Wagmi (React Hooks 集合，封装了连接钱包逻辑) + Viem (底层交互),。
    
-   **常见坑与解决方案：**
    
    -   **水合不匹配 (Hydration Mismatch)：** 服务端渲染 HTML 时不知道是否有钱包连接（显示“未连接”），客户端 React 接管后发现有连接（显示“已连接”），导致闪烁和报错。**解决：** 将连接状态写入 Cookie，服务端读取 Cookie 直接生成正确的 HTML。
        
    -   **数值类型 (BigInt)：** JS 的 `Number` 最大为 $2^{53}-1$，而 Solidity `uint256` 是 $2^{256}-1$。直接处理会丢失精度或报错。**解决：** 必须显式转换为 String 展示。
        
    -   **交互体验：** 写操作比读操作复杂，必须提供完整反馈：Pending (等待签名) -> Mining (正在打包) -> Success (收到 Receipt)。**注意：** 必须等待 `wait for transaction receipt` 才算真正成功，不能只看钱包没报错,。
        

* * *

### 三、 协议架构演进案例：Aave (V3 到 V4)

**1\. 借贷协议基础**

-   **点对池 (Peer-to-Pool)：** 区别于传统的点对点，提供即刻流动性。
    
-   **核心机制：** 动态利率（利用率超过 80% 利率飙升以防挤兑）和自动清算（依靠外部清算人维持系统健康）,。
    

**2\. Aave V3 的工程优化**

-   **Bitmap (位图)：** 为了省 Gas，将 30 多个配置参数压缩进一个 `int256` 中，通过位运算一次性读取。
    
-   **惰性计算 (Liquidity Index)：** 余额不会每秒更新（链上存不起）。系统维护“流动性指数”，只有在用户交互时，通过 `原始份额 * 全局指数` 计算当前余额。
    

**3\. Aave V4 的架构革新：Hub-and-Spoke**

-   **痛点：** V3 流动性碎片化，不同池子（USDC, USDT）互不相通。
    
-   **新架构：**
    
    -   **Liquidity Hub (心脏)：** 统一管理所有资金和记账，不关心具体业务。
        
    -   **Spokes (肢体)：** 负责具体业务逻辑（如标准借贷、RWA 资产逻辑）。
        
-   **优势：** 统一流动性，消除孤岛；支持无限扩展业务模块；引入风险定价（不同抵押品不同利率）,。
    
-   **潜在风险：** Spoke 信用穿透风险（某个 Spoke 漏洞可能影响全局）、预言机延迟、极端行情下的流动性枯竭。
    

* * *

### 四、 开发工具操作指南

**1\. Foundry 三件套**

-   **Anvil (服务器)：** 本地测试网节点，启动后创造一个“世界”，关闭即销毁。
    
-   **Forge (铁匠/编译器)：** 负责编译、测试、模糊测试。
    
-   **Cast (施法/客户端)：** 命令行工具，用于发交易、查状态。
    
    -   `cast call`：免费，读取数据（如查分）。
        
    -   `cast send`：付费，发送交易（如改分），需要私钥签名。
        
    -   _注意：_ 链上返回的是 16 进制，需转换阅读。
        

**2\. Hardhat 工作流**

-   **优势：** 相比 Foundry 的单兵作战，Hardhat 更像正规军，适合自动化脚本和模拟前端交互。
    
-   **核心组件：** Network (本地私服), Script (自动机器人), Console (交互式控制台)。
    
-   **关键点：** 必须理解 `await`，因为区块链交互是异步的，必须等待承诺（Promise）兑现。
    

**3\. 部署与验证**

-   **私钥管理：** **绝对不要**将私钥明文写在 `.env` 文件中，应使用 `Keystore` 加密存储。
    
-   **代码验证：** 部署后必须在 Etherscan 上 Verify，否则别人看到的是乱码，无人敢用。
    
-   **幂等性 (Idempotency)：** 好的部署脚本（如 Ignition）应具备断点续传能力，防止网络中断导致重复发币。
    

### 总结

从 Web2 到 Web3 的转变是所有权的回归。成为一名优秀的 DApp 开发者，不仅要掌握 Foundry 和 Hardhat 这种混合技术栈，还需要深刻理解 Gas 优化、安全防御（如重入攻击防护）以及优秀协议（如 Aave）的设计哲学。代码即法律，UI 是桥梁，安全是基石。
<!-- DAILY_CHECKIN_2026-01-25_END -->

# 2026-01-24
<!-- DAILY_CHECKIN_2026-01-24_START -->




听了会儿 CryptoTalk 晚上也刷了下 X 看到 USD1 的事，继续捣鼓 LOB 去了
<!-- DAILY_CHECKIN_2026-01-24_END -->

# 2026-01-23
<!-- DAILY_CHECKIN_2026-01-23_START -->





稍微听了会周会，有关 AI workflow 的内容，明天得去做作业了hhh好多天没弄了
<!-- DAILY_CHECKIN_2026-01-23_END -->

# 2026-01-22
<!-- DAILY_CHECKIN_2026-01-22_START -->






额今天没听课....大概明早的也听不到，周末会把视频丢给 NotebookLM 去学习并总结笔记的
<!-- DAILY_CHECKIN_2026-01-22_END -->

# 2026-01-21
<!-- DAILY_CHECKIN_2026-01-21_START -->







打卡了下 uniswap 解析，然后再听了会休闲黑客松的介绍hhhh，继续忙一下自己事去了
<!-- DAILY_CHECKIN_2026-01-21_END -->

# 2026-01-20
<!-- DAILY_CHECKIN_2026-01-20_START -->








稍微听了会 Marcus 讲的公共物品资金分配，后边主要听的是 Elon 过了遍 Solidity 的基本语法，也是复习了下
<!-- DAILY_CHECKIN_2026-01-20_END -->

# 2026-01-19
<!-- DAILY_CHECKIN_2026-01-19_START -->









今天听了 Luna 老师关于社区运营基础与活动策划的分享，再次复习了下 Telegram 群聊的创建和运营功能等等
<!-- DAILY_CHECKIN_2026-01-19_END -->

# 2026-01-18
<!-- DAILY_CHECKIN_2026-01-18_START -->










今天冲了一下很多任务的分数吧，然后前两天的一个帖子现在有快30k的查看量哈哈还是蛮激动的

**以太坊中文周会的笔记：**

这是一份基于「Web3BuidlerTech」YouTube 频道发布的《以太坊中文周会（2026/01/12 期）》视频内容的详细总结笔记。本次周会涵盖了区块链快讯、市场深度观点（Blockworks 访谈与 Vitalik 文章）、技术与研报解读（PeerDAS 与 OSL 2025 回顾）等板块。

以下是核心内容总结：

### 1\. 区块链行业快讯 (Weekly Briefing)

-   **以太坊与 L2 动态**：
    
    -   **以太坊 Pectra 升级**：继续推进，Blob 目标值提升至每区块 14 个（最大 21 个），旨在提高吞吐量。
        
    -   **Arbitrum (ARB)**：引入新定价模型并提高最低基础费（从 0.01 提至 0.02 Gwei）以减少垃圾交易攻击。Robinhood 宣布选择 Arbitrum 构建其 L2，看重其安全性与流动性。
        
    -   **Optimism (OP)**：由于币价表现不佳，提出回购提案，计划用 Superchain 收入的 50% 回购 OP 代币并锁入金库。
        
    -   **Starknet 宕机**：1 月 5 日发生约 18 分钟宕机，原因是执行层与证明层状态不一致导致交易无法被 L1 确认。
        
    -   **OPBNB**：完成主网硬分叉，减少区块时间以提高吞吐量。
        
-   **市场与安全**：
    
    -   **PolyMarket 争议**：因委内瑞拉选举预测判定问题引发不满，用户质疑平台中心化倾向。
        
    -   **安全事故**：Orbit Chain (Trubit) 遭攻击损失 8000 ETH（约 2600 万美元）；Aave 攻击者将资金转入 Tornado Cash。
        
    -   **Zcash (ZEC) 团队冲突**：ECC 核心开发团队因治理分歧集体离职，成立新公司专注于钱包商业化，引发社区震动。
        
-   **机构与采用**：
    
    -   **Riot (矿企) 抛售 BTC**：出售约 2 亿美元 BTC 用于扩建 AI 数据中心和电力设施。
        
    -   **Twitter (X) 与 Solana**：Twitter 开发 "Smart Cash Tag" 标记资产价格；Solana 将在推文中内置类似功能，直接展示资产行情。
        
    -   **投融资**：a16z crypto 投资 Babylon (BTC Staking)；Fireblocks 收购加密会计平台；Polygon 拟收购比特币 ATM 公司。
        

### 2\. 深度观点与市场前瞻 (Insights)

-   **Blockworks 联创访谈：2026 年展望**
    
    -   **“体感”偏差**：虽然 2025 年初 ETH 和 BTC 创下新高，但市场并没有真正牛市的感觉，缺乏新用户入场，主要参与者仍是存量用户。
        
    -   **历史对照**：当前阶段类似 2001-2002 年的互联网泡沫破灭后时期，基础设施过度建设，2026 年将进入“剩者为王”的整合期。
        
    -   **资产预测**：
        
        -   **ETH vs BTC**：预测 2026 年 ETH 表现可能优于 BTC。BTC 被视为“数字黄金”，而 ETH 是资产发行（RWA/稳定币）的链。
            
        -   **L2 格局**：新 L2 机会渺茫，强者恒强。Base 可能面临监管或定位模糊的挑战。
            
        -   **热门赛道**：预测市场（PolyMarket/Kalshi）和应用链（AppChains）将持续增长。
            
-   **Vitalik 关于以太坊“终局”的思考**
    
    -   **韧性 (Resilience) > 效率**：以太坊的目标不是追求极致的延迟降低（这是中心化大厂的优势），而是追求抗审查和主权。即使云服务商（如 Cloudflare）宕机，以太坊应用仍应能运行。
        
-   **NFT 新标准 (ERC-4804)**
    
    -   **解决痛点**：解决 NFT 元数据存储在链下（如 IPFS）容易丢失的问题。ERC-4804 提供类似 HTTP 的链上数据访问规范。
        
    -   **采用**：OpenSea 和 OKX 已开始支持此协议，推动全链上数据存储。
        

### 3\. 技术解读：PeerDAS 与网络性能

-   **PeerDAS 的影响**：
    
    -   **背景**：PeerDAS 旨在大幅扩容 Blob 数量（目标从 6 个提升至 48-72 个）。
        
    -   **性能悖论**：根据 Panda Ops 数据，PeerDAS 上线后，对于 95% 的验证者（Validators），由于只需下载部分数据列（128 列中的 8 列），验证速度反而提升了；但对于网络性能最差的 5% 节点，延迟反而增加。
        
    -   **Timing Games 风险**：随着 Blob 数据量增加，提议者（Proposer）可能为了捕获更多 MEV 而故意推迟广播区块，这威胁网络稳定性。
        
    -   **解决方案**：建议引入 **Timing Network**（超节点），专门负责加速数据广播，确保共识稳健。
        

### 4\. 机构研报：OSL 2025 回顾与展望

-   **行业转折点**：
    
    -   **“上半场”结束**：靠链上草根创新和纯炒作的阶段已过。
        
    -   **“下半场”开启**：核心是**合规与拥抱传统资本**。重点在于稳定币、ETF 和 RWA。
        
-   **关键数据与趋势**：
    
    -   2025 年稳定币增长超 50%，合规交易所份额提升。
        
    -   **稳定币**：被视为“私有化的美联储”，预测 2030 年规模增长 10 倍。
        
    -   **ETF 与 DIT**：ETF 实现了流动性标准化；MicroStrategy 模式（DIT）将加密资产纳入资产负债表成为趋势。
        
-   **2026 预测**：
    
    -   **BTC 价格**：保守预测在 7.5 万至 14 万美元之间（视作纳指的高贝塔资产）。
        
    -   **应用落地**：传统金融代币化提速；稳定币支付进入真实消费场景（跨境支付、电商）。
        
    -   **风险**：宏观流动性逆转、监管收紧以及 DeFi 安全事故仍是主要威胁。
        

### 5\. 社区消息

-   **近期活动**：1 月 14 日晚将举办以太坊全球社区 AMA，探讨 Devcon 及 2026 年社区规划。
<!-- DAILY_CHECKIN_2026-01-18_END -->

# 2026-01-17
<!-- DAILY_CHECKIN_2026-01-17_START -->











多看了会儿 perp 的机制，后边自己多研究研究  

* * *

# 一、永续合约是什么（What）

**永续合约（Perpetual Futures / Perp）是一种“没有到期日”的衍生品合约。你可以把它理解为：交易所提供的一种标准化合约，让你用保证金（margin）以杠杆方式对标的（如 BTC、ETH）的价格变动进行双向（做多/做空）**押注，并且允许长期持有而无需换月。

与传统期货最大的区别是：传统期货有交割/到期日，价格会自然向现货收敛（因为到期交割迫使基差归零）；而永续合约没有到期日，因此**必须靠一套持续的激励/惩罚机制**让合约价格“贴着现货走”。这套机制的核心就是 **Funding Rate（资金费率）+ 标记价格体系 + 强平风险控制**。

* * *

# 二、永续合约的核心目标（Why）

永续合约的设计目标可以归纳为一句话：

> 在“无到期日”的前提下，让永续合约价格长期围绕现货价格波动，并且可被风险系统安全清算。

传统期货因为到期交割，市场参与者做套利会把期货价格拉回现货（或拉向到期结算价）。永续合约没有这条“终端约束”，因此如果没有额外机制，永续价格可能长期偏离现货：

-   如果永续长期高于现货，多头获利预期被放大，杠杆资金会堆向永续，价格更偏离。
    
-   如果永续长期低于现货，空头拥挤也会加剧偏离。
    

因此永续需要一个“持续的、可调节强度的”收敛机制，这就是 Funding：偏离越大，多空其中一方持仓成本越高，套利者就越愿意做对冲把价格拉回去。

* * *

# 三、价格体系与锚定机制（Price System）

永续合约里你至少会看到三种价格概念：

## 1）最新成交价（Last Price）

就是盘口撮合出来的最近一笔成交价。它反映短时供需，但容易被瞬时冲击、刷单、薄盘影响。

## 2）指数价格（Index Price）

通常由多个现货市场（或多个交易所现货）加权得到，用作“现货真实价格”的代理。它的作用是：提供一个不那么容易被单一市场操纵的锚。

## 3）标记价格（Mark Price）

标记价格是交易所风险系统最关键的价格。它通常基于指数价格，并结合永续与指数之间的偏离、资金费率等做平滑或调整。核心用途是两点：

-   **计算未实现盈亏（Unrealized PnL）**
    
-   **触发强平（Liquidation）**
    

为什么要用 Mark Price 而不是 Last Price 来强平？因为如果用 Last Price，任何人都可能通过瞬时拉盘/砸盘制造“针”，诱发大规模强平，形成连锁反应。Mark Price 通过锚定指数，降低“被操纵强平”的概率。

你可以把它看成：

-   Last Price：交易的“表面价格”
    
-   Index Price：现货“锚”
    
-   Mark Price：风控“裁判价格”
    

* * *

# 四、Funding Rate（资金费率）机制（核心）

Funding 是永续合约区别于其他合约的核心机制。它不是手续费，也不是利息，而是一种**在多空持仓者之间定期发生的现金流转移**。

## 1）Funding 的基本定义

在每个结算时刻（例如每 8 小时一次，具体交易所不同），系统会根据当期的 funding rate 进行一次“多空之间的支付”：

-   **funding rate > 0：多头支付给空头**
    
-   **funding rate < 0：空头支付给多头**
    

支付规模通常近似为：

> Funding Payment ≈ Notional（名义本金） × funding rate  
> 名义本金一般与仓位价值相关，而非保证金。

## 2）它如何让价格收敛？

直觉上：

-   如果永续价格 **高于** 现货（永续溢价），说明多头更拥挤/更愿意为杠杆多付价差，那么系统会倾向产生 **正 funding**，让“做多的持仓成本上升”。这样一来：
    
    -   部分多头会因为成本退出
        
    -   套利者会做“现货多 + 永续空”吃 funding
        
    -   永续买压下降、卖压上升，价格回落向现货
        
-   反之，如果永续价格 **低于** 现货，会倾向出现 **负 funding**，提高空头成本，引导反向套利，价格上修。
    

从量化角度，Funding 等价于一种“动态 carry”，它把永续偏离现货的程度内生化为持仓成本，从而形成一个负反馈环。

## 3）Funding 与情绪/拥挤度

Funding 在实践中往往被用作拥挤度 proxy：

-   长期正 funding：多头拥挤，杠杆多更贵
    
-   极端正 funding：市场可能进入“强趋势 + 高拥挤”，容易出现多头挤压后的回撤  
    但注意：极端 funding 不等于必然反转，它也可能意味着趋势强到足以覆盖 funding 成本，因此在策略上更像“状态变量”，需要结合波动率与趋势强度共同判断。
    

* * *

# 五、保证金与杠杆机制（Margin & Leverage）

永续的杠杆本质不是“借钱”，而是**用保证金承担更大名义头寸的价格风险**。

## 1）初始保证金（IM）

开仓所需的最低保证金。杠杆越高，IM 越低（但风险越大）。

## 2）维持保证金（MM）

维持仓位不被强平所需的最低保证金水平。通常 MM < IM，但当市场不利波动导致权益下降，若低于 MM，就会触发清算流程。

## 3）逐仓 vs 全仓

-   **逐仓（Isolated）**：该仓位的风险隔离，只用分配给该仓位的保证金承担亏损；好处是单仓爆了不拖累账户，坏处是更容易被强平。
    
-   **全仓（Cross）**：账户内可用余额共同承担亏损；好处是抗波动更强，坏处是极端情况下会把账户一起拖入风险。
    

* * *

# 六、未实现盈亏与已实现盈亏（PnL Mechanics）

## 1）未实现盈亏（Unrealized PnL）

多数交易所用 **Mark Price** 来计算未实现盈亏，这与风控一致：你的权益变化以“裁判价格”为准，避免被 Last Price 的瞬时针影响。

## 2）已实现盈亏（Realized PnL）

当你平仓或部分平仓时，盈亏以成交结果确定，转为已实现。

## 3）为什么 Mark Price 对量化重要

因为它决定了：

-   你的权益曲线怎么变化
    
-   强平风险如何出现
    
-   在高波动时，你的“账面亏损”是否会先触发风控而迫使退出
    

这会影响策略评价：单纯用 mid/last 计算回测可能高估可持有性。

* * *

# 七、强平与风险控制机制（Liquidation）

当仓位权益不足以覆盖维持保证金要求，系统会触发强平。强平并不一定是“一刀切归零”，很多交易所是分阶段：降低仓位、提高保证金占比、或逐步清算。

关键点：

## 1）强平触发为什么用 Mark Price

前面已解释：防止针刺操纵清算。

## 2）保险基金与 ADL

极端行情下，强平仓位可能无法以合理价格成交，导致“穿仓”（账户亏损超过保证金）。交易所通常用：

-   **保险基金**：用于吸收穿仓损失
    
-   **ADL（Auto-Deleveraging）自动减仓**：当保险基金不足时，系统会强制减掉盈利对手方的一部分仓位，以维持整体清算闭环。
    

对交易者而言，ADL 是一种尾部风险：你可能在盈利时被强制减仓，策略的收益分布会被截断。

* * *

# 八、仓位、订单与撮合（Position & Matching）

永续交易的“开/平/反”在机制上是仓位净额变化：

-   做多增加净多头
    
-   做空增加净空头
    
-   反向则可能等价于先平后开（具体取决于交易所是“单向持仓”还是“对冲持仓”模式）
    

订单类型层面：

-   市价单在波动时容易滑点+冲击，甚至引发不必要的强平风险
    
-   限价单控制成本但有成交不确定性
    

量化里通常需要把“滑点与强平联动”纳入风控假设。

* * *

# 九、永续合约的市场微观结构特征

永续更“情绪化”的原因不是玄学，而是结构性：

-   高杠杆使得价格波动会触发被动平仓（强平）
    
-   强平相当于“强制市价单”，会制造额外的买压/卖压
    
-   于是形成正反馈：下跌 → 强平空头/多头 → 加速下跌/上涨 → 更多强平
    

这就是 squeeze 的机制基础。你在传统期货也见过，但 crypto perp 的杠杆更高、参与者更情绪化，因此更显著。

* * *

# 十、永续合约对量化交易的含义（Quant Perspective）

对量化而言，永续最独特的信号与约束来自三块：

1.  **Funding（carry/拥挤度/成本）**：可作为状态变量、收益来源、或风险过滤条件。
    
2.  **强平链条（非线性冲击）**：波动率状态下的尾部行为与成交冲击。
    
3.  **交易所风险（机制风险）**：不同交易所的指数构成、mark 定价、强平队列都可能导致策略跨场不稳。
    

因此你常见的“纯预测 forward return”的框架，在 perp 上往往需要升级为“状态驱动 + 风控切换”。

* * *

# 十一、系统性风险与局限

永续合约的风险不只来自价格方向，还包括：

-   交易所信用与运营风险（暂停、插针、系统异常）
    
-   指数与标记价格机制差异（导致强平逻辑差异）
    
-   流动性在极端时刻坍塌（盘口看着深，实际不可交易）
    
-   策略容量限制（perp 市场容量仍有限，冲击成本上升快）
    

* * *

# 十二、总结：如何正确理解永续合约

永续合约不是“现货加杠杆”，而是一个包含：

-   **价格锚定体系（Index/Mark）**
    
-   **多空之间的资金转移（Funding）**
    
-   **强平与系统清算闭环（Liquidation/Insurance/ADL）**
    

的完整生态。
<!-- DAILY_CHECKIN_2026-01-17_END -->

# 2026-01-16
<!-- DAILY_CHECKIN_2026-01-16_START -->












今天听了一会儿分享会吧后边有事儿就下了，明天去补听一下。
<!-- DAILY_CHECKIN_2026-01-16_END -->

# 2026-01-15
<!-- DAILY_CHECKIN_2026-01-15_START -->













Rick 老师今天分享了一些 AI 概念和 Web3 的应用，比如落实到 agent 和链交互，后续会再研究研究。
<!-- DAILY_CHECKIN_2026-01-15_END -->

# 2026-01-14
<!-- DAILY_CHECKIN_2026-01-14_START -->















今天主要听了 Web3 安全的分享课，合规的就听了开头...结果好像说是有什么狠料在最后...行吧
<!-- DAILY_CHECKIN_2026-01-14_END -->

# 2026-01-13
<!-- DAILY_CHECKIN_2026-01-13_START -->
















今天又听了一遍 Web3 基础知识分享吧 hhhh，大致还是记得内容的。
<!-- DAILY_CHECKIN_2026-01-13_END -->

# 2026-01-12
<!-- DAILY_CHECKIN_2026-01-12_START -->


















今天听了 SmartDeer 的 Emily 老师做的Web3 职业分享会，应该会继续了解下运营方向的知识。
<!-- DAILY_CHECKIN_2026-01-12_END -->
<!-- Content_END -->
