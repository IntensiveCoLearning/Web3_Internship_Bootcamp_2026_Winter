---
timezone: UTC+8
---

# zzz123

**GitHub ID:** zhaojinxiu6

**Telegram:** 

## Self-introduction

Web3 实习计划 2025 冬季实习生

## Notes

<!-- Content_START -->
# 2026-01-13
<!-- DAILY_CHECKIN_2026-01-13_START -->
\## 1.13

\### DeFi

DeFi，全称为 Decentralized Finance（去中心化金融），是基于区块链技术建立的金融体系，目标是提供不依赖传统银行或金融中介的服务，比如借贷、交易、支付等，让每个人都可以自由参与，无需审批、无需信任中介机构。

\#### Uniswap

Uniswap 是以太坊上去中心化交易所（DEX）的代表。它使用 \*\*自动做市商（AMM）\*\* 机制，允许用户在无需订单簿的情况下进行代币交易。

\#### \*\*x _y = K（L^2^）_\*

\- \*`x`\*\*：池中的代币 A 数量

\- \*`y`\*\*：池中的代币 B 数量

\- \*\*K(L^2^)\*\*：一个恒定值，表示池子的总流动性

\==K实际上并不恒定：==

通常 Uniswap V2 采用 \*\*XY=K\*\* 公式，但实际上 K \*\*不是严格恒定\*\*，可以增大但不能减少。尽管AMM公式有时被称作“恒定乘积公式”

\- \*\*如果用户多支付代币或捐赠代币`K` 增大，流动性池变大\*\*。

\- \*\*如果 `K` 变小，交易会失败\*\*，确保资金池不会被恶意消耗。

例如：

\- 如果用户 \*\*免费存入额外代币\*\*，池子变大，但 Uniswap 不会阻止这种情况。

\- 但如果 `balance0 × balance1 < reserve0 × reserve1`，交易会回滚。

\==Uniswap v2 最初按所提供金额的几何平均值铸造股份，流动性 = sqrt(xy)。该公式确保任何时候流动性池股份的价值基本上与最初存入的流动性比例无关……上述公式确保流动性池股份的价值不会低于该池中储备的几何平均值。==

\##### \*\*为什么流动性计算使用 `sqrt(K)`？\*\*

\- Uniswap V2 采用 \*\*几何均值\*\* 计算流动性： $liquidity = \\sqrt{amount0 \\times amount1} - MINIMUM\\\_LIQUIDITY$

\- 为什么使用平方根？

\- \*\*保证 LP 代币价值独立于最初存入的代币比例\*\*。

\- \*\*防止流动性计算变得不合理（如流动性翻倍却导致计算上变成四倍）。\*\*

\==流动性提供者无法控制其资产售出的价格，只能根据池中代币的当前比例提供资产。如果有 100 个代币 x 和 200 个代币 y，新流动性提供者必须提供两倍于 x 的代币 y。同样的，如果用户销毁一定比例的代币，则可以赎回相应比例的代币x和代币y。==

公式变换：

!\[image-20250319202432288\]([https://raw.githubusercontent.com/zhaojinxiu6/images/master/image-20250319202432288.png](https://raw.githubusercontent.com/zhaojinxiu6/images/master/image-20250319202432288.png))

!\[image-20250319202501060\]([https://raw.githubusercontent.com/zhaojinxiu6/images/master/image-20250319202501060.png](https://raw.githubusercontent.com/zhaojinxiu6/images/master/image-20250319202501060.png))

x~0~：表示流入池中的代币A数量

y~0~:表示流出池中的代币B数量

\+ (y - y~0~) =K/(x+x~0~)

\+ y~0~ =y - K/(x+x~0~)

\+ ==y~0~ = y \* x~0~/(x+x~0~)==（没有手续费）

交换费率为F（0.3%（固定））

计算交换费：F\*流入的代币数量

则：==y~0~ = （1-F）y \* x~0~/(x+x~0~（1-F）)==

在实践中，交换费用会添加到储备金中。因此，每笔交易实际上都会增加 `K`。

恒定乘积公式的流动性并不是实际应用的流动性，它会减去一些最低流动性。这样做是为了防止被称为“买入通胀攻击”的攻击。

买入通胀攻击：简单的解释是，当总供应量等于0时，有很大的空间可以操纵铸造的股票数量，这可能会对后续用户铸造股份造成伤害。而防止买入通胀攻击的方法之一是铸造一些股票到0地址，通过这样做，我们可以保证一些代币被锁定在0地址内。之二是在合约部署时，由可信方注入一定的 token 和 ETH/WETH，并铸造 LP token 到一个多签或销毁地址，降低后续加入者的稀释风险。之三是在前端警告用户当总供应为 0 时交易风险。

\##### \*\*最小流动性（Minimum Liquidity）\*\*

为了\*\*减少舍入误差\*\*并\*\*增加流动性最小单位的理论精度\*\*，每个交易对的流动性池会\*\*燃烧（burn）第一批 `MINIMUM_LIQUIDITY` 代币\*\*。

\- \*\*对于大多数交易对来说，这个数值是极小的\*\*，影响可以忽略不计。

\- \*\*燃烧机制是自动完成的\*\*，发生在\*\*首次流动性提供\*\*时，此后 `totalSupply` 将保持\*\*永久受限\*\*。

\#### \*\*Mint（铸造流动性）\*\*

如果池子是空的（即 `LP 代币总供应量 = 0`），那么表示还没有人提供流动性。

\*\*代码关键点解析：\*\*

\- 池子为空的检查

\- \*\*如果池子是空的，进行初始铸造（下面详细解释）。\*\*

\- 一般情况的 Mint 逻辑：

\- 用户铸造的流动性是 `amount0 / reserve0` 和 `amount1 / reserve1` \*\*两者取最小值\*\*（\*\*绿色框，行 126\*\*）。

\- 为什么取最小值？

\- \*\*防止用户只存入一种代币，却获取了过多的 LP 代币\*\*。

\- \*\*保证存入的 `token0` 和 `token1` 保持相同比例\*\*

\##### \*\*例子：\*\*

假设池子有：

\- `token0 = 10`

\- `token1 = 10`

用户存入：

\- `token0 = 10`

\- `token1 = 0`

计算公式：

\- `min(10/10, 0/10) = min(1, 0) = 0`

\- \*\*用户将无法获得 LP 代币！\*\*

\##### \*\*为什么要这样设计？\*\*

假设池子最初有 `100 token0` 和 `1 token1`，LP 代币供应量是 1。

\- 现在某个用户存入 1 个 `token1`，总池子价值变为 `200` 美元。

\- \*\*如果我们采用最大值计算，该用户可能获得 1 个 LP 代币，总供应量变为 2。\*\*

\- \*\*这意味着他们以 100 美元的成本，直接占有了 50% 的流动性池，而原来的 LP 持有者被稀释了！\*\*

\- \*\*因此，必须取最小值，确保存入代币的比例保持不变，防止被利用。\*\*

\##### \*\*安全性检查\*\*

\- 供应比例检查：

\- 交易执行前，池子的 `token0` 和 `token1` 比例可能会发生变化。

\- \*\*如果另一个交易改变了储备量，用户最终获得的 LP 代币数量可能会低于预期。\*\*

\- \*\*Uniswap V2 允许一定的误差，以防止交易因为小幅变化而回滚（slippage 保护）。\*\*

\##### \*\*解决首次铸造问题（First Minter Problem）\*\*

在流动性池中，第一个提供流动性的人 \*\*面临“通胀攻击”风险\*\*。

\- Uniswap V2 \*\*销毁初始 `MINIMUM_LIQUIDITY` 代币\*\*，防止某个人拥有全部 LP 代币，并随意操控价格。

\- \*\*这个方法避免了流动性恶意操纵问题\*\*，具体内容可以参考 \*\*ERC4626 的防御机制\*\*。

\#### \*`mintFee` 的计算逻辑\*\*

\##### \*\*(1) 重要变量\*\*

\- `fee`：交易者支付的 \*\*0.3% swap 费用\*\*。

\- `mintFee`：协议分得的 \*\*1/6 swap 费用（即 0.05% 交易量）\*\*。

\- `L`：池子的 \*\*流动性（liquidity），即 √(token0 reserves \\\* token1 reserves)\*\*。

\- `rootK`：当前池子的 \*\*流动性\*\*（含手续费）。

\- `kLast`：\*\*上一次 mint/burn 时的流动性\*\*，用于计算增长部分。

\- `totalSupply`：LP 代币的总供应量。

\##### \*\*(2) 计算 `mintFee`\*\*

1\. \*\*计算池子的总流动性增长\*\*：

\- 初始流动性`L_old = sqrt(reserve0_old * reserve1_old)`

\- 当前流动性`L_new = sqrt(reserve0_new * reserve1_new)`

\- \*\*增量流动性\*\* = `L_new - L_old`

2\. \*\*计算协议应得份额\*\*：

\- 由于协议收取 \*\*1/6 swap 费用\*\*，协议应得的流动性： $L\_{protocol} = \\frac{(L\_{new} - L\_{old})}{6}$

3\. \*\*计算协议应该铸造的 LP 代币数\*\*（避免直接转移 token，改为稀释 LP 代币）：

$$

mintFee = \\frac{L\_{protocol} \\times totalSupply}{L\_{new}}

$$

\#### 流动性提供者（Liquidity Providers）

流动性提供者（LPs）并不是一个同质化的群体：

\- \*\*被动 LPs\*\* 是希望通过投资其资产来累积交易手续费的代币持有者。

\- \*\*专业 LPs\*\* 以做市为主要策略，通常会开发自定义工具来跟踪其在不同 DeFi 项目中的流动性头寸。

\- \*\*代币项目方\*\* 有时会选择成为 LP，以为其代币创造一个流动的市场。这使得代币更容易买卖，并通过 Uniswap 实现与其他 DeFi 项目的互操作性。

\- \*\*DeFi 先锋\*\* 正在探索更复杂的流动性提供模式，如激励流动性、流动性作为抵押品等实验性策略。Uniswap 是这些创新的理想实验平台。

\#### 无偿损失（Impermanent Loss）

当流动性池中代币的价格与添加流动性时的价格发生变化时，就会发生无常损失，从而导致流动性提供者的价值损失。也称（发散损失）。

当你将资产（例如 ETH 和 DAI）以 50/50 比例添加到 Uniswap V2 的池中后，池子会自动执行 \*\*恒定乘积公式\*\* $x \\cdot y = k$。

当外部价格发生变化时，套利者会不断买卖，导致池内资产比例发生变化。结果就是：你的资产虽然价值没有消失，但\*\*数量上发生了变化\*\*，导致你取出来的价值比单纯“持币不动”更低。

!\[img\]([https://raw.githubusercontent.com/zhaojinxiu6/images/master/51276366\_image.jpg](https://raw.githubusercontent.com/zhaojinxiu6/images/master/51276366_image.jpg))

\+ 当价格波动越大（离开初始价格越远，无论涨还是跌），\*\*无常损失越大\*\*；

\+ 最大损失约为 \*\*-100%\*\*，当价格趋近于 0 或无限大时；

\+ 在 \*\*价格不变（100%）\*\* 的点上，损失为 0；

\+ 这只是\*\*理论损失\*\*，称为「无常」是因为如果价格最终回到原点，损失就会恢复；

\+ 实际中，\*\*交易手续费（0.3%）和流动性挖矿奖励\*\*可以抵消甚至超过无常损失。

\#### Compound

Compound是一个允许用户借贷代币的智能合约，它与你的银行类似，Compound把你的钱借给借款人，并随着时间的推移赚取利息。但与银行不同的是，你的利息是从你存入Compound的智能合约后开始复利计算的。由于整个流程中没有中间人，因此利息会比传统银行要高。与MakerDAO类似，Compound的贷款是通过超额担保确立的。借贷者将代币存入Compound中以增加他们的“借款能力”，如过借贷者的借款能力低于0，他们的抵押品将被出售以偿还债务。另外，每个资产的贷款利率是不同的，这根据资产的需求而决定。

通过Compound，你可以存入加密资产一赚取利息，也可以借入加密资产以进行投资或其他需求。传统的金融生态系统需要金融机构来提供借贷服务，而Compound通过Ethereum区块链上的一系列智能合约，实现了这个过程的自动化。通过智能合约，Compound满足了想要从闲置资产中赚取利息的贷款人与需要资产作为投资资本的借款人之间的需求。

Compound有一个名为COMP的治理Token，它赋予持有者对Compound协议变更进行投票的权利。在Defi中，需要治理Token将权利分配给用户，以保持平台的去中心化。

Compound协议让开发者可以基于以太坊建立各种各样的货币市场。所谓的货币市场，其实就是一个个的独立币池单元。每个币池里中只有一种ERC20代币，协议通过算法来决定这个池子里的币借贷的利率是多少。简单点说，这个算法会基于人们对这个币借贷的供需关系自动计算出利率。

不管你是来贷款还是放贷，你都是在跟Compound协议直接打交道。这一点跟那些点对点的借贷协议不太一样，在点对点的方案里，借贷双方会做匹配，然后你需要跟找你借钱的人（或者借你钱的人）进行沟通，双方自己商定好借款的利率、到期时间和抵押物品等等。而在Compound协议里，每个ERC20代币都有一个属于自己的借贷市场，里面包含每个用户在这个市场里的余额，以及各笔生效的借贷交易，乃至每段时期的历史利率，等等。用户可以通过抵押品的信贷额度无缝地从协议上借钱，你只需要看自己要借哪个币，不需要和别人沟通还款日期、利率，就能马上借钱。借款是实时且可预测的。每个货币市场都有一个由市场决定的浮动利率。

\- \*\*标的资产（Underlying Token）\*\*：即借贷资产，比如 ETH、USDT、USDC、WBTC 等。

\- \*\*cToken\*\*：也称为生息代币，是用户在 Compound 上存入资产的凭证。每一种标的资产都有对应的一种 cToken，比如，ETH 对应 cETH，USDT 对应 cUSDT，当用户向 Compound 存入 ETH 则会返回 cETH。取款时就可以用 cToken 换回标的资产。

\- \*\*兑换率（Exchange Rate）\*\*：cToken 与标的资产的兑换比例，比如 cETH 的兑换率为 0.02，即 1 个 cETH 可以兑换 0.02 个 ETH。兑换率会随着时间推移不断上涨，因此，持有 cToken 就等于不断生息，所以也才叫生息代币。计算公式为：exchangeRate = (totalCash + totalBorrows - totalReserves) / totalSupply

\- \*\*抵押因子（Collateral Factor）\*\*：每种标的资产都有一个抵押因子，代表用户抵押的资产价值对应可得到的借款的比率，即用来衡量可借额度的。取值范围 0-1，当为 0 时，表示该类资产不能作为抵押品去借贷其他资产。一般最高设为 0.75，比如 ETH，假如用户存入了 0.1 个 ETH 并开启作为抵押品，当时的 ETH 价值为 2000 美元，则可借额度为 0.1 _2000_ 0.75 = 150 美元，可最多借出价值 150 美元的其他资产。

\*\*当用户存入标的资产后，\*\*Compound会根据兑换率返回标的资产相对应的cToken给到用户，作为一种存款凭证。当需要赎回存款时，用户需要将cToken还回去，Compound会根据最新的兑换率计算出需要赎回标的资产的数量并返还给用户。比如，用户存入 1 个ETH，当时的兑换率为 0.1，则返回 1/0.1 = 10 个 cETH，等到赎回时，假设兑换率已经升到了 0.15，则那 10 个 cETH 可赎回 10\*0.15 = 1.5 个 ETH，多出的 0.5 个 ETH 就是利息所得。

\*\*当用户将存入的资产开启作为抵押品之后，则可以进行借款了\*\*。不过，不是所有资产都可以作为抵押品，比如 USDT 就不可以作为抵押品，其抵押因子为 0。ETH、DAI、USDC 的抵押因子都是 0.75，即 75%，表示价值 100 美元的抵押资产，可借额度为 75 美元，即最多可以借出价值 75 美元的数字资产。不过，不建议用完所有额度，不然，存在被清算的风险。

\*\*当用户的借款价值已经超过借款额度的时候，就可以被清算了。\*\*不过，智能合约没办法自动清算，所以需要外部的清算人调用智能合约的清算函数来执行清算。而为了激励第三方清算人来执行清算，就会有个清算激励，该激励由被清算人（即借款人）来承担。另外，清算人一般都是由程序化的清算服务来承担。

与 Compound V2 不同，每个 Compound 实例仅仅借出一种资产。也就是说，你只能从 USDC 市场借用 USDC，从 ETH 市场借用 ETH - 你无法借用其他任何东西。为了借用这些资产，你需要根据市场规定的抵押比例提供抵押品（该比例由治理设定）。在 Compound V3 中，可借资产被称为 \*\*base asset\*\*。

\#### MakerDAO（现已更名为 Sky）：稳定币系统

MakerDAO 是一个 \*\*去中心化金融（DeFi）协议\*\*，无人控制、透明、基于智能合约运作。它主要的任务是维持 \*\*DAI 稳定币\*\* 的稳定价值并确保系统安全。MakerDAO 通过智能合约管理抵押资产，并利用 \*\*稳定费率\*\* 来调整系统中 DAI 的供需关系。

1\. \*\*超额抵押生成 DAI\*\*

在 MakerDAO 中，用户可以将其资产（如 ETH、BAT 或其他加密货币）抵押到系统中，并通过智能合约生成与美元挂钩的 DAI 稳定币。生成 DAI 时，用户的资产需要超额抵押，例如用户必须将价值 2 美元的资产抵押，才能生成 1 美元的 DAI。

2\. \*\*稳定费率与清算机制\*\*

\- 为了确保 DAI 稳定，MakerDAO 使用 \*\*稳定费率\*\* 来调节市场。稳定费是用户在还款时需要支付的利息。这一机制帮助 MakerDAO 控制 DAI 的供应量，避免其脱离 1 美元的目标价格。

\- 如果抵押资产的价值下降，且用户的抵押率低于系统设定的安全阈值，系统会触发 \*\*清算\*\*，自动将抵押资产出售以偿还债务，防止系统破产。

\##### DAI

\*\*DAI 是一种稳定币\*\*，设计上软挂钩美元（目标 1 DAI≈1 USD）。

它不是由公司发行的法币储备支持，而是由 \*\*过度抵押的加密资产\*\* 支撑。

任何人都可以通过抵押加密资产来 _铸造生成_ DAI。

\##### 抵押债仓（Vault, 原称 CDP）

\- 用户将加密资产（如 ETH、WBTC 等）存入智能合约中形成 _抵押债仓_。

\- 根据抵押资产的价值，用户可以铸造一定数量的 DAI。

\- 抵押资产价值必须超过债务价值（\*\*过度抵押\*\*），以维持系统安全。

\- 如果抵押物价格下跌过快，系统将自动清算这些仓位来保障 Dai 的担保水平。

这种机制让 \*\*每个 DAI 都由价值更高的资产作为担保\*\*。

\##### MKR —— 治理 & 经济调节代币

\- \*\*MKR 是 MakerDAO 的治理代币\*\*，持有人可以参与系统参数设置（如稳定费、抵押类型等）。

\- MKR 不直接作为支付工具，但用于 \*\*投票治理与风险管理\*\*。

\- 当系统出现不足时，系统可铸造新的 MKR 并卖出以弥补亏损；反之，多余收入可用来 \*\*焚烧 MKR\*\* 以降低总量。

\- 这使得治理者既承担责任也分享收益，与系统健康紧密挂钩。

\##### MakerDAO 通过去中心化的治理架构运作：

\- \*\*MKR 持有人通过投票决定关键参数\*\*：如新增抵押类型、利率、清算比率等。

\- 投票机制包括信号投票和执行投票，前者收集意见，后者产生链上效果。

\- 去中心化确保协议由社区共识驱动，而非单个机构。

\### NFT

也称==ERC721==，是非同质化货币的缩写，也是一种类似于ERC20的代币标准。

\+ NFT是一种不可同质化的代币，这意味着它们彼此之间有着鲜明的独特性，并且一个token不能 与同一类别的任何其他token互换。例如：一美元可以与其他任何美元互换 ，一美元的价值将于另一美元的价值相同。这些都是可替代的代币。

\+ 每个NFTs都有一个uint256变量，称为tokenId。因此，对于每个EBR-721合同，合同地址键值 对 uint256 tokenId必须是唯一的。此外，dApps还应该有一个 "converter"来调节NFTs的输入 和输出过程。例如，converter将tokenId视为输入，并输出不可伪造的代币，如僵尸图像、杀 戮、游戏收藏品等。

OpenSea 是目前全球最大的 NFT 交易平台，基本上覆盖了所有主流 NFT 的交易。OpenSea 的创新在于，它不仅仅是一个交易平台，它的基础设施使得 NFT 能够快速流通，所有权记录通过区块链系统得到确认和传递。你不再需要通过传统的金融系统，而是可以直接用加密货币（如以太坊）进行交易。

\#### Token URI:

Token URI（Token Uniform Resource Identifier，令牌统一资源标识符）是区块链和去中心化应用 程序（DApps）中的一个概念，特别是在与不可替代代币（NFT）相关的应用中。Token URI 是一个指 向元数据的链接，这些元数据描述了特定代币的属性和信息。元数据可以包括名称、描述、图像、属性 等。

以下是一些关于 Token URI 的关键点：

1\. 定义和作用：Token URI 是一个指向 JSON 文件的 URL，该文件包含了描述特定 NFT 的详细信 息。它用于为每个代币提供详细的、可读的信息，==并且节省gas==。

2\. 标准：在以太坊区块链上，ERC-721 和 ERC-1155 是最常见的 NFT 标准，这些标准都包括了 Token URI 字段。例如，ERC-721 标准中的 tokenURI 方法用于返回某个特定代币的 URI。

3\. 元数据内容：JSON 文件通常包括以下信息：

\+ `name` : 代币的名称。

\+ `description` : 代币的描述。

\+ `image` : 代币相关的图像的 URL。

\+ `attributes` : 代币的其他属性和特性，可以包括等级、类型等。

4\. 访问方式：当用户或应用程序需要查看 NFT 的详细信息时，可以通过 Token URI 访问存储在 链下（例如在 IPFS 或其他去中心化存储系统中）的元数据

\### DAO：去中心化自治组织（Decentralized Autonomous Organization）

通过智能合约在区块链上运行的组织。DAO的决策和管理过程是去中心化的，由所有持有代币的成员共同参与和投票决定。

| 维度 | DAO 优点 | DAO 缺点 |

| ------ | ---------- | ---------- |

| 权力 | 分散 | 被资本集中 |

| 透明度 | 极高 | 信息过载 |

| 执行 | 自动 | 容错差 |

| 效率 | 低成本执行 | 决策慢 |

| 安全 | 抗单点 | 易治理攻击 |

DAO 的优点在“抗中心化”，缺点在“无法抗人性与资本”。

\### MEME

MEME 原意为“迷因”，即网络文化中的梗、表情包、搞笑段子等。在加密圈，MEME 通常指那些以网络文化为基础的代币，比如 DOGE（狗狗币）、PEPE（青蛙币）、SHIB（柴犬币）等。

MEME 币的特点通常是“有趣、搞怪、社区驱动”，它们往往缺乏明确的技术价值，但通过强大的社区共识和文化认同获得价值。2024-2025 年，MEME 币市场出现了新的特点：\*\*公平发射\*\*（Fair Launch）、\*\*社区自治\*\*和\*\*实用性整合\*\*成为新趋势。

\### 交叉创新

\+ DeFi + NFT：数字资产金融化

\+ \*\*NFT 抵押借贷\*\*是这个领域最典型的应用。传统上，NFT 作为非同质化代币流动性较差，持有者很难在不出售的情况下获得流动性。DeFi + NFT 的结合解决了这个问题。

\+ DAO + MEME：社区文化与治理融合

\+ \*\*MEME 币与 DAO 治理\*\*的结合创造了一种全新的社区组织形式，既保持了 MEME 文化的趣味性，又具备了实际的治理功能。

\+ AI + DeFi：智能化金融服务

\+ \*\*人工智能与去中心化金融\*\*的结合正在创造更智能、更高效的金融服务体验。

\+ WEB3 + 乡建：南塘 DAO 的探索

\+ 南塘 DAO 秉持“向乡土求共同体之 DAO，向加密寻世界性之道”的核心理念，旨在促进乡建与 Web3 领域的深度交流与融合，推动双方互学互鉴。

这些跨领域的创新不仅展示了 Web3 技术的可组合性，也为用户创造了更丰富的应用场景。随着技术的不断发展，我们预计会看到更多领域的融合创新，如 Social + DeFi、IoT + Blockchain 等。

\### 预期发展

\#### \*\*Intent-Based 交易\*\*

传统的 Web3 交易需要用户明确指定每一步操作（如选择 DEX、设置滑点等），而意图驱动的交易允许用户表达目标（如“用 100 USDC 买到最多的 ETH”），由系统内不同的求解器给出报价，系统最终自动寻找最优报价对应的路径执行。

\### \*\*账户抽象与智能钱包\*\*

账户抽象（Account Abstraction, AA）通过 ERC-4337 标准，让以太坊账户具备智能合约的灵活性，用户无需持有 ETH 即可进行交易，支持社交恢复、批量操作等高级功能。

\#### \*\*模块化区块链\*\*

2025 年的区块链架构向模块化发展，将执行、共识、数据可用性、结算等功能分离，实现更好的可扩展性和可定制性。

\#### \*\*AI + Web3 融合\*\*

人工智能与 Web3 的结合创造了新的应用范式，从去中心化 AI 训练到 AI 驱动的自动化交易。
<!-- DAILY_CHECKIN_2026-01-13_END -->

# 2026-01-12
<!-- DAILY_CHECKIN_2026-01-12_START -->

## **1.12**

### **区块链的概念**

区块链是一种按某种顺序将数据区块以hash指针相连的方式组合而成的链式数据结构，并以密码学、共识算法方式保证其不可篡改和不可伪造。 (工信部定义)

区块链是一种去中心化的分布式账本技术，用于在网络节点之间安全、透明且不可篡改地记录事务数据。每条链由一系列按照时间顺序相连的“区块”组成，每个区块内部包含了多笔交易数据及元数据，确保了数据记录的完整性与可追溯性。

区块链的特点：公开透明、难以篡改、全程追溯、去中心化

-   公开透明：
    
    任何用户通过运行比特币或者以太坊的全节点客户端都能下载完整的账本数据并查看上述交易及账 户信息。
    
-   难以篡改：
    
    > 区块链系统中的链式数据结构，是由包含交易信息的区块按照时间顺序从先到后链接起来的， 这个数据结构叫做“区块链”。在区块链中，除创世区块之外，每个区块都指向前一个区块。每一个区块的区块头都包含一个名为“父区块哈希值”的字段，这个区块通过存储在这个字段中的值“链接”到前一个区块（父区块）。除创世区块以外，每一个区块的区块头都包含其父区块的哈希值，所以本区块的哈希值也受到前一个区块（父区块）哈希值的影响。因此当一个区块链的规模越大，所包含的区块越多。对任何一个区块的篡改所引发的对整个区块链的篡改工作量也将越大。 同时因为区块链系统重每一个全节点都存储着一份一模一样的区块链数据结构，因此如果要对区块链数据进行篡改，仅仅篡改一个全节点存储的区块链数据是不够的，需要同时篡改全网至少51%的全节点所存储的区块链数据。区块链系统规模越大，包含的全节点数量越多，所要篡改的节点数也就越多，难度也就越大。
    

区块链是由一个个区块连接成的链。有不同的区块链，主流的是比特币和以太坊。

hash指针（反向）是区块链的核心。

而区块由区块和区块头组成。区块头包含上个区块的哈希以及一些本区块信息，区块体主要是包含交易信息。

**出块时间**：在比特币中区块大约每10分钟出块一次，而在以太坊中大约只有10~15秒（）

区块头包含的信息：（通用的字段）

| 字段 | 作用 |
| --- | --- |
| 版本号（Version） | 标识区块使用的协议版本 |
| 前一个区块哈希（Prev Block Hash） | 将区块按时间顺序链式连接 |
| 区块体摘要（Merkle Root / State Root） | 表示区块体数据的哈希摘要 |
| 时间戳（Timestamp） | 区块创建时间 |
| 难度目标 / 随机性字段 | 用于共识算法 |
| Nonce / 共识相关字段 | 用于 PoW / PoS 验证 |

以太坊2022 年 9 月 15 日之后共识机制变成POS（权益证明）之后，区块头的包含的信息：

| 字段 | 说明 |
| --- | --- |
| parentHash | 父区块哈希 |
| stateRoot | 全局状态树根（账户状态） |
| transactionsRoot | 交易 Merkle Root |
| receiptsRoot | 回执 Merkle Root |
| logsBloom | 日志布隆过滤器 |
| number | 区块高度 |
| timestamp | 时间戳 |
| gasLimit / gasUsed | Gas 上限 / 已使用 |
| baseFeePerGas | EIP-1559 基础费 |
| mixHash / prevRandao | PoS 随机数 |
| beneficiary | 提议者地址 |

### **BTC**

**比特币（BTC）是比特币的原生代币**。比特币作为一种激励被赋予了很高的价值，主要来源有两个：出块奖励和交易费。

> 这里的来源主要是对出块奖励的细分，实质上交易费也是出块奖励，因为一个是区块链系统的区块奖励，而交易费则是矿工自己选择的交易附带的交易费，这是不固定的。而且由于区块奖励每四年减少一半，所以预计在将来BTC的流动主要还是来自于交易。

**出块奖励：**

矿工挖矿时会将区块体里写入含有指定地址的交易（from是0地址，to是自己）作为第一笔交易。如果矿工挖矿成功之后地址会收到出块奖励（包含区块奖励以及交易费）。初始区块奖励是50BTC，每四年奖励减半，出块奖励趋近于0。预计发行2100 万 BTC，之后，激励矿工挖矿的动力变成交易费。

**区块链生态系统的运行包含以下几个关键步骤：**

NaN.  **用户发起交易**：用户通过钱包应用发起转账、智能合约调用等操作
      
NaN.  **交易广播**：交易信息被广播到整个网络中的各个节点
      
NaN.  **节点验证**：网络中的矿工节点验证交易的合法性（余额是否足够、签名是否正确等）
      
NaN.  **打包成块**：通过共识机制（如工作量证明），矿工将验证过的交易打包成新的区块
      
NaN.  **链接上链**：新区块被添加到区块链上，更新全网的账本状态
      
NaN.  **奖励发放**：成功打包区块的矿工获得代币奖励和交易手续费
      

**区块链的种类**

区块链根据访问权限与治理模式，大致可分为三类。公链、私链、联盟链。

**公链**

NaN.  公有链简称公链，是指全世界任何人都可以随时进入读取、任何人都能发送交易且能获得有效确认的共识区块链。公链是一种非许可链。
      
NaN.  通常，公链被认为是完全去中心化的，链上数据都是公开透明的，不可更改。任何人都可以通过交易或者挖矿读取和写入数据。一般会通过代币机制（Token）来鼓励参与者竞争记账，确保数据的安全性。
      
NaN.  公共链是真正意义上的完全去中心化的区块链， 它通过密码学保证交易不可篡改，同时也利用密码学验证以及经济上的激励，在互为陌生的网络环境中建立共识，从而形成去中心化的信用机制。在公共链中的共识机制一般是工作量证明(PoW)或权益证明 (PoS)，用户对共识形成的影响力直接取决于他们在网络中拥有资源的占比。
      
NaN.  公链的特性：
      
      -   开源
          
      -   保护用户免受开发者的影响
          
      -   访问门槛低
          
      -   所有数据默认公开
          

**私链**

NaN.  私链是指其写入权限仅在一个组织手里的区块，是一种许可链。私链在读取权限或者对外开 放，或者任意程度地进行了限制。
      
NaN.  私有链的价值主要是提供安全、 可追溯、不可篡改、自动执行的运算平台，可以同时防范来自内部和外部对数据的安全攻击。
      

私链的特性：

-   交易速度快
    
-   隐私性好
    
-   交易成本低
    

**联盟链**

NaN.  联盟链即机构联盟的区块链，是一种许可链。
      
NaN.  联盟链有机构间根据自行商定的协议建立而成，成员节点参与区块链运行需要根据规则获得编写的权限。
      
NaN.  联盟链由成员节点共同维护，提供成员管理、认证、授权、监控、审计等功能。
      
NaN.  联盟链适合机构间交易清算结算的B2B场景，勇于节省对账和清算成本，减少人为错误的发生。联盟链对安全性能要求比公链高
      
NaN.  本质上，联盟链是私链的一种，只是私有程度不同，且联盟链权限设计要求比私链更复杂；联盟链比纯粹的私链更具可信度。
      

总的来说，总体而言，在对可信度、安全性有很高要求，而对交易速度不苛求的落地场景，公有链 更有优势。而对于更加注重隐私保护、交易速度和内部监管的应用，开发私链或者联盟链则更加合适。

| 区块链类型 | 节点加入方式 | 数据可见性 | 管理模式 | 适合场景 |
| --- | --- | --- | --- | --- |
| 公链 | 任何人自由加入 | 所有人可见 | 去中心化（大家投票） | 加密货币、公共存证 |
| 联盟链 | 需联盟成员邀请/审批 | 仅联盟成员可见 | 多中心化（董事会决策） | 供应链、金融协作 |
| 私链 | 由老板严格审批 | 仅内部成员可见 | 中心化（老板说了算） | 企业内部管理、审计 |

**Web2与Web3.0与Web3**

| 维度 | Web2 | Web 3.0 | Web3 |
| --- | --- | --- | --- |
| 控制权 | 平台垄断 | 部分开放 | 用户自治 |
| 数据存储 | 中心服务器 | 混合存储 | 区块链 / IPFS |
| 支付系统 | 信用卡 / 支付宝 | 集成支付 | 加密货币 |
| 典型技术 | JavaScript | RDF / OWL | 智能合约 |
| 代表企业 | 腾讯 / 阿里 | W3C / DBpedia | Uniswap / ConsenSys |

NaN.  **Web3 ≠ Web 3.0**
      
      -   Web3 是**区块链驱动**的革命
          
      -   Web 3.0 是**语义网技术驱动**的数据组织升级
          
NaN.  **Web3 不是万能的**
      
      -   优势：金融、产权、隐私场景
          
      -   劣势：不适合高频社交（如微博）
          

**去中心化的优势和挑战：**

**优势：**

NaN.  **信任最小化**
      
      去中心化网络无需依赖中心化第三方，交易和数据由共识算法和加密证明保障，降低了 “信任成本”。
      
NaN.  **抗审查与高弹性**
      
      数据分布存储在多个节点，单点故障或审查攻击难以完全阻断网络，提升了系统的安全性和可用性。
      
NaN.  **用户自主管理**
      
      用户通过私钥掌控资产与数据，平台无法随意更改或冻结账户，赋予个人更高的隐私权和所有权。
      
NaN.  **开放创新生态**
      
      区块链与智能合约构建了去中心化应用（Dapps）平台，任何开发者都可在此基础上创新并获得代币激励，促进了技术和商业模式的多样化。
      

**挑战：**

NaN.  **可扩展性瓶颈**
      
      公链在节点众多时共识效率低下，吞吐量和延迟问题突出，目前各大项目正通过分片、Layer 2 方案等技术进行优化。
      
NaN.  **安全与治理难题**
      
      区块链的不可篡改特性虽能保证数据安全，但代码漏洞或治理失衡（如 DAO 中投票权集中）也可能导致严重损失。
      
NaN.  **用户体验与成本**
      
      完全去中心化的系统往往对普通用户不够友好，如私钥管理复杂、交易手续费浮动大，需要在易用性与去中心化程度之间权衡。
      
NaN.  **法律与合规风险**
      
      去中心化和匿名特性与现行法规存在冲突，跨境监管和合规要求尚未完善，给项目方和用户带来不确定性。
      

### **以太坊**

以太坊（Ethereum）是一个开源的去中心化区块链平台，通过其原生加密货币以太币（Ether，简称 ETH）提供去中心化的以太虚拟机（EVM）来处理点对点合约。

以太坊的核心创新在于 智能合约（Smart Contracts） 。智能合约是存储在区块链上的可执行代码，能够在满足预设条件时自动执行操作，无需人工干预。这一特性使得以太坊不仅是数字货币的载体，更是构建去中心化应用（Dapps）、去中心化金融（DeFi）、非同质化代币（NFT）等生态系统的基础设施。

以太坊的本质定位是：

-   **通用智能合约平台**
    
-   **去中心化的执行层（Execution Layer）**
    
-   **可组合的金融与应用基础设施**
    

**智能合约**

智能合约是一种自执行的合约，合同条款直接写入代码中，并在区块链网络上运行。它们自动执行和强制执行合同中的条款和条件，无需第三方干预。

主要有以下特点：

-   去中心化
    
-   数据透明
    
-   不可篡改
    
-   消除交易对手风险
    

**以太币（ETH）是以太坊的原生代币**

在以太坊上进行的任何操作或交易，都需要使用以太币（ETH）来支付相关费用。

由于区块链是去中心化的，因此在区块链上的操作都需要支付手续费给网络服务提供商。这个手续费通常称为燃料费（Gas Fee）也就是wei。1 ETH = 109Gwei = 1018 wei

**比特币和以太坊的区别**

| 维度 | 比特币（Bitcoin） | 以太坊（Ethereum） |
| --- | --- | --- |
| 目标与定位 | 去中心化的数字货币，强调安全、稳定和稀缺性（总量 2100 万枚） | 去中心化平台，支持智能合约和 Dapps，定位为“区块链 2.0” |
| 编程能力 | 脚本语言有限，仅支持简单的交易验证逻辑 | 图灵完备的编程语言（如 Solidity），可开发复杂智能合约 |
| 共识机制 | 工作量证明（PoW），矿工通过算力竞争记账权 | 从 PoW 转向权益证明（PoS），通过 The Merge 实现能源效率优化 |
| 交易速度 | 每 10 分钟生成一个区块，交易确认较慢 | 区块时间约 12 秒，交易确认更快，适合高频应用 |
| 经济模型 | 总量固定，强调抗通胀属性 | 供应灵活，通过 EIP-1559 等机制可能呈现通缩趋势 |

**以太坊的定位与演进**

以太坊是一个基于区块链的 去中心化计算平台 ，它的目标是成为“全球计算机”，让任何人无需依赖第三方即可进行交易、管理数据或运行应用。为了实现这一目标，以太坊经历了多次重大升级，其中最关键的是从 工作量证明（PoW）转向权益证明（PoS） ，以及被称为 The Merge（合并） 的里程碑事件。

以太坊要解决的核心问题：

-   **无需信任的程序执行**
    
-   **去中心化应用（dApp）**
    
-   **可组合协议（DeFi / NFT / DAO）**
    

**1\. 以太坊 1.0（PoW 阶段）**

以太坊最初像比特币一样，使用 **PoW（工作量证明）** 机制来维护网络安全。简单来说：

-   矿工通过计算机算力“挖矿”，争夺打包交易的权利。
    
-   矿工需要消耗大量电力资源，竞争激烈。
    
-   成功打包区块的矿工会获得新生成的 ETH 奖励。
    

**问题**：

-   **能耗高**：全球以太坊矿工的电力消耗相当于一个小国家的用电量。
    
-   **扩展性差**：每秒只能处理约 30 笔交易（TPS），速度慢、费用高。
    

为了解决这些问题，以太坊启动了多次升级（如 Homestead、Metropolis），逐步优化网络性能和安全性，但核心的 PoW 机制仍未改变。

**2\. 以太坊 2.0 与 The Merge：从双链并行到完美合并**

**The Merge 完整故事**：

NaN.  **2020 年 12 月：信标链启动**
      
      以太坊团队首先创建了一条全新的**信标链（Beacon Chain）**，专门运行 PoS 共识机制。此时：
      
      -   以太坊主网继续使用 PoW 挖矿
          
      -   信标链独立运行 PoS 验证
          
      -   两条链并行存在，互不干扰
          
NaN.  **2022 年 9 月：历史性合并**
      
      2022 年 9 月 15 日，**The Merge** 发生：
      
      -   以太坊主网“关闭”了 PoW 挖矿引擎
          
      -   将共识机制“插接”到信标链的 PoS 系统
          
      -   从此，以太坊主网由信标链保护安全
          
NaN.  **合并后的新架构**
      
      现在的以太坊实际上是两层结构：
      
      -   **执行层**：处理交易、智能合约（原主网）
          
      -   **共识层**：管理验证者、确定区块顺序（信标链）
          

**未来升级路线图**

The Merge 只是起点，以太坊的“进化”还在继续！接下来的升级目标是：**让更多人用得起、用得快、用得安全**。以下是重点方向：

NaN.  **分片技术演进——从执行分片到数据分片**
      
      **原计划 vs 新策略**：
      
      -   **原计划**：将以太坊分成 64 条分片链，每条独立处理交易
          
      -   **策略调整**：专注于**数据分片**，配合 Layer 2 实现扩容
          
      
      **当前方案**：
      
      -   **数据可用性分片**：为 Rollup 提供更多、更便宜的数据存储空间
          
      -   **配合 Layer 2**：主网专注安全和数据可用性，Layer 2 负责大量交易处理
          
      -   **EIP-4844 先行**：通过 Blob 交易为分片技术做准备
          
      
      **预期效果**：
      
      -   Layer 2 成本进一步降低 90%+
          
      -   以太坊主网专注于做“结算层”和“数据可用性层”
          
      
      **时间表**：全面分片预计 **2025-2026 年** 启动，重点是 Proto-Danksharding
      
NaN.  **EIP-4844（Cancun 升级）——“省钱神器”**
      
      **Layer 2 工作原理简述**：
      
      -   Layer 2 在链下批量处理大量交易
          
      -   定期将交易数据“打包”提交到以太坊主网
          
      -   主网验证数据正确性，提供最终安全保障
          
      
      **EIP-4844 的突破**：
      
      -   **问题**：以前 L2 提交数据需要使用常规交易，成本高昂
          
      -   **解决方案**：引入专门的“Blob 交易”类型，数据存储成本大幅降低
          
      -   **技术细节**：Blob 数据会在一定时间后自动删除，不会永久占用主网存储
          
      
      **实际效果**：
      
      -   L2 交易费用降低 **70% - 90%**
          
      -   Arbitrum、Optimism 等主流 L2 费用降至几美分
          
      -   **状态**：**已于 2024 年 3 月 13 日上线主网**，运行稳定
          
NaN.  **ZK-Rollup 技术——“批量验证，一步到位”**
      
      **ZK-Rollup 简单理解**：
      
      -   想象你是老师，需要检查 1000 份作业
          
      -   普通方法：一份份检查（慢且耗时）
          
      -   ZK 方法：学生提交一个“证明”，证明所有作业都做对了
          
      
      **技术原理**：
      
      -   **批量处理**：在链下一次性处理数百笔交易
          
      -   **零知识证明**：生成一个简洁的“正确性证明”
          
      -   **主网验证**：以太坊只需验证这个证明，无需重新执行所有交易
          
      
      **优势**：
      
      -   **速度快**：主网只需验证一个证明而非数百笔交易
          
      -   **成本低**：多笔交易分摊验证成本
          
      -   **安全性高**：继承以太坊主网的安全性
          
      
      **代表项目**：zkSync Era、Polygon zkEVM、Scroll
      
NaN.  **其他重要升级方向**
      
      -   **EIP-1559 成果**：已实现基础费用机制，但 Gas 费仍受网络拥堵影响较大
          
      -   **Verkle 树技术**：优化状态存储结构，减少节点同步所需的数据量
          
      -   **执行环境优化**：提升 EVM 性能，支持更复杂的智能合约应用
          

**以太坊的生态**

以太坊的生态系统由多层架构组成，包括 **L1（主网）、L2（二层扩展解决方案）、侧链（Sidechains）** 等，共同支持高吞吐量和低费用的交易处理。

NaN.  **Layer 1（L1）**
      
      -   **以太坊主网**：核心区块链，负责最终安全性与共识。
          
      -   **EVM**：以太坊虚拟机，执行智能合约代码。
          
      -   **账户系统**：外部账户（EOA）与合约账户（CA）共同构成网络基础。
          
NaN.  **Layer 2（L2）**
      
      -   **Rollup**：通过将交易批量处理后提交至 L1，降低 Gas 费。
          
          -   **Optimistic Rollup**：假设交易合法，仅在争议时验证。
              
          -   **ZK Rollup**：通过零知识证明验证交易，无需链上争议。
              
NaN.  **侧链（Sidechains）**：独立运行的链，通过桥接与主网交互。
      
NaN.  **以太坊生态分层架构**
      

以太坊生态可以分为以下几个层次：

**1\. 应用层（Application Layer）**

用户直接交互的应用和界面：

-   **DeFi 应用**：Uniswap（去中心化交易所）、Aave（借贷协议）、Compound（借贷协议）
    
-   **NFT 平台**：OpenSea、Foundation、SuperRare
    
-   **钱包应用**：MetaMask、Coinbase Wallet、Rainbow
    
-   **DAO 工具**：Snapshot、Aragon、Colony
    

**2\. 协议层（Protocol Layer）**

以太坊的核心基础设施：

-   **共识层客户端**：Prysm、Lighthouse、Nimbus、Teku
    
-   **执行层客户端**：Geth、Nethermind、Erigon、Besu
    
-   **核心协议**：EVM、状态管理、Gas 机制
    

**3\. 扩展层（Scaling Layer）**

提升性能和降低成本的解决方案：

-   **Layer 2 Rollups**：Arbitrum、Optimism、Polygon zkEVM、zkSync Era
    
-   **侧链**：Polygon PoS、xDAI（Gnosis Chain）
    
-   **状态通道**：Lightning Network for Ethereum
    

**以太坊文化与价值观**

以太坊的文化深受 **密码朋克运动（Cypherpunk）** 影响，体现了对技术赋权个人、重塑社会协作的愿景：

**核心价值观**

NaN.  **去中心化治理（Decentralization）**
      
      -   没有单一的控制者或权威机构
          
      -   社区通过公开讨论和 EIP（以太坊改进提案）机制共同决策
          
      -   验证者遍布全球，防止权力集中
          
NaN.  **无需许可与开放性（Permissionless & Open）**
      
      -   任何人都可以使用、开发、部署智能合约
          
      -   开源代码，透明可审计
          
      -   无身份、地域、财富限制的参与门槛
          
NaN.  **抗审查性（Censorship Resistance）**
      
      -   交易和智能合约不受政府或机构干预
          
      -   通过分布式验证确保网络弹性
          
      -   支持言论自由和经济自由
          
NaN.  **密码朋克精神（Cypherpunk Ethos）**
      
      -   代码即法律：用算法和数学构建信任
          
      -   密码学保护隐私和自主权
          
      -   技术驱动的社会变革，而非政治手段
          
NaN.  **公共物品导向（Public Goods Orientation）**
      
      -   优先考虑生态系统整体利益
          
      -   支持开源项目和基础设施建设
          
      -   通过各种资助计划推动创新
          
NaN.  **可持续发展理念**
      
      -   The Merge 体现了对环境责任的承诺
          
      -   长期主义思维，注重技术的可持续演进
          
      -   平衡创新速度与网络稳定性
          

**账户**

以太坊（Ethereum）中的账户分为 **两种类型**：

NaN.  **EOA（Externally Owned ，外部拥有账户）**
      
      NaN.  外部拥有账户。最常见的账户类型，也是我们的个人账户（钱包地址）。EOA由私钥控制。将账户的公钥进行哈希运算，通常使用Keccak256算法进行哈希运算。去哈希值的最后20个字节（160位）。长度160 bit
            
NaN.  **合约账户（Contract Account）**
      
      NaN.  合约账户。部署在网络上的智能合约，由在区块链上的代码控制。将调用或创建该智能合约的外部账户地址+交易数量Nonce。长度也是160bit。
            
      
      两种账户类型都能：
      
      -   接收、持有和发送 ETH 和 token。
          
      -   与已部署的智能合约进行交互。
          
      
      区别：数据存储上稍有不同， 因为外部账户无内部存储数据和合约代码，因此外部账户数据中 `StorageRoot` 和 `CodeHash` 是一个空默认值。 一旦属于空默认值，则不会存储对应物理数据库中。 在程序逻辑上，存在 `code` 则为合约账户。 即`CodeHash`为空值时，账户是一个外部账户，否则是合约账户。
      
      外部持有账户
      
      -   创建帐户是免费的
          
      -   可以发起交易
          
      -   外部所有的帐户之间只能进行以太币和代币交易
          
      -   由一对加密密钥组成：控制帐户活动的公钥和私钥
          
      
      合约账户
      
      -   创建合约存在成本，因为需要使用网络存储空间
          
      -   只能在收到交易时发送交易
          
      -   从外部帐户向合约帐户发起的交易能触发可执行多种操作的代码，例如转移代币甚至创建新合约
          
      -   合约帐户没有私钥。 相反，它们由智能合约代码逻辑控制
          

**如何创建智能合约地址？**

有两种在以太坊中创建智能合约地址的方法。

每个智能合约通过其地址在区块链中标识。该地址是一系列的长的数字和字符，它从0xba开始......但是问题是如何计算0xba。

部署在区块链上的智能合约代码是交易的一部分。当我们在区块链上部署智能合约时，我们需要一个钱包地址，以便流程将是第一种：**钱包地址 => 交易 => 智能合约**。当我们执行以太坊网络中的任何事务时，它将增加一个成为`Nonce`的数字。所以智能合约地址通过其钱包地址和`Nonce`确定。因此结论是将`Nonce`、发件人地址放在数组中，然后使用`rlp.encode()`机制，在`rlp.encode()`操作结果之后，使用`keccak256()`函数将其放置，并提供32个字节的数据。 智能合约地址使用哈希的最后20个字节。

创建智能合约地址的另一种方法是使用成为`create2`的`opcode`。`create2`取决于发件人地址和合约代码以创建智能合约地址。创建一个智能合约地址并不是那么流行。

智能合约地址：智能合约地址独特地确定区块链上的智能合约，每个智能合约地址都与四个不同的字段相关联：

-   `Nonce`：一个计数器，用来显示外部帐户发送的交易数量或合约帐户创建的合约数量。 每个帐户只能执行具有一个给定随机数的一笔交易，以防范重放攻击，重放攻击指多次广播和重复执行已签署的交易。`Nonce`是一个整数，每次地址发送任何交易时都会增加。因此，在智能合约部署时间`Nonce = 0`之后，智能合约发送第一个交易后，`Nonce`将增加到1，然后依此类推。
    
-   `Balance`：这个地址拥有的 Wei 数量。 Wei 是以太币的计数单位，每个 ETH 有 1e18（1018） 个 Wei。如果我们将以太余额发送给智能合约，则其以太余额的增加，如果将智能合约发送到另一个地址，则其以太余额的下降。
    
-   `CodeHash`：当我们用`solidity`编程智能合约时，该代码将转到区块链上的存储代码字段。该哈希表示以太坊虚拟机 (EVM) 上的帐户_代码_。 合约帐户具有编程的代码片段，可以执行不同的操作。 如果帐户收到消息调用，则执行此 EVM 代码。 与其他帐户字段不同，不能更改。 所有代码片段都被保存在状态数据库的相应哈希下，供后续检索。 此哈希值称为 codeHash。 对于外部所有的帐户，codeHash 字段是空字符串的哈希。
    
-   `storageRoot` 有时被称为存储哈希。 Merkle Patricia trie 根节点的 256 位哈希已编码了帐户的存储内容（256 位整数值映射），并编码为 Trie，作为来自 256 的 Keccak 256 位哈希的映射位整数键，用于 RLP 编码的256位整数值。 此 Trie 对此帐户存储内容的哈希进行编码，默认情况下为空。
    

EOA地址也有四个字段：

-   `Nonce`：Nonce是一个整数，每次地址发送任何交易时都会增加。
    
-   `Balance`：balance将增加/降低取决于发送和接受的需求。
    
-   `CodeHash`： 对于外部所有的帐户，codeHash 字段是空字符串的哈希。
    
-   `storageRoot` 有时被称为存储哈希。 Merkle Patricia trie 根节点的 256 位哈希已编码了帐户的存储内容（256 位整数值映射），并编码为 Trie，作为来自 256 的 Keccak 256 位哈希的映射位整数键，用于 RLP 编码的256位整数值。此 Trie 对此帐户存储内容的哈希进行编码，默认情况下为空。
    

**Gas模型**

当你用钱包使用自己的 EOA 发起一笔交易（比如转账或操作合约），这件事当然 **不会是免费的**，你需要支付“燃料费”——也就是 **Gas**。

Gas 是怎么计算的？

Gas 费用 = **用多少 × 每单位多少钱**，就像你打车一样：

-   **Gas Limit（限额）**：你最多愿意“烧”多少燃料。 比如你觉得最多可能需要 15 万单位，就设置 150,000。
    
-   **Gas Price（单价）**：每单位燃料多少钱，用 Gwei 表示（1 Gwei = 0.000000001 ETH）。 网络越拥堵，价格越贵，就像打车高峰期加价。
    

所以，**总费用 = Gas Limit × Gas Price**。

> 假设你设置 Gas Limit 为 150 000，Gas Price 为 100 Gwei，总费用就是 0.015 ETH。如果实际消耗 120 000 Gas，剩余 30 000 Gas × 100 Gwei = 0.003 ETH 会退还给你。

Gas 的存在有两个目的：

-   **激励矿工/验证者**：你给得越多（Gas Price 越高），他们越愿意优先处理你的交易。
    
-   **防止资源滥用**：如果有人想让合约死循环，Gas 会用光，交易失败，系统不会被拖垮。
    

在 EIP-1559 升级后，Gas Price 被拆分了：

以前，Gas Price 全部给矿工。 现在，分成两部分：

-   **基础费用（Base Fee）**：每个区块都会有，自动计算，直接销毁（直接消失）来帮助 ETH 通缩，毕竟物以稀为贵。
    
-   **小费（Tip）**：你额外加的钱，用来鼓励矿工优先处理你
    

**以太坊虚拟机（EVM）：代码的执行引擎**

EVM（Ethereum Virtual Machine）是 **以太坊的“大脑”**，是专门用来**运行智能合约的虚拟计算机**。它运行在每个节点上，确保整个网络在处理代码时，**结果都一致、可信任**。

EVM 的核心特点：

-   **图灵完备**：就像真正的电脑一样，EVM 可以执行各种逻辑，比如 if 判断、循环等。
    
-   **全球同步**：每个矿工/节点都会自己执行一遍合约代码，保证结果一样。
    
-   **隔离安全**：EVM 把合约“关”在一个小房间里运行，不允许它乱访问用户的数据和网络，保护隐私和安全。
<!-- DAILY_CHECKIN_2026-01-12_END -->
<!-- Content_END -->
